(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const u of d)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function i(d){const u={};return d.integrity&&(u.integrity=d.integrity),d.referrerPolicy&&(u.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?u.credentials="include":d.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function c(d){if(d.ep)return;d.ep=!0;const u=i(d);fetch(d.href,u)}})();function Fc(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var oa={exports:{}},Zr={},ia={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cc;function Jf(){if(cc)return me;cc=1;var o=Symbol.for("react.element"),a=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),w=Symbol.iterator;function v(b){return b===null||typeof b!="object"?null:(b=w&&b[w]||b["@@iterator"],typeof b=="function"?b:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,$={};function D(b,M,P){this.props=b,this.context=M,this.refs=$,this.updater=P||T}D.prototype.isReactComponent={},D.prototype.setState=function(b,M){if(typeof b!="object"&&typeof b!="function"&&b!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,b,M,"setState")},D.prototype.forceUpdate=function(b){this.updater.enqueueForceUpdate(this,b,"forceUpdate")};function B(){}B.prototype=D.prototype;function F(b,M,P){this.props=b,this.context=M,this.refs=$,this.updater=P||T}var ie=F.prototype=new B;ie.constructor=F,j(ie,D.prototype),ie.isPureReactComponent=!0;var ge=Array.isArray,oe=Object.prototype.hasOwnProperty,K={current:null},Z={key:!0,ref:!0,__self:!0,__source:!0};function he(b,M,P){var O,ue={},ce=null,de=null;if(M!=null)for(O in M.ref!==void 0&&(de=M.ref),M.key!==void 0&&(ce=""+M.key),M)oe.call(M,O)&&!Z.hasOwnProperty(O)&&(ue[O]=M[O]);var G=arguments.length-2;if(G===1)ue.children=P;else if(1<G){for(var te=Array(G),se=0;se<G;se++)te[se]=arguments[se+2];ue.children=te}if(b&&b.defaultProps)for(O in G=b.defaultProps,G)ue[O]===void 0&&(ue[O]=G[O]);return{$$typeof:o,type:b,key:ce,ref:de,props:ue,_owner:K.current}}function De(b,M){return{$$typeof:o,type:b.type,key:M,ref:b.ref,props:b.props,_owner:b._owner}}function ve(b){return typeof b=="object"&&b!==null&&b.$$typeof===o}function Se(b){var M={"=":"=0",":":"=2"};return"$"+b.replace(/[=:]/g,function(P){return M[P]})}var Te=/\/+/g;function we(b,M){return typeof b=="object"&&b!==null&&b.key!=null?Se(""+b.key):M.toString(36)}function ze(b,M,P,O,ue){var ce=typeof b;(ce==="undefined"||ce==="boolean")&&(b=null);var de=!1;if(b===null)de=!0;else switch(ce){case"string":case"number":de=!0;break;case"object":switch(b.$$typeof){case o:case a:de=!0}}if(de)return de=b,ue=ue(de),b=O===""?"."+we(de,0):O,ge(ue)?(P="",b!=null&&(P=b.replace(Te,"$&/")+"/"),ze(ue,M,P,"",function(se){return se})):ue!=null&&(ve(ue)&&(ue=De(ue,P+(!ue.key||de&&de.key===ue.key?"":(""+ue.key).replace(Te,"$&/")+"/")+b)),M.push(ue)),1;if(de=0,O=O===""?".":O+":",ge(b))for(var G=0;G<b.length;G++){ce=b[G];var te=O+we(ce,G);de+=ze(ce,M,P,te,ue)}else if(te=v(b),typeof te=="function")for(b=te.call(b),G=0;!(ce=b.next()).done;)ce=ce.value,te=O+we(ce,G++),de+=ze(ce,M,P,te,ue);else if(ce==="object")throw M=String(b),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return de}function Be(b,M,P){if(b==null)return b;var O=[],ue=0;return ze(b,O,"","",function(ce){return M.call(P,ce,ue++)}),O}function A(b){if(b._status===-1){var M=b._result;M=M(),M.then(function(P){(b._status===0||b._status===-1)&&(b._status=1,b._result=P)},function(P){(b._status===0||b._status===-1)&&(b._status=2,b._result=P)}),b._status===-1&&(b._status=0,b._result=M)}if(b._status===1)return b._result.default;throw b._result}var V={current:null},H={transition:null},Q={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:H,ReactCurrentOwner:K};function z(){throw Error("act(...) is not supported in production builds of React.")}return me.Children={map:Be,forEach:function(b,M,P){Be(b,function(){M.apply(this,arguments)},P)},count:function(b){var M=0;return Be(b,function(){M++}),M},toArray:function(b){return Be(b,function(M){return M})||[]},only:function(b){if(!ve(b))throw Error("React.Children.only expected to receive a single React element child.");return b}},me.Component=D,me.Fragment=i,me.Profiler=d,me.PureComponent=F,me.StrictMode=c,me.Suspense=h,me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,me.act=z,me.cloneElement=function(b,M,P){if(b==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+b+".");var O=j({},b.props),ue=b.key,ce=b.ref,de=b._owner;if(M!=null){if(M.ref!==void 0&&(ce=M.ref,de=K.current),M.key!==void 0&&(ue=""+M.key),b.type&&b.type.defaultProps)var G=b.type.defaultProps;for(te in M)oe.call(M,te)&&!Z.hasOwnProperty(te)&&(O[te]=M[te]===void 0&&G!==void 0?G[te]:M[te])}var te=arguments.length-2;if(te===1)O.children=P;else if(1<te){G=Array(te);for(var se=0;se<te;se++)G[se]=arguments[se+2];O.children=G}return{$$typeof:o,type:b.type,key:ue,ref:ce,props:O,_owner:de}},me.createContext=function(b){return b={$$typeof:f,_currentValue:b,_currentValue2:b,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},b.Provider={$$typeof:u,_context:b},b.Consumer=b},me.createElement=he,me.createFactory=function(b){var M=he.bind(null,b);return M.type=b,M},me.createRef=function(){return{current:null}},me.forwardRef=function(b){return{$$typeof:g,render:b}},me.isValidElement=ve,me.lazy=function(b){return{$$typeof:k,_payload:{_status:-1,_result:b},_init:A}},me.memo=function(b,M){return{$$typeof:m,type:b,compare:M===void 0?null:M}},me.startTransition=function(b){var M=H.transition;H.transition={};try{b()}finally{H.transition=M}},me.unstable_act=z,me.useCallback=function(b,M){return V.current.useCallback(b,M)},me.useContext=function(b){return V.current.useContext(b)},me.useDebugValue=function(){},me.useDeferredValue=function(b){return V.current.useDeferredValue(b)},me.useEffect=function(b,M){return V.current.useEffect(b,M)},me.useId=function(){return V.current.useId()},me.useImperativeHandle=function(b,M,P){return V.current.useImperativeHandle(b,M,P)},me.useInsertionEffect=function(b,M){return V.current.useInsertionEffect(b,M)},me.useLayoutEffect=function(b,M){return V.current.useLayoutEffect(b,M)},me.useMemo=function(b,M){return V.current.useMemo(b,M)},me.useReducer=function(b,M,P){return V.current.useReducer(b,M,P)},me.useRef=function(b){return V.current.useRef(b)},me.useState=function(b){return V.current.useState(b)},me.useSyncExternalStore=function(b,M,P){return V.current.useSyncExternalStore(b,M,P)},me.useTransition=function(){return V.current.useTransition()},me.version="18.3.1",me}var dc;function Sa(){return dc||(dc=1,ia.exports=Jf()),ia.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fc;function ep(){if(fc)return Zr;fc=1;var o=Sa(),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,d=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function f(g,h,m){var k,w={},v=null,T=null;m!==void 0&&(v=""+m),h.key!==void 0&&(v=""+h.key),h.ref!==void 0&&(T=h.ref);for(k in h)c.call(h,k)&&!u.hasOwnProperty(k)&&(w[k]=h[k]);if(g&&g.defaultProps)for(k in h=g.defaultProps,h)w[k]===void 0&&(w[k]=h[k]);return{$$typeof:a,type:g,key:v,ref:T,props:w,_owner:d.current}}return Zr.Fragment=i,Zr.jsx=f,Zr.jsxs=f,Zr}var pc;function tp(){return pc||(pc=1,oa.exports=ep()),oa.exports}var y=tp(),pe=Sa();const Lc=Fc(pe);var fi={},sa={exports:{}},pt={},aa={exports:{}},la={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gc;function np(){return gc||(gc=1,(function(o){function a(H,Q){var z=H.length;H.push(Q);e:for(;0<z;){var b=z-1>>>1,M=H[b];if(0<d(M,Q))H[b]=Q,H[z]=M,z=b;else break e}}function i(H){return H.length===0?null:H[0]}function c(H){if(H.length===0)return null;var Q=H[0],z=H.pop();if(z!==Q){H[0]=z;e:for(var b=0,M=H.length,P=M>>>1;b<P;){var O=2*(b+1)-1,ue=H[O],ce=O+1,de=H[ce];if(0>d(ue,z))ce<M&&0>d(de,ue)?(H[b]=de,H[ce]=z,b=ce):(H[b]=ue,H[O]=z,b=O);else if(ce<M&&0>d(de,z))H[b]=de,H[ce]=z,b=ce;else break e}}return Q}function d(H,Q){var z=H.sortIndex-Q.sortIndex;return z!==0?z:H.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;o.unstable_now=function(){return u.now()}}else{var f=Date,g=f.now();o.unstable_now=function(){return f.now()-g}}var h=[],m=[],k=1,w=null,v=3,T=!1,j=!1,$=!1,D=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie(H){for(var Q=i(m);Q!==null;){if(Q.callback===null)c(m);else if(Q.startTime<=H)c(m),Q.sortIndex=Q.expirationTime,a(h,Q);else break;Q=i(m)}}function ge(H){if($=!1,ie(H),!j)if(i(h)!==null)j=!0,A(oe);else{var Q=i(m);Q!==null&&V(ge,Q.startTime-H)}}function oe(H,Q){j=!1,$&&($=!1,B(he),he=-1),T=!0;var z=v;try{for(ie(Q),w=i(h);w!==null&&(!(w.expirationTime>Q)||H&&!Se());){var b=w.callback;if(typeof b=="function"){w.callback=null,v=w.priorityLevel;var M=b(w.expirationTime<=Q);Q=o.unstable_now(),typeof M=="function"?w.callback=M:w===i(h)&&c(h),ie(Q)}else c(h);w=i(h)}if(w!==null)var P=!0;else{var O=i(m);O!==null&&V(ge,O.startTime-Q),P=!1}return P}finally{w=null,v=z,T=!1}}var K=!1,Z=null,he=-1,De=5,ve=-1;function Se(){return!(o.unstable_now()-ve<De)}function Te(){if(Z!==null){var H=o.unstable_now();ve=H;var Q=!0;try{Q=Z(!0,H)}finally{Q?we():(K=!1,Z=null)}}else K=!1}var we;if(typeof F=="function")we=function(){F(Te)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,Be=ze.port2;ze.port1.onmessage=Te,we=function(){Be.postMessage(null)}}else we=function(){D(Te,0)};function A(H){Z=H,K||(K=!0,we())}function V(H,Q){he=D(function(){H(o.unstable_now())},Q)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(H){H.callback=null},o.unstable_continueExecution=function(){j||T||(j=!0,A(oe))},o.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):De=0<H?Math.floor(1e3/H):5},o.unstable_getCurrentPriorityLevel=function(){return v},o.unstable_getFirstCallbackNode=function(){return i(h)},o.unstable_next=function(H){switch(v){case 1:case 2:case 3:var Q=3;break;default:Q=v}var z=v;v=Q;try{return H()}finally{v=z}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(H,Q){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var z=v;v=H;try{return Q()}finally{v=z}},o.unstable_scheduleCallback=function(H,Q,z){var b=o.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?b+z:b):z=b,H){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=z+M,H={id:k++,callback:Q,priorityLevel:H,startTime:z,expirationTime:M,sortIndex:-1},z>b?(H.sortIndex=z,a(m,H),i(h)===null&&H===i(m)&&($?(B(he),he=-1):$=!0,V(ge,z-b))):(H.sortIndex=M,a(h,H),j||T||(j=!0,A(oe))),H},o.unstable_shouldYield=Se,o.unstable_wrapCallback=function(H){var Q=v;return function(){var z=v;v=Q;try{return H.apply(this,arguments)}finally{v=z}}}})(la)),la}var hc;function rp(){return hc||(hc=1,aa.exports=np()),aa.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yc;function op(){if(yc)return pt;yc=1;var o=Sa(),a=rp();function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=new Set,d={};function u(e,t){f(e,t),f(e+"Capture",t)}function f(e,t){for(d[e]=t,e=0;e<t.length;e++)c.add(t[e])}var g=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k={},w={};function v(e){return h.call(w,e)?!0:h.call(k,e)?!1:m.test(e)?w[e]=!0:(k[e]=!0,!1)}function T(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function j(e,t,n,r){if(t===null||typeof t>"u"||T(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $(e,t,n,r,s,l,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=p}var D={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){D[e]=new $(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];D[t]=new $(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){D[e]=new $(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){D[e]=new $(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){D[e]=new $(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){D[e]=new $(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){D[e]=new $(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){D[e]=new $(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){D[e]=new $(e,5,!1,e.toLowerCase(),null,!1,!1)});var B=/[\-:]([a-z])/g;function F(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(B,F);D[t]=new $(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(B,F);D[t]=new $(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(B,F);D[t]=new $(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){D[e]=new $(e,1,!1,e.toLowerCase(),null,!1,!1)}),D.xlinkHref=new $("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){D[e]=new $(e,1,!1,e.toLowerCase(),null,!0,!0)});function ie(e,t,n,r){var s=D.hasOwnProperty(t)?D[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(j(t,n,s,r)&&(n=null),r||s===null?v(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ge=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oe=Symbol.for("react.element"),K=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),he=Symbol.for("react.strict_mode"),De=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),Se=Symbol.for("react.context"),Te=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),ze=Symbol.for("react.suspense_list"),Be=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),H=Symbol.iterator;function Q(e){return e===null||typeof e!="object"?null:(e=H&&e[H]||e["@@iterator"],typeof e=="function"?e:null)}var z=Object.assign,b;function M(e){if(b===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);b=t&&t[1]||""}return`
`+b+e}var P=!1;function O(e,t){if(!e||P)return"";P=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(R){var r=R}Reflect.construct(e,[],t)}else{try{t.call()}catch(R){r=R}e.call(t.prototype)}else{try{throw Error()}catch(R){r=R}e()}}catch(R){if(R&&r&&typeof R.stack=="string"){for(var s=R.stack.split(`
`),l=r.stack.split(`
`),p=s.length-1,S=l.length-1;1<=p&&0<=S&&s[p]!==l[S];)S--;for(;1<=p&&0<=S;p--,S--)if(s[p]!==l[S]){if(p!==1||S!==1)do if(p--,S--,0>S||s[p]!==l[S]){var x=`
`+s[p].replace(" at new "," at ");return e.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",e.displayName)),x}while(1<=p&&0<=S);break}}}finally{P=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function ue(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=O(e.type,!1),e;case 11:return e=O(e.type.render,!1),e;case 1:return e=O(e.type,!0),e;default:return""}}function ce(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Z:return"Fragment";case K:return"Portal";case De:return"Profiler";case he:return"StrictMode";case we:return"Suspense";case ze:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Se:return(e.displayName||"Context")+".Consumer";case ve:return(e._context.displayName||"Context")+".Provider";case Te:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Be:return t=e.displayName||null,t!==null?t:ce(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return ce(e(t))}catch{}}return null}function de(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(t);case 8:return t===he?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function te(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function se(e){var t=te(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(p){r=""+p,l.call(this,p)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(p){r=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ye(e){e._valueTracker||(e._valueTracker=se(e))}function Ce(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=te(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function it(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vt(e,t){var n=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Qe(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=G(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $t(e,t){t=t.checked,t!=null&&ie(e,"checked",t,!1)}function kt(e,t){$t(e,t);var n=G(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?sn(e,t.type,n):t.hasOwnProperty("defaultValue")&&sn(e,t.type,G(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jt(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function sn(e,t,n){(t!=="number"||it(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var gt=Array.isArray;function St(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function xt(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(i(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function an(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(i(92));if(gt(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function Ee(e,t){var n=G(t.value),r=G(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ke(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $e(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mt(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$e(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var At,J=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(At=At||document.createElement("div"),At.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=At.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _e(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Re={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ht=["Webkit","ms","Moz","O"];Object.keys(Re).forEach(function(e){ht.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Re[t]=Re[e]})});function Et(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Re.hasOwnProperty(e)&&Re[e]?(""+t).trim():t+"px"}function Yt(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Et(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Vn=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ln(e,t){if(t){if(Vn[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(i(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(i(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(t.style!=null&&typeof t.style!="object")throw Error(i(62))}}function Ht(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function hr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ot=null,Hn=null,Gn=null;function _a(e){if(e=Nr(e)){if(typeof Ot!="function")throw Error(i(280));var t=e.stateNode;t&&(t=_o(t),Ot(e.stateNode,e.type,t))}}function Ra(e){Hn?Gn?Gn.push(e):Gn=[e]:Hn=e}function Pa(){if(Hn){var e=Hn,t=Gn;if(Gn=Hn=null,_a(e),t)for(e=0;e<t.length;e++)_a(t[e])}}function Da(e,t){return e(t)}function $a(){}var Si=!1;function ja(e,t,n){if(Si)return e(t,n);Si=!0;try{return Da(e,t,n)}finally{Si=!1,(Hn!==null||Gn!==null)&&($a(),Pa())}}function yr(e,t){var n=e.stateNode;if(n===null)return null;var r=_o(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(i(231,t,typeof n));return n}var xi=!1;if(g)try{var mr={};Object.defineProperty(mr,"passive",{get:function(){xi=!0}}),window.addEventListener("test",mr,mr),window.removeEventListener("test",mr,mr)}catch{xi=!1}function od(e,t,n,r,s,l,p,S,x){var R=Array.prototype.slice.call(arguments,3);try{t.apply(n,R)}catch(I){this.onError(I)}}var vr=!1,oo=null,io=!1,Ei=null,id={onError:function(e){vr=!0,oo=e}};function sd(e,t,n,r,s,l,p,S,x){vr=!1,oo=null,od.apply(id,arguments)}function ad(e,t,n,r,s,l,p,S,x){if(sd.apply(this,arguments),vr){if(vr){var R=oo;vr=!1,oo=null}else throw Error(i(198));io||(io=!0,Ei=R)}}function Pn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ma(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Aa(e){if(Pn(e)!==e)throw Error(i(188))}function ld(e){var t=e.alternate;if(!t){if(t=Pn(e),t===null)throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var l=s.alternate;if(l===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===n)return Aa(s),e;if(l===r)return Aa(s),t;l=l.sibling}throw Error(i(188))}if(n.return!==r.return)n=s,r=l;else{for(var p=!1,S=s.child;S;){if(S===n){p=!0,n=s,r=l;break}if(S===r){p=!0,r=s,n=l;break}S=S.sibling}if(!p){for(S=l.child;S;){if(S===n){p=!0,n=l,r=s;break}if(S===r){p=!0,r=l,n=s;break}S=S.sibling}if(!p)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function Oa(e){return e=ld(e),e!==null?za(e):null}function za(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=za(e);if(t!==null)return t;e=e.sibling}return null}var Na=a.unstable_scheduleCallback,Ba=a.unstable_cancelCallback,ud=a.unstable_shouldYield,cd=a.unstable_requestPaint,We=a.unstable_now,dd=a.unstable_getCurrentPriorityLevel,bi=a.unstable_ImmediatePriority,Ia=a.unstable_UserBlockingPriority,so=a.unstable_NormalPriority,fd=a.unstable_LowPriority,Fa=a.unstable_IdlePriority,ao=null,Gt=null;function pd(e){if(Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(ao,e,void 0,(e.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:yd,gd=Math.log,hd=Math.LN2;function yd(e){return e>>>=0,e===0?32:31-(gd(e)/hd|0)|0}var lo=64,uo=4194304;function wr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function co(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,l=e.pingedLanes,p=n&268435455;if(p!==0){var S=p&~s;S!==0?r=wr(S):(l&=p,l!==0&&(r=wr(l)))}else p=n&~s,p!==0?r=wr(p):l!==0&&(r=wr(l));if(r===0)return 0;if(t!==0&&t!==r&&(t&s)===0&&(s=r&-r,l=t&-t,s>=l||s===16&&(l&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-zt(t),s=1<<n,r|=e[n],t&=~s;return r}function md(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,l=e.pendingLanes;0<l;){var p=31-zt(l),S=1<<p,x=s[p];x===-1?((S&n)===0||(S&r)!==0)&&(s[p]=md(S,t)):x<=t&&(e.expiredLanes|=S),l&=~S}}function Ti(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function La(){var e=lo;return lo<<=1,(lo&4194240)===0&&(lo=64),e}function Ci(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function kr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zt(t),e[t]=n}function wd(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-zt(n),l=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~l}}function _i(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-zt(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Pe=0;function Wa(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Va,Ri,Ha,Ga,Ua,Pi=!1,fo=[],un=null,cn=null,dn=null,Sr=new Map,xr=new Map,fn=[],kd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qa(e,t){switch(e){case"focusin":case"focusout":un=null;break;case"dragenter":case"dragleave":cn=null;break;case"mouseover":case"mouseout":dn=null;break;case"pointerover":case"pointerout":Sr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xr.delete(t.pointerId)}}function Er(e,t,n,r,s,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[s]},t!==null&&(t=Nr(t),t!==null&&Ri(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Sd(e,t,n,r,s){switch(t){case"focusin":return un=Er(un,e,t,n,r,s),!0;case"dragenter":return cn=Er(cn,e,t,n,r,s),!0;case"mouseover":return dn=Er(dn,e,t,n,r,s),!0;case"pointerover":var l=s.pointerId;return Sr.set(l,Er(Sr.get(l)||null,e,t,n,r,s)),!0;case"gotpointercapture":return l=s.pointerId,xr.set(l,Er(xr.get(l)||null,e,t,n,r,s)),!0}return!1}function Ka(e){var t=Dn(e.target);if(t!==null){var n=Pn(t);if(n!==null){if(t=n.tag,t===13){if(t=Ma(n),t!==null){e.blockedOn=t,Ua(e.priority,function(){Ha(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function po(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=$i(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null}else return t=Nr(n),t!==null&&Ri(t),e.blockedOn=n,!1;t.shift()}return!0}function qa(e,t,n){po(e)&&n.delete(t)}function xd(){Pi=!1,un!==null&&po(un)&&(un=null),cn!==null&&po(cn)&&(cn=null),dn!==null&&po(dn)&&(dn=null),Sr.forEach(qa),xr.forEach(qa)}function br(e,t){e.blockedOn===t&&(e.blockedOn=null,Pi||(Pi=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,xd)))}function Tr(e){function t(s){return br(s,e)}if(0<fo.length){br(fo[0],e);for(var n=1;n<fo.length;n++){var r=fo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(un!==null&&br(un,e),cn!==null&&br(cn,e),dn!==null&&br(dn,e),Sr.forEach(t),xr.forEach(t),n=0;n<fn.length;n++)r=fn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<fn.length&&(n=fn[0],n.blockedOn===null);)Ka(n),n.blockedOn===null&&fn.shift()}var Un=ge.ReactCurrentBatchConfig,go=!0;function Ed(e,t,n,r){var s=Pe,l=Un.transition;Un.transition=null;try{Pe=1,Di(e,t,n,r)}finally{Pe=s,Un.transition=l}}function bd(e,t,n,r){var s=Pe,l=Un.transition;Un.transition=null;try{Pe=4,Di(e,t,n,r)}finally{Pe=s,Un.transition=l}}function Di(e,t,n,r){if(go){var s=$i(e,t,n,r);if(s===null)Ki(e,t,r,ho,n),Qa(e,r);else if(Sd(s,e,t,n,r))r.stopPropagation();else if(Qa(e,r),t&4&&-1<kd.indexOf(e)){for(;s!==null;){var l=Nr(s);if(l!==null&&Va(l),l=$i(e,t,n,r),l===null&&Ki(e,t,r,ho,n),l===s)break;s=l}s!==null&&r.stopPropagation()}else Ki(e,t,r,null,n)}}var ho=null;function $i(e,t,n,r){if(ho=null,e=hr(r),e=Dn(e),e!==null)if(t=Pn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Ma(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ho=e,null}function Ya(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dd()){case bi:return 1;case Ia:return 4;case so:case fd:return 16;case Fa:return 536870912;default:return 16}default:return 16}}var pn=null,ji=null,yo=null;function Xa(){if(yo)return yo;var e,t=ji,n=t.length,r,s="value"in pn?pn.value:pn.textContent,l=s.length;for(e=0;e<n&&t[e]===s[e];e++);var p=n-e;for(r=1;r<=p&&t[n-r]===s[l-r];r++);return yo=s.slice(e,1<r?1-r:void 0)}function mo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vo(){return!0}function Za(){return!1}function yt(e){function t(n,r,s,l,p){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=l,this.target=p,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(l):l[S]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?vo:Za,this.isPropagationStopped=Za,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),t}var Qn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mi=yt(Qn),Cr=z({},Qn,{view:0,detail:0}),Td=yt(Cr),Ai,Oi,_r,wo=z({},Cr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ni,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_r&&(_r&&e.type==="mousemove"?(Ai=e.screenX-_r.screenX,Oi=e.screenY-_r.screenY):Oi=Ai=0,_r=e),Ai)},movementY:function(e){return"movementY"in e?e.movementY:Oi}}),Ja=yt(wo),Cd=z({},wo,{dataTransfer:0}),_d=yt(Cd),Rd=z({},Cr,{relatedTarget:0}),zi=yt(Rd),Pd=z({},Qn,{animationName:0,elapsedTime:0,pseudoElement:0}),Dd=yt(Pd),$d=z({},Qn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jd=yt($d),Md=z({},Qn,{data:0}),el=yt(Md),Ad={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Od={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nd(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zd[e])?!!t[e]:!1}function Ni(){return Nd}var Bd=z({},Cr,{key:function(e){if(e.key){var t=Ad[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=mo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Od[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ni,charCode:function(e){return e.type==="keypress"?mo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Id=yt(Bd),Fd=z({},wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tl=yt(Fd),Ld=z({},Cr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ni}),Wd=yt(Ld),Vd=z({},Qn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hd=yt(Vd),Gd=z({},wo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ud=yt(Gd),Qd=[9,13,27,32],Bi=g&&"CompositionEvent"in window,Rr=null;g&&"documentMode"in document&&(Rr=document.documentMode);var Kd=g&&"TextEvent"in window&&!Rr,nl=g&&(!Bi||Rr&&8<Rr&&11>=Rr),rl=" ",ol=!1;function il(e,t){switch(e){case"keyup":return Qd.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sl(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Kn=!1;function qd(e,t){switch(e){case"compositionend":return sl(t);case"keypress":return t.which!==32?null:(ol=!0,rl);case"textInput":return e=t.data,e===rl&&ol?null:e;default:return null}}function Yd(e,t){if(Kn)return e==="compositionend"||!Bi&&il(e,t)?(e=Xa(),yo=ji=pn=null,Kn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nl&&t.locale!=="ko"?null:t.data;default:return null}}var Xd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function al(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xd[e.type]:t==="textarea"}function ll(e,t,n,r){Ra(r),t=bo(t,"onChange"),0<t.length&&(n=new Mi("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Pr=null,Dr=null;function Zd(e){Cl(e,0)}function ko(e){var t=Jn(e);if(Ce(t))return e}function Jd(e,t){if(e==="change")return t}var ul=!1;if(g){var Ii;if(g){var Fi="oninput"in document;if(!Fi){var cl=document.createElement("div");cl.setAttribute("oninput","return;"),Fi=typeof cl.oninput=="function"}Ii=Fi}else Ii=!1;ul=Ii&&(!document.documentMode||9<document.documentMode)}function dl(){Pr&&(Pr.detachEvent("onpropertychange",fl),Dr=Pr=null)}function fl(e){if(e.propertyName==="value"&&ko(Dr)){var t=[];ll(t,Dr,e,hr(e)),ja(Zd,t)}}function ef(e,t,n){e==="focusin"?(dl(),Pr=t,Dr=n,Pr.attachEvent("onpropertychange",fl)):e==="focusout"&&dl()}function tf(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ko(Dr)}function nf(e,t){if(e==="click")return ko(t)}function rf(e,t){if(e==="input"||e==="change")return ko(t)}function of(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nt=typeof Object.is=="function"?Object.is:of;function $r(e,t){if(Nt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!h.call(t,s)||!Nt(e[s],t[s]))return!1}return!0}function pl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gl(e,t){var n=pl(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pl(n)}}function hl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yl(){for(var e=window,t=it();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=it(e.document)}return t}function Li(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function sf(e){var t=yl(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hl(n.ownerDocument.documentElement,n)){if(r!==null&&Li(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,l=Math.min(r.start,s);r=r.end===void 0?l:Math.min(r.end,s),!e.extend&&l>r&&(s=r,r=l,l=s),s=gl(n,l);var p=gl(n,r);s&&p&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var af=g&&"documentMode"in document&&11>=document.documentMode,qn=null,Wi=null,jr=null,Vi=!1;function ml(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vi||qn==null||qn!==it(r)||(r=qn,"selectionStart"in r&&Li(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),jr&&$r(jr,r)||(jr=r,r=bo(Wi,"onSelect"),0<r.length&&(t=new Mi("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=qn)))}function So(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Yn={animationend:So("Animation","AnimationEnd"),animationiteration:So("Animation","AnimationIteration"),animationstart:So("Animation","AnimationStart"),transitionend:So("Transition","TransitionEnd")},Hi={},vl={};g&&(vl=document.createElement("div").style,"AnimationEvent"in window||(delete Yn.animationend.animation,delete Yn.animationiteration.animation,delete Yn.animationstart.animation),"TransitionEvent"in window||delete Yn.transitionend.transition);function xo(e){if(Hi[e])return Hi[e];if(!Yn[e])return e;var t=Yn[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in vl)return Hi[e]=t[n];return e}var wl=xo("animationend"),kl=xo("animationiteration"),Sl=xo("animationstart"),xl=xo("transitionend"),El=new Map,bl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gn(e,t){El.set(e,t),u(t,[e])}for(var Gi=0;Gi<bl.length;Gi++){var Ui=bl[Gi],lf=Ui.toLowerCase(),uf=Ui[0].toUpperCase()+Ui.slice(1);gn(lf,"on"+uf)}gn(wl,"onAnimationEnd"),gn(kl,"onAnimationIteration"),gn(Sl,"onAnimationStart"),gn("dblclick","onDoubleClick"),gn("focusin","onFocus"),gn("focusout","onBlur"),gn(xl,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Tl(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,ad(r,t,void 0,e),e.currentTarget=null}function Cl(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var p=r.length-1;0<=p;p--){var S=r[p],x=S.instance,R=S.currentTarget;if(S=S.listener,x!==l&&s.isPropagationStopped())break e;Tl(s,S,R),l=x}else for(p=0;p<r.length;p++){if(S=r[p],x=S.instance,R=S.currentTarget,S=S.listener,x!==l&&s.isPropagationStopped())break e;Tl(s,S,R),l=x}}}if(io)throw e=Ei,io=!1,Ei=null,e}function Me(e,t){var n=t[es];n===void 0&&(n=t[es]=new Set);var r=e+"__bubble";n.has(r)||(_l(t,e,2,!1),n.add(r))}function Qi(e,t,n){var r=0;t&&(r|=4),_l(n,e,r,t)}var Eo="_reactListening"+Math.random().toString(36).slice(2);function Ar(e){if(!e[Eo]){e[Eo]=!0,c.forEach(function(n){n!=="selectionchange"&&(cf.has(n)||Qi(n,!1,e),Qi(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Eo]||(t[Eo]=!0,Qi("selectionchange",!1,t))}}function _l(e,t,n,r){switch(Ya(t)){case 1:var s=Ed;break;case 4:s=bd;break;default:s=Di}n=s.bind(null,t,n,e),s=void 0,!xi||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ki(e,t,n,r,s){var l=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var p=r.tag;if(p===3||p===4){var S=r.stateNode.containerInfo;if(S===s||S.nodeType===8&&S.parentNode===s)break;if(p===4)for(p=r.return;p!==null;){var x=p.tag;if((x===3||x===4)&&(x=p.stateNode.containerInfo,x===s||x.nodeType===8&&x.parentNode===s))return;p=p.return}for(;S!==null;){if(p=Dn(S),p===null)return;if(x=p.tag,x===5||x===6){r=l=p;continue e}S=S.parentNode}}r=r.return}ja(function(){var R=l,I=hr(n),L=[];e:{var N=El.get(e);if(N!==void 0){var Y=Mi,ee=e;switch(e){case"keypress":if(mo(n)===0)break e;case"keydown":case"keyup":Y=Id;break;case"focusin":ee="focus",Y=zi;break;case"focusout":ee="blur",Y=zi;break;case"beforeblur":case"afterblur":Y=zi;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Ja;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=_d;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=Wd;break;case wl:case kl:case Sl:Y=Dd;break;case xl:Y=Hd;break;case"scroll":Y=Td;break;case"wheel":Y=Ud;break;case"copy":case"cut":case"paste":Y=jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=tl}var ne=(t&4)!==0,Ve=!ne&&e==="scroll",C=ne?N!==null?N+"Capture":null:N;ne=[];for(var E=R,_;E!==null;){_=E;var W=_.stateNode;if(_.tag===5&&W!==null&&(_=W,C!==null&&(W=yr(E,C),W!=null&&ne.push(Or(E,W,_)))),Ve)break;E=E.return}0<ne.length&&(N=new Y(N,ee,null,n,I),L.push({event:N,listeners:ne}))}}if((t&7)===0){e:{if(N=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",N&&n!==be&&(ee=n.relatedTarget||n.fromElement)&&(Dn(ee)||ee[Xt]))break e;if((Y||N)&&(N=I.window===I?I:(N=I.ownerDocument)?N.defaultView||N.parentWindow:window,Y?(ee=n.relatedTarget||n.toElement,Y=R,ee=ee?Dn(ee):null,ee!==null&&(Ve=Pn(ee),ee!==Ve||ee.tag!==5&&ee.tag!==6)&&(ee=null)):(Y=null,ee=R),Y!==ee)){if(ne=Ja,W="onMouseLeave",C="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(ne=tl,W="onPointerLeave",C="onPointerEnter",E="pointer"),Ve=Y==null?N:Jn(Y),_=ee==null?N:Jn(ee),N=new ne(W,E+"leave",Y,n,I),N.target=Ve,N.relatedTarget=_,W=null,Dn(I)===R&&(ne=new ne(C,E+"enter",ee,n,I),ne.target=_,ne.relatedTarget=Ve,W=ne),Ve=W,Y&&ee)t:{for(ne=Y,C=ee,E=0,_=ne;_;_=Xn(_))E++;for(_=0,W=C;W;W=Xn(W))_++;for(;0<E-_;)ne=Xn(ne),E--;for(;0<_-E;)C=Xn(C),_--;for(;E--;){if(ne===C||C!==null&&ne===C.alternate)break t;ne=Xn(ne),C=Xn(C)}ne=null}else ne=null;Y!==null&&Rl(L,N,Y,ne,!1),ee!==null&&Ve!==null&&Rl(L,Ve,ee,ne,!0)}}e:{if(N=R?Jn(R):window,Y=N.nodeName&&N.nodeName.toLowerCase(),Y==="select"||Y==="input"&&N.type==="file")var re=Jd;else if(al(N))if(ul)re=rf;else{re=tf;var ae=ef}else(Y=N.nodeName)&&Y.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(re=nf);if(re&&(re=re(e,R))){ll(L,re,n,I);break e}ae&&ae(e,N,R),e==="focusout"&&(ae=N._wrapperState)&&ae.controlled&&N.type==="number"&&sn(N,"number",N.value)}switch(ae=R?Jn(R):window,e){case"focusin":(al(ae)||ae.contentEditable==="true")&&(qn=ae,Wi=R,jr=null);break;case"focusout":jr=Wi=qn=null;break;case"mousedown":Vi=!0;break;case"contextmenu":case"mouseup":case"dragend":Vi=!1,ml(L,n,I);break;case"selectionchange":if(af)break;case"keydown":case"keyup":ml(L,n,I)}var le;if(Bi)e:{switch(e){case"compositionstart":var fe="onCompositionStart";break e;case"compositionend":fe="onCompositionEnd";break e;case"compositionupdate":fe="onCompositionUpdate";break e}fe=void 0}else Kn?il(e,n)&&(fe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(fe="onCompositionStart");fe&&(nl&&n.locale!=="ko"&&(Kn||fe!=="onCompositionStart"?fe==="onCompositionEnd"&&Kn&&(le=Xa()):(pn=I,ji="value"in pn?pn.value:pn.textContent,Kn=!0)),ae=bo(R,fe),0<ae.length&&(fe=new el(fe,e,null,n,I),L.push({event:fe,listeners:ae}),le?fe.data=le:(le=sl(n),le!==null&&(fe.data=le)))),(le=Kd?qd(e,n):Yd(e,n))&&(R=bo(R,"onBeforeInput"),0<R.length&&(I=new el("onBeforeInput","beforeinput",null,n,I),L.push({event:I,listeners:R}),I.data=le))}Cl(L,t)})}function Or(e,t,n){return{instance:e,listener:t,currentTarget:n}}function bo(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,l=s.stateNode;s.tag===5&&l!==null&&(s=l,l=yr(e,n),l!=null&&r.unshift(Or(e,l,s)),l=yr(e,t),l!=null&&r.push(Or(e,l,s))),e=e.return}return r}function Xn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rl(e,t,n,r,s){for(var l=t._reactName,p=[];n!==null&&n!==r;){var S=n,x=S.alternate,R=S.stateNode;if(x!==null&&x===r)break;S.tag===5&&R!==null&&(S=R,s?(x=yr(n,l),x!=null&&p.unshift(Or(n,x,S))):s||(x=yr(n,l),x!=null&&p.push(Or(n,x,S)))),n=n.return}p.length!==0&&e.push({event:t,listeners:p})}var df=/\r\n?/g,ff=/\u0000|\uFFFD/g;function Pl(e){return(typeof e=="string"?e:""+e).replace(df,`
`).replace(ff,"")}function To(e,t,n){if(t=Pl(t),Pl(e)!==t&&n)throw Error(i(425))}function Co(){}var qi=null,Yi=null;function Xi(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zi=typeof setTimeout=="function"?setTimeout:void 0,pf=typeof clearTimeout=="function"?clearTimeout:void 0,Dl=typeof Promise=="function"?Promise:void 0,gf=typeof queueMicrotask=="function"?queueMicrotask:typeof Dl<"u"?function(e){return Dl.resolve(null).then(e).catch(hf)}:Zi;function hf(e){setTimeout(function(){throw e})}function Ji(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Tr(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Tr(t)}function hn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $l(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Zn=Math.random().toString(36).slice(2),Ut="__reactFiber$"+Zn,zr="__reactProps$"+Zn,Xt="__reactContainer$"+Zn,es="__reactEvents$"+Zn,yf="__reactListeners$"+Zn,mf="__reactHandles$"+Zn;function Dn(e){var t=e[Ut];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Xt]||n[Ut]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=$l(e);e!==null;){if(n=e[Ut])return n;e=$l(e)}return t}e=n,n=e.parentNode}return null}function Nr(e){return e=e[Ut]||e[Xt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(i(33))}function _o(e){return e[zr]||null}var ts=[],er=-1;function yn(e){return{current:e}}function Ae(e){0>er||(e.current=ts[er],ts[er]=null,er--)}function je(e,t){er++,ts[er]=e.current,e.current=t}var mn={},tt=yn(mn),lt=yn(!1),$n=mn;function tr(e,t){var n=e.type.contextTypes;if(!n)return mn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},l;for(l in n)s[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ut(e){return e=e.childContextTypes,e!=null}function Ro(){Ae(lt),Ae(tt)}function jl(e,t,n){if(tt.current!==mn)throw Error(i(168));je(tt,t),je(lt,n)}function Ml(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(i(108,de(e)||"Unknown",s));return z({},n,r)}function Po(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mn,$n=tt.current,je(tt,e),je(lt,lt.current),!0}function Al(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ml(e,t,$n),r.__reactInternalMemoizedMergedChildContext=e,Ae(lt),Ae(tt),je(tt,e)):Ae(lt),je(lt,n)}var Zt=null,Do=!1,ns=!1;function Ol(e){Zt===null?Zt=[e]:Zt.push(e)}function vf(e){Do=!0,Ol(e)}function vn(){if(!ns&&Zt!==null){ns=!0;var e=0,t=Pe;try{var n=Zt;for(Pe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zt=null,Do=!1}catch(s){throw Zt!==null&&(Zt=Zt.slice(e+1)),Na(bi,vn),s}finally{Pe=t,ns=!1}}return null}var nr=[],rr=0,$o=null,jo=0,bt=[],Tt=0,jn=null,Jt=1,en="";function Mn(e,t){nr[rr++]=jo,nr[rr++]=$o,$o=e,jo=t}function zl(e,t,n){bt[Tt++]=Jt,bt[Tt++]=en,bt[Tt++]=jn,jn=e;var r=Jt;e=en;var s=32-zt(r)-1;r&=~(1<<s),n+=1;var l=32-zt(t)+s;if(30<l){var p=s-s%5;l=(r&(1<<p)-1).toString(32),r>>=p,s-=p,Jt=1<<32-zt(t)+s|n<<s|r,en=l+e}else Jt=1<<l|n<<s|r,en=e}function rs(e){e.return!==null&&(Mn(e,1),zl(e,1,0))}function os(e){for(;e===$o;)$o=nr[--rr],nr[rr]=null,jo=nr[--rr],nr[rr]=null;for(;e===jn;)jn=bt[--Tt],bt[Tt]=null,en=bt[--Tt],bt[Tt]=null,Jt=bt[--Tt],bt[Tt]=null}var mt=null,vt=null,Ne=!1,Bt=null;function Nl(e,t){var n=Pt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Bl(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mt=e,vt=hn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mt=e,vt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=jn!==null?{id:Jt,overflow:en}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Pt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,mt=e,vt=null,!0):!1;default:return!1}}function is(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ss(e){if(Ne){var t=vt;if(t){var n=t;if(!Bl(e,t)){if(is(e))throw Error(i(418));t=hn(n.nextSibling);var r=mt;t&&Bl(e,t)?Nl(r,n):(e.flags=e.flags&-4097|2,Ne=!1,mt=e)}}else{if(is(e))throw Error(i(418));e.flags=e.flags&-4097|2,Ne=!1,mt=e}}}function Il(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mt=e}function Mo(e){if(e!==mt)return!1;if(!Ne)return Il(e),Ne=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xi(e.type,e.memoizedProps)),t&&(t=vt)){if(is(e))throw Fl(),Error(i(418));for(;t;)Nl(e,t),t=hn(t.nextSibling)}if(Il(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){vt=hn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}vt=null}}else vt=mt?hn(e.stateNode.nextSibling):null;return!0}function Fl(){for(var e=vt;e;)e=hn(e.nextSibling)}function or(){vt=mt=null,Ne=!1}function as(e){Bt===null?Bt=[e]:Bt.push(e)}var wf=ge.ReactCurrentBatchConfig;function Br(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var s=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(p){var S=s.refs;p===null?delete S[l]:S[l]=p},t._stringRef=l,t)}if(typeof e!="string")throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Ao(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ll(e){var t=e._init;return t(e._payload)}function Wl(e){function t(C,E){if(e){var _=C.deletions;_===null?(C.deletions=[E],C.flags|=16):_.push(E)}}function n(C,E){if(!e)return null;for(;E!==null;)t(C,E),E=E.sibling;return null}function r(C,E){for(C=new Map;E!==null;)E.key!==null?C.set(E.key,E):C.set(E.index,E),E=E.sibling;return C}function s(C,E){return C=Cn(C,E),C.index=0,C.sibling=null,C}function l(C,E,_){return C.index=_,e?(_=C.alternate,_!==null?(_=_.index,_<E?(C.flags|=2,E):_):(C.flags|=2,E)):(C.flags|=1048576,E)}function p(C){return e&&C.alternate===null&&(C.flags|=2),C}function S(C,E,_,W){return E===null||E.tag!==6?(E=Zs(_,C.mode,W),E.return=C,E):(E=s(E,_),E.return=C,E)}function x(C,E,_,W){var re=_.type;return re===Z?I(C,E,_.props.children,W,_.key):E!==null&&(E.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===A&&Ll(re)===E.type)?(W=s(E,_.props),W.ref=Br(C,E,_),W.return=C,W):(W=oi(_.type,_.key,_.props,null,C.mode,W),W.ref=Br(C,E,_),W.return=C,W)}function R(C,E,_,W){return E===null||E.tag!==4||E.stateNode.containerInfo!==_.containerInfo||E.stateNode.implementation!==_.implementation?(E=Js(_,C.mode,W),E.return=C,E):(E=s(E,_.children||[]),E.return=C,E)}function I(C,E,_,W,re){return E===null||E.tag!==7?(E=Ln(_,C.mode,W,re),E.return=C,E):(E=s(E,_),E.return=C,E)}function L(C,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Zs(""+E,C.mode,_),E.return=C,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case oe:return _=oi(E.type,E.key,E.props,null,C.mode,_),_.ref=Br(C,null,E),_.return=C,_;case K:return E=Js(E,C.mode,_),E.return=C,E;case A:var W=E._init;return L(C,W(E._payload),_)}if(gt(E)||Q(E))return E=Ln(E,C.mode,_,null),E.return=C,E;Ao(C,E)}return null}function N(C,E,_,W){var re=E!==null?E.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return re!==null?null:S(C,E,""+_,W);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case oe:return _.key===re?x(C,E,_,W):null;case K:return _.key===re?R(C,E,_,W):null;case A:return re=_._init,N(C,E,re(_._payload),W)}if(gt(_)||Q(_))return re!==null?null:I(C,E,_,W,null);Ao(C,_)}return null}function Y(C,E,_,W,re){if(typeof W=="string"&&W!==""||typeof W=="number")return C=C.get(_)||null,S(E,C,""+W,re);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case oe:return C=C.get(W.key===null?_:W.key)||null,x(E,C,W,re);case K:return C=C.get(W.key===null?_:W.key)||null,R(E,C,W,re);case A:var ae=W._init;return Y(C,E,_,ae(W._payload),re)}if(gt(W)||Q(W))return C=C.get(_)||null,I(E,C,W,re,null);Ao(E,W)}return null}function ee(C,E,_,W){for(var re=null,ae=null,le=E,fe=E=0,Xe=null;le!==null&&fe<_.length;fe++){le.index>fe?(Xe=le,le=null):Xe=le.sibling;var xe=N(C,le,_[fe],W);if(xe===null){le===null&&(le=Xe);break}e&&le&&xe.alternate===null&&t(C,le),E=l(xe,E,fe),ae===null?re=xe:ae.sibling=xe,ae=xe,le=Xe}if(fe===_.length)return n(C,le),Ne&&Mn(C,fe),re;if(le===null){for(;fe<_.length;fe++)le=L(C,_[fe],W),le!==null&&(E=l(le,E,fe),ae===null?re=le:ae.sibling=le,ae=le);return Ne&&Mn(C,fe),re}for(le=r(C,le);fe<_.length;fe++)Xe=Y(le,C,fe,_[fe],W),Xe!==null&&(e&&Xe.alternate!==null&&le.delete(Xe.key===null?fe:Xe.key),E=l(Xe,E,fe),ae===null?re=Xe:ae.sibling=Xe,ae=Xe);return e&&le.forEach(function(_n){return t(C,_n)}),Ne&&Mn(C,fe),re}function ne(C,E,_,W){var re=Q(_);if(typeof re!="function")throw Error(i(150));if(_=re.call(_),_==null)throw Error(i(151));for(var ae=re=null,le=E,fe=E=0,Xe=null,xe=_.next();le!==null&&!xe.done;fe++,xe=_.next()){le.index>fe?(Xe=le,le=null):Xe=le.sibling;var _n=N(C,le,xe.value,W);if(_n===null){le===null&&(le=Xe);break}e&&le&&_n.alternate===null&&t(C,le),E=l(_n,E,fe),ae===null?re=_n:ae.sibling=_n,ae=_n,le=Xe}if(xe.done)return n(C,le),Ne&&Mn(C,fe),re;if(le===null){for(;!xe.done;fe++,xe=_.next())xe=L(C,xe.value,W),xe!==null&&(E=l(xe,E,fe),ae===null?re=xe:ae.sibling=xe,ae=xe);return Ne&&Mn(C,fe),re}for(le=r(C,le);!xe.done;fe++,xe=_.next())xe=Y(le,C,fe,xe.value,W),xe!==null&&(e&&xe.alternate!==null&&le.delete(xe.key===null?fe:xe.key),E=l(xe,E,fe),ae===null?re=xe:ae.sibling=xe,ae=xe);return e&&le.forEach(function(Zf){return t(C,Zf)}),Ne&&Mn(C,fe),re}function Ve(C,E,_,W){if(typeof _=="object"&&_!==null&&_.type===Z&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case oe:e:{for(var re=_.key,ae=E;ae!==null;){if(ae.key===re){if(re=_.type,re===Z){if(ae.tag===7){n(C,ae.sibling),E=s(ae,_.props.children),E.return=C,C=E;break e}}else if(ae.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===A&&Ll(re)===ae.type){n(C,ae.sibling),E=s(ae,_.props),E.ref=Br(C,ae,_),E.return=C,C=E;break e}n(C,ae);break}else t(C,ae);ae=ae.sibling}_.type===Z?(E=Ln(_.props.children,C.mode,W,_.key),E.return=C,C=E):(W=oi(_.type,_.key,_.props,null,C.mode,W),W.ref=Br(C,E,_),W.return=C,C=W)}return p(C);case K:e:{for(ae=_.key;E!==null;){if(E.key===ae)if(E.tag===4&&E.stateNode.containerInfo===_.containerInfo&&E.stateNode.implementation===_.implementation){n(C,E.sibling),E=s(E,_.children||[]),E.return=C,C=E;break e}else{n(C,E);break}else t(C,E);E=E.sibling}E=Js(_,C.mode,W),E.return=C,C=E}return p(C);case A:return ae=_._init,Ve(C,E,ae(_._payload),W)}if(gt(_))return ee(C,E,_,W);if(Q(_))return ne(C,E,_,W);Ao(C,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,E!==null&&E.tag===6?(n(C,E.sibling),E=s(E,_),E.return=C,C=E):(n(C,E),E=Zs(_,C.mode,W),E.return=C,C=E),p(C)):n(C,E)}return Ve}var ir=Wl(!0),Vl=Wl(!1),Oo=yn(null),zo=null,sr=null,ls=null;function us(){ls=sr=zo=null}function cs(e){var t=Oo.current;Ae(Oo),e._currentValue=t}function ds(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ar(e,t){zo=e,ls=sr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(ct=!0),e.firstContext=null)}function Ct(e){var t=e._currentValue;if(ls!==e)if(e={context:e,memoizedValue:t,next:null},sr===null){if(zo===null)throw Error(i(308));sr=e,zo.dependencies={lanes:0,firstContext:e}}else sr=sr.next=e;return t}var An=null;function fs(e){An===null?An=[e]:An.push(e)}function Hl(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,fs(t)):(n.next=s.next,s.next=n),t.interleaved=n,tn(e,r)}function tn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var wn=!1;function ps(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(ke&2)!==0){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,tn(e,n)}return s=r.interleaved,s===null?(t.next=t,fs(r)):(t.next=s.next,s.next=t),r.interleaved=t,tn(e,n)}function No(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,_i(e,n)}}function Ul(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?s=l=p:l=l.next=p,n=n.next}while(n!==null);l===null?s=l=t:l=l.next=t}else s=l=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bo(e,t,n,r){var s=e.updateQueue;wn=!1;var l=s.firstBaseUpdate,p=s.lastBaseUpdate,S=s.shared.pending;if(S!==null){s.shared.pending=null;var x=S,R=x.next;x.next=null,p===null?l=R:p.next=R,p=x;var I=e.alternate;I!==null&&(I=I.updateQueue,S=I.lastBaseUpdate,S!==p&&(S===null?I.firstBaseUpdate=R:S.next=R,I.lastBaseUpdate=x))}if(l!==null){var L=s.baseState;p=0,I=R=x=null,S=l;do{var N=S.lane,Y=S.eventTime;if((r&N)===N){I!==null&&(I=I.next={eventTime:Y,lane:0,tag:S.tag,payload:S.payload,callback:S.callback,next:null});e:{var ee=e,ne=S;switch(N=t,Y=n,ne.tag){case 1:if(ee=ne.payload,typeof ee=="function"){L=ee.call(Y,L,N);break e}L=ee;break e;case 3:ee.flags=ee.flags&-65537|128;case 0:if(ee=ne.payload,N=typeof ee=="function"?ee.call(Y,L,N):ee,N==null)break e;L=z({},L,N);break e;case 2:wn=!0}}S.callback!==null&&S.lane!==0&&(e.flags|=64,N=s.effects,N===null?s.effects=[S]:N.push(S))}else Y={eventTime:Y,lane:N,tag:S.tag,payload:S.payload,callback:S.callback,next:null},I===null?(R=I=Y,x=L):I=I.next=Y,p|=N;if(S=S.next,S===null){if(S=s.shared.pending,S===null)break;N=S,S=N.next,N.next=null,s.lastBaseUpdate=N,s.shared.pending=null}}while(!0);if(I===null&&(x=L),s.baseState=x,s.firstBaseUpdate=R,s.lastBaseUpdate=I,t=s.shared.interleaved,t!==null){s=t;do p|=s.lane,s=s.next;while(s!==t)}else l===null&&(s.shared.lanes=0);Nn|=p,e.lanes=p,e.memoizedState=L}}function Ql(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(i(191,s));s.call(r)}}}var Ir={},Qt=yn(Ir),Fr=yn(Ir),Lr=yn(Ir);function On(e){if(e===Ir)throw Error(i(174));return e}function gs(e,t){switch(je(Lr,t),je(Fr,e),je(Qt,Ir),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mt(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mt(t,e)}Ae(Qt),je(Qt,t)}function lr(){Ae(Qt),Ae(Fr),Ae(Lr)}function Kl(e){On(Lr.current);var t=On(Qt.current),n=Mt(t,e.type);t!==n&&(je(Fr,e),je(Qt,n))}function hs(e){Fr.current===e&&(Ae(Qt),Ae(Fr))}var Ie=yn(0);function Io(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ys=[];function ms(){for(var e=0;e<ys.length;e++)ys[e]._workInProgressVersionPrimary=null;ys.length=0}var Fo=ge.ReactCurrentDispatcher,vs=ge.ReactCurrentBatchConfig,zn=0,Fe=null,Ge=null,qe=null,Lo=!1,Wr=!1,Vr=0,kf=0;function nt(){throw Error(i(321))}function ws(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Nt(e[n],t[n]))return!1;return!0}function ks(e,t,n,r,s,l){if(zn=l,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Fo.current=e===null||e.memoizedState===null?bf:Tf,e=n(r,s),Wr){l=0;do{if(Wr=!1,Vr=0,25<=l)throw Error(i(301));l+=1,qe=Ge=null,t.updateQueue=null,Fo.current=Cf,e=n(r,s)}while(Wr)}if(Fo.current=Ho,t=Ge!==null&&Ge.next!==null,zn=0,qe=Ge=Fe=null,Lo=!1,t)throw Error(i(300));return e}function Ss(){var e=Vr!==0;return Vr=0,e}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Fe.memoizedState=qe=e:qe=qe.next=e,qe}function _t(){if(Ge===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=Ge.next;var t=qe===null?Fe.memoizedState:qe.next;if(t!==null)qe=t,Ge=e;else{if(e===null)throw Error(i(310));Ge=e,e={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},qe===null?Fe.memoizedState=qe=e:qe=qe.next=e}return qe}function Hr(e,t){return typeof t=="function"?t(e):t}function xs(e){var t=_t(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var r=Ge,s=r.baseQueue,l=n.pending;if(l!==null){if(s!==null){var p=s.next;s.next=l.next,l.next=p}r.baseQueue=s=l,n.pending=null}if(s!==null){l=s.next,r=r.baseState;var S=p=null,x=null,R=l;do{var I=R.lane;if((zn&I)===I)x!==null&&(x=x.next={lane:0,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null}),r=R.hasEagerState?R.eagerState:e(r,R.action);else{var L={lane:I,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null};x===null?(S=x=L,p=r):x=x.next=L,Fe.lanes|=I,Nn|=I}R=R.next}while(R!==null&&R!==l);x===null?p=r:x.next=S,Nt(r,t.memoizedState)||(ct=!0),t.memoizedState=r,t.baseState=p,t.baseQueue=x,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do l=s.lane,Fe.lanes|=l,Nn|=l,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Es(e){var t=_t(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,l=t.memoizedState;if(s!==null){n.pending=null;var p=s=s.next;do l=e(l,p.action),p=p.next;while(p!==s);Nt(l,t.memoizedState)||(ct=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function ql(){}function Yl(e,t){var n=Fe,r=_t(),s=t(),l=!Nt(r.memoizedState,s);if(l&&(r.memoizedState=s,ct=!0),r=r.queue,bs(Jl.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,Gr(9,Zl.bind(null,n,r,s,t),void 0,null),Ye===null)throw Error(i(349));(zn&30)!==0||Xl(n,t,s)}return s}function Xl(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Zl(e,t,n,r){t.value=n,t.getSnapshot=r,eu(t)&&tu(e)}function Jl(e,t,n){return n(function(){eu(t)&&tu(e)})}function eu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Nt(e,n)}catch{return!0}}function tu(e){var t=tn(e,1);t!==null&&Wt(t,e,1,-1)}function nu(e){var t=Kt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:e},t.queue=e,e=e.dispatch=Ef.bind(null,Fe,e),[t.memoizedState,e]}function Gr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ru(){return _t().memoizedState}function Wo(e,t,n,r){var s=Kt();Fe.flags|=e,s.memoizedState=Gr(1|t,n,void 0,r===void 0?null:r)}function Vo(e,t,n,r){var s=_t();r=r===void 0?null:r;var l=void 0;if(Ge!==null){var p=Ge.memoizedState;if(l=p.destroy,r!==null&&ws(r,p.deps)){s.memoizedState=Gr(t,n,l,r);return}}Fe.flags|=e,s.memoizedState=Gr(1|t,n,l,r)}function ou(e,t){return Wo(8390656,8,e,t)}function bs(e,t){return Vo(2048,8,e,t)}function iu(e,t){return Vo(4,2,e,t)}function su(e,t){return Vo(4,4,e,t)}function au(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lu(e,t,n){return n=n!=null?n.concat([e]):null,Vo(4,4,au.bind(null,t,e),n)}function Ts(){}function uu(e,t){var n=_t();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ws(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function cu(e,t){var n=_t();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ws(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function du(e,t,n){return(zn&21)===0?(e.baseState&&(e.baseState=!1,ct=!0),e.memoizedState=n):(Nt(n,t)||(n=La(),Fe.lanes|=n,Nn|=n,e.baseState=!0),t)}function Sf(e,t){var n=Pe;Pe=n!==0&&4>n?n:4,e(!0);var r=vs.transition;vs.transition={};try{e(!1),t()}finally{Pe=n,vs.transition=r}}function fu(){return _t().memoizedState}function xf(e,t,n){var r=bn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},pu(e))gu(t,n);else if(n=Hl(e,t,n,r),n!==null){var s=at();Wt(n,e,r,s),hu(n,t,r)}}function Ef(e,t,n){var r=bn(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(pu(e))gu(t,s);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var p=t.lastRenderedState,S=l(p,n);if(s.hasEagerState=!0,s.eagerState=S,Nt(S,p)){var x=t.interleaved;x===null?(s.next=s,fs(t)):(s.next=x.next,x.next=s),t.interleaved=s;return}}catch{}finally{}n=Hl(e,t,s,r),n!==null&&(s=at(),Wt(n,e,r,s),hu(n,t,r))}}function pu(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function gu(e,t){Wr=Lo=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hu(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,_i(e,n)}}var Ho={readContext:Ct,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useInsertionEffect:nt,useLayoutEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useMutableSource:nt,useSyncExternalStore:nt,useId:nt,unstable_isNewReconciler:!1},bf={readContext:Ct,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:Ct,useEffect:ou,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Wo(4194308,4,au.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wo(4,2,e,t)},useMemo:function(e,t){var n=Kt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Kt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=xf.bind(null,Fe,e),[r.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:nu,useDebugValue:Ts,useDeferredValue:function(e){return Kt().memoizedState=e},useTransition:function(){var e=nu(!1),t=e[0];return e=Sf.bind(null,e[1]),Kt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Fe,s=Kt();if(Ne){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),Ye===null)throw Error(i(349));(zn&30)!==0||Xl(r,t,n)}s.memoizedState=n;var l={value:n,getSnapshot:t};return s.queue=l,ou(Jl.bind(null,r,l,e),[e]),r.flags|=2048,Gr(9,Zl.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=Kt(),t=Ye.identifierPrefix;if(Ne){var n=en,r=Jt;n=(r&~(1<<32-zt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Vr++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=kf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tf={readContext:Ct,useCallback:uu,useContext:Ct,useEffect:bs,useImperativeHandle:lu,useInsertionEffect:iu,useLayoutEffect:su,useMemo:cu,useReducer:xs,useRef:ru,useState:function(){return xs(Hr)},useDebugValue:Ts,useDeferredValue:function(e){var t=_t();return du(t,Ge.memoizedState,e)},useTransition:function(){var e=xs(Hr)[0],t=_t().memoizedState;return[e,t]},useMutableSource:ql,useSyncExternalStore:Yl,useId:fu,unstable_isNewReconciler:!1},Cf={readContext:Ct,useCallback:uu,useContext:Ct,useEffect:bs,useImperativeHandle:lu,useInsertionEffect:iu,useLayoutEffect:su,useMemo:cu,useReducer:Es,useRef:ru,useState:function(){return Es(Hr)},useDebugValue:Ts,useDeferredValue:function(e){var t=_t();return Ge===null?t.memoizedState=e:du(t,Ge.memoizedState,e)},useTransition:function(){var e=Es(Hr)[0],t=_t().memoizedState;return[e,t]},useMutableSource:ql,useSyncExternalStore:Yl,useId:fu,unstable_isNewReconciler:!1};function It(e,t){if(e&&e.defaultProps){t=z({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Cs(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:z({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Go={isMounted:function(e){return(e=e._reactInternals)?Pn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=at(),s=bn(e),l=nn(r,s);l.payload=t,n!=null&&(l.callback=n),t=kn(e,l,s),t!==null&&(Wt(t,e,s,r),No(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=at(),s=bn(e),l=nn(r,s);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=kn(e,l,s),t!==null&&(Wt(t,e,s,r),No(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=at(),r=bn(e),s=nn(n,r);s.tag=2,t!=null&&(s.callback=t),t=kn(e,s,r),t!==null&&(Wt(t,e,r,n),No(t,e,r))}};function yu(e,t,n,r,s,l,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,p):t.prototype&&t.prototype.isPureReactComponent?!$r(n,r)||!$r(s,l):!0}function mu(e,t,n){var r=!1,s=mn,l=t.contextType;return typeof l=="object"&&l!==null?l=Ct(l):(s=ut(t)?$n:tt.current,r=t.contextTypes,l=(r=r!=null)?tr(e,s):mn),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Go,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=l),t}function vu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Go.enqueueReplaceState(t,t.state,null)}function _s(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},ps(e);var l=t.contextType;typeof l=="object"&&l!==null?s.context=Ct(l):(l=ut(t)?$n:tt.current,s.context=tr(e,l)),s.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Cs(e,t,l,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Go.enqueueReplaceState(s,s.state,null),Bo(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ur(e,t){try{var n="",r=t;do n+=ue(r),r=r.return;while(r);var s=n}catch(l){s=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:s,digest:null}}function Rs(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ps(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _f=typeof WeakMap=="function"?WeakMap:Map;function wu(e,t,n){n=nn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Zo||(Zo=!0,Hs=r),Ps(e,t)},n}function ku(e,t,n){n=nn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Ps(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Ps(e,t),typeof r!="function"&&(xn===null?xn=new Set([this]):xn.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),n}function Su(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _f;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Lf.bind(null,e,t,n),t.then(e,e))}function xu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Eu(e,t,n,r,s){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=nn(-1,1),t.tag=2,kn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var Rf=ge.ReactCurrentOwner,ct=!1;function st(e,t,n,r){t.child=e===null?Vl(t,null,n,r):ir(t,e.child,n,r)}function bu(e,t,n,r,s){n=n.render;var l=t.ref;return ar(t,s),r=ks(e,t,n,r,l,s),n=Ss(),e!==null&&!ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,rn(e,t,s)):(Ne&&n&&rs(t),t.flags|=1,st(e,t,r,s),t.child)}function Tu(e,t,n,r,s){if(e===null){var l=n.type;return typeof l=="function"&&!Xs(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Cu(e,t,l,r,s)):(e=oi(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,(e.lanes&s)===0){var p=l.memoizedProps;if(n=n.compare,n=n!==null?n:$r,n(p,r)&&e.ref===t.ref)return rn(e,t,s)}return t.flags|=1,e=Cn(l,r),e.ref=t.ref,e.return=t,t.child=e}function Cu(e,t,n,r,s){if(e!==null){var l=e.memoizedProps;if($r(l,r)&&e.ref===t.ref)if(ct=!1,t.pendingProps=r=l,(e.lanes&s)!==0)(e.flags&131072)!==0&&(ct=!0);else return t.lanes=e.lanes,rn(e,t,s)}return Ds(e,t,n,r,s)}function _u(e,t,n){var r=t.pendingProps,s=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(dr,wt),wt|=n;else{if((n&1073741824)===0)return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,je(dr,wt),wt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,je(dr,wt),wt|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,je(dr,wt),wt|=r;return st(e,t,s,n),t.child}function Ru(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ds(e,t,n,r,s){var l=ut(n)?$n:tt.current;return l=tr(t,l),ar(t,s),n=ks(e,t,n,r,l,s),r=Ss(),e!==null&&!ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,rn(e,t,s)):(Ne&&r&&rs(t),t.flags|=1,st(e,t,n,s),t.child)}function Pu(e,t,n,r,s){if(ut(n)){var l=!0;Po(t)}else l=!1;if(ar(t,s),t.stateNode===null)Qo(e,t),mu(t,n,r),_s(t,n,r,s),r=!0;else if(e===null){var p=t.stateNode,S=t.memoizedProps;p.props=S;var x=p.context,R=n.contextType;typeof R=="object"&&R!==null?R=Ct(R):(R=ut(n)?$n:tt.current,R=tr(t,R));var I=n.getDerivedStateFromProps,L=typeof I=="function"||typeof p.getSnapshotBeforeUpdate=="function";L||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==r||x!==R)&&vu(t,p,r,R),wn=!1;var N=t.memoizedState;p.state=N,Bo(t,r,p,s),x=t.memoizedState,S!==r||N!==x||lt.current||wn?(typeof I=="function"&&(Cs(t,n,I,r),x=t.memoizedState),(S=wn||yu(t,n,S,r,N,x,R))?(L||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=x),p.props=r,p.state=x,p.context=R,r=S):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{p=t.stateNode,Gl(e,t),S=t.memoizedProps,R=t.type===t.elementType?S:It(t.type,S),p.props=R,L=t.pendingProps,N=p.context,x=n.contextType,typeof x=="object"&&x!==null?x=Ct(x):(x=ut(n)?$n:tt.current,x=tr(t,x));var Y=n.getDerivedStateFromProps;(I=typeof Y=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==L||N!==x)&&vu(t,p,r,x),wn=!1,N=t.memoizedState,p.state=N,Bo(t,r,p,s);var ee=t.memoizedState;S!==L||N!==ee||lt.current||wn?(typeof Y=="function"&&(Cs(t,n,Y,r),ee=t.memoizedState),(R=wn||yu(t,n,R,r,N,ee,x)||!1)?(I||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(r,ee,x),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(r,ee,x)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&N===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&N===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=ee),p.props=r,p.state=ee,p.context=x,r=R):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&N===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&N===e.memoizedState||(t.flags|=1024),r=!1)}return $s(e,t,n,r,l,s)}function $s(e,t,n,r,s,l){Ru(e,t);var p=(t.flags&128)!==0;if(!r&&!p)return s&&Al(t,n,!1),rn(e,t,l);r=t.stateNode,Rf.current=t;var S=p&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&p?(t.child=ir(t,e.child,null,l),t.child=ir(t,null,S,l)):st(e,t,S,l),t.memoizedState=r.state,s&&Al(t,n,!0),t.child}function Du(e){var t=e.stateNode;t.pendingContext?jl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&jl(e,t.context,!1),gs(e,t.containerInfo)}function $u(e,t,n,r,s){return or(),as(s),t.flags|=256,st(e,t,n,r),t.child}var js={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function ju(e,t,n){var r=t.pendingProps,s=Ie.current,l=!1,p=(t.flags&128)!==0,S;if((S=p)||(S=e!==null&&e.memoizedState===null?!1:(s&2)!==0),S?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),je(Ie,s&1),e===null)return ss(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(p=r.children,e=r.fallback,l?(r=t.mode,l=t.child,p={mode:"hidden",children:p},(r&1)===0&&l!==null?(l.childLanes=0,l.pendingProps=p):l=ii(p,r,0,null),e=Ln(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Ms(n),t.memoizedState=js,e):As(t,p));if(s=e.memoizedState,s!==null&&(S=s.dehydrated,S!==null))return Pf(e,t,p,r,S,s,n);if(l){l=r.fallback,p=t.mode,s=e.child,S=s.sibling;var x={mode:"hidden",children:r.children};return(p&1)===0&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=x,t.deletions=null):(r=Cn(s,x),r.subtreeFlags=s.subtreeFlags&14680064),S!==null?l=Cn(S,l):(l=Ln(l,p,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,p=e.child.memoizedState,p=p===null?Ms(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},l.memoizedState=p,l.childLanes=e.childLanes&~n,t.memoizedState=js,r}return l=e.child,e=l.sibling,r=Cn(l,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function As(e,t){return t=ii({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Uo(e,t,n,r){return r!==null&&as(r),ir(t,e.child,null,n),e=As(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pf(e,t,n,r,s,l,p){if(n)return t.flags&256?(t.flags&=-257,r=Rs(Error(i(422))),Uo(e,t,p,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,s=t.mode,r=ii({mode:"visible",children:r.children},s,0,null),l=Ln(l,s,p,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,(t.mode&1)!==0&&ir(t,e.child,null,p),t.child.memoizedState=Ms(p),t.memoizedState=js,l);if((t.mode&1)===0)return Uo(e,t,p,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var S=r.dgst;return r=S,l=Error(i(419)),r=Rs(l,r,void 0),Uo(e,t,p,r)}if(S=(p&e.childLanes)!==0,ct||S){if(r=Ye,r!==null){switch(p&-p){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=(s&(r.suspendedLanes|p))!==0?0:s,s!==0&&s!==l.retryLane&&(l.retryLane=s,tn(e,s),Wt(r,e,s,-1))}return Ys(),r=Rs(Error(i(421))),Uo(e,t,p,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Wf.bind(null,e),s._reactRetry=t,null):(e=l.treeContext,vt=hn(s.nextSibling),mt=t,Ne=!0,Bt=null,e!==null&&(bt[Tt++]=Jt,bt[Tt++]=en,bt[Tt++]=jn,Jt=e.id,en=e.overflow,jn=t),t=As(t,r.children),t.flags|=4096,t)}function Mu(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ds(e.return,t,n)}function Os(e,t,n,r,s){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=s)}function Au(e,t,n){var r=t.pendingProps,s=r.revealOrder,l=r.tail;if(st(e,t,r.children,n),r=Ie.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Mu(e,n,t);else if(e.tag===19)Mu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(je(Ie,r),(t.mode&1)===0)t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Io(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Os(t,!1,s,n,l);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Io(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Os(t,!0,n,null,l);break;case"together":Os(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qo(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function rn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Nn|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=Cn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Cn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Df(e,t,n){switch(t.tag){case 3:Du(t),or();break;case 5:Kl(t);break;case 1:ut(t.type)&&Po(t);break;case 4:gs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;je(Oo,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(je(Ie,Ie.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?ju(e,t,n):(je(Ie,Ie.current&1),e=rn(e,t,n),e!==null?e.sibling:null);je(Ie,Ie.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return Au(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),je(Ie,Ie.current),r)break;return null;case 22:case 23:return t.lanes=0,_u(e,t,n)}return rn(e,t,n)}var Ou,zs,zu,Nu;Ou=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},zs=function(){},zu=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,On(Qt.current);var l=null;switch(n){case"input":s=Vt(e,s),r=Vt(e,r),l=[];break;case"select":s=z({},s,{value:void 0}),r=z({},r,{value:void 0}),l=[];break;case"textarea":s=xt(e,s),r=xt(e,r),l=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Co)}ln(n,r);var p;n=null;for(R in s)if(!r.hasOwnProperty(R)&&s.hasOwnProperty(R)&&s[R]!=null)if(R==="style"){var S=s[R];for(p in S)S.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else R!=="dangerouslySetInnerHTML"&&R!=="children"&&R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(d.hasOwnProperty(R)?l||(l=[]):(l=l||[]).push(R,null));for(R in r){var x=r[R];if(S=s!=null?s[R]:void 0,r.hasOwnProperty(R)&&x!==S&&(x!=null||S!=null))if(R==="style")if(S){for(p in S)!S.hasOwnProperty(p)||x&&x.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in x)x.hasOwnProperty(p)&&S[p]!==x[p]&&(n||(n={}),n[p]=x[p])}else n||(l||(l=[]),l.push(R,n)),n=x;else R==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,S=S?S.__html:void 0,x!=null&&S!==x&&(l=l||[]).push(R,x)):R==="children"?typeof x!="string"&&typeof x!="number"||(l=l||[]).push(R,""+x):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&(d.hasOwnProperty(R)?(x!=null&&R==="onScroll"&&Me("scroll",e),l||S===x||(l=[])):(l=l||[]).push(R,x))}n&&(l=l||[]).push("style",n);var R=l;(t.updateQueue=R)&&(t.flags|=4)}},Nu=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ur(e,t){if(!Ne)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $f(e,t,n){var r=t.pendingProps;switch(os(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(t),null;case 1:return ut(t.type)&&Ro(),rt(t),null;case 3:return r=t.stateNode,lr(),Ae(lt),Ae(tt),ms(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Mo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Bt!==null&&(Qs(Bt),Bt=null))),zs(e,t),rt(t),null;case 5:hs(t);var s=On(Lr.current);if(n=t.type,e!==null&&t.stateNode!=null)zu(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(i(166));return rt(t),null}if(e=On(Qt.current),Mo(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[Ut]=t,r[zr]=l,e=(t.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(s=0;s<Mr.length;s++)Me(Mr[s],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Qe(r,l),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Me("invalid",r);break;case"textarea":an(r,l),Me("invalid",r)}ln(n,l),s=null;for(var p in l)if(l.hasOwnProperty(p)){var S=l[p];p==="children"?typeof S=="string"?r.textContent!==S&&(l.suppressHydrationWarning!==!0&&To(r.textContent,S,e),s=["children",S]):typeof S=="number"&&r.textContent!==""+S&&(l.suppressHydrationWarning!==!0&&To(r.textContent,S,e),s=["children",""+S]):d.hasOwnProperty(p)&&S!=null&&p==="onScroll"&&Me("scroll",r)}switch(n){case"input":ye(r),jt(r,l,!0);break;case"textarea":ye(r),Ke(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=Co)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{p=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$e(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=p.createElement(n,{is:r.is}):(e=p.createElement(n),n==="select"&&(p=e,r.multiple?p.multiple=!0:r.size&&(p.size=r.size))):e=p.createElementNS(e,n),e[Ut]=t,e[zr]=r,Ou(e,t,!1,!1),t.stateNode=e;e:{switch(p=Ht(n,r),n){case"dialog":Me("cancel",e),Me("close",e),s=r;break;case"iframe":case"object":case"embed":Me("load",e),s=r;break;case"video":case"audio":for(s=0;s<Mr.length;s++)Me(Mr[s],e);s=r;break;case"source":Me("error",e),s=r;break;case"img":case"image":case"link":Me("error",e),Me("load",e),s=r;break;case"details":Me("toggle",e),s=r;break;case"input":Qe(e,r),s=Vt(e,r),Me("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=z({},r,{value:void 0}),Me("invalid",e);break;case"textarea":an(e,r),s=xt(e,r),Me("invalid",e);break;default:s=r}ln(n,s),S=s;for(l in S)if(S.hasOwnProperty(l)){var x=S[l];l==="style"?Yt(e,x):l==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&J(e,x)):l==="children"?typeof x=="string"?(n!=="textarea"||x!=="")&&_e(e,x):typeof x=="number"&&_e(e,""+x):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(d.hasOwnProperty(l)?x!=null&&l==="onScroll"&&Me("scroll",e):x!=null&&ie(e,l,x,p))}switch(n){case"input":ye(e),jt(e,r,!1);break;case"textarea":ye(e),Ke(e);break;case"option":r.value!=null&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?St(e,!!r.multiple,l,!1):r.defaultValue!=null&&St(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Co)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return rt(t),null;case 6:if(e&&t.stateNode!=null)Nu(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(i(166));if(n=On(Lr.current),On(Qt.current),Mo(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ut]=t,(l=r.nodeValue!==n)&&(e=mt,e!==null))switch(e.tag){case 3:To(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&To(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ut]=t,t.stateNode=r}return rt(t),null;case 13:if(Ae(Ie),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ne&&vt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Fl(),or(),t.flags|=98560,l=!1;else if(l=Mo(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(i(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(i(317));l[Ut]=t}else or(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;rt(t),l=!1}else Bt!==null&&(Qs(Bt),Bt=null),l=!0;if(!l)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Ie.current&1)!==0?Ue===0&&(Ue=3):Ys())),t.updateQueue!==null&&(t.flags|=4),rt(t),null);case 4:return lr(),zs(e,t),e===null&&Ar(t.stateNode.containerInfo),rt(t),null;case 10:return cs(t.type._context),rt(t),null;case 17:return ut(t.type)&&Ro(),rt(t),null;case 19:if(Ae(Ie),l=t.memoizedState,l===null)return rt(t),null;if(r=(t.flags&128)!==0,p=l.rendering,p===null)if(r)Ur(l,!1);else{if(Ue!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(p=Io(e),p!==null){for(t.flags|=128,Ur(l,!1),r=p.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,p=l.alternate,p===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=p.childLanes,l.lanes=p.lanes,l.child=p.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=p.memoizedProps,l.memoizedState=p.memoizedState,l.updateQueue=p.updateQueue,l.type=p.type,e=p.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return je(Ie,Ie.current&1|2),t.child}e=e.sibling}l.tail!==null&&We()>fr&&(t.flags|=128,r=!0,Ur(l,!1),t.lanes=4194304)}else{if(!r)if(e=Io(p),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ur(l,!0),l.tail===null&&l.tailMode==="hidden"&&!p.alternate&&!Ne)return rt(t),null}else 2*We()-l.renderingStartTime>fr&&n!==1073741824&&(t.flags|=128,r=!0,Ur(l,!1),t.lanes=4194304);l.isBackwards?(p.sibling=t.child,t.child=p):(n=l.last,n!==null?n.sibling=p:t.child=p,l.last=p)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=We(),t.sibling=null,n=Ie.current,je(Ie,r?n&1|2:n&1),t):(rt(t),null);case 22:case 23:return qs(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(wt&1073741824)!==0&&(rt(t),t.subtreeFlags&6&&(t.flags|=8192)):rt(t),null;case 24:return null;case 25:return null}throw Error(i(156,t.tag))}function jf(e,t){switch(os(t),t.tag){case 1:return ut(t.type)&&Ro(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return lr(),Ae(lt),Ae(tt),ms(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return hs(t),null;case 13:if(Ae(Ie),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));or()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ae(Ie),null;case 4:return lr(),null;case 10:return cs(t.type._context),null;case 22:case 23:return qs(),null;case 24:return null;default:return null}}var Ko=!1,ot=!1,Mf=typeof WeakSet=="function"?WeakSet:Set,X=null;function cr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Le(e,t,r)}else n.current=null}function Ns(e,t,n){try{n()}catch(r){Le(e,t,r)}}var Bu=!1;function Af(e,t){if(qi=go,e=yl(),Li(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var p=0,S=-1,x=-1,R=0,I=0,L=e,N=null;t:for(;;){for(var Y;L!==n||s!==0&&L.nodeType!==3||(S=p+s),L!==l||r!==0&&L.nodeType!==3||(x=p+r),L.nodeType===3&&(p+=L.nodeValue.length),(Y=L.firstChild)!==null;)N=L,L=Y;for(;;){if(L===e)break t;if(N===n&&++R===s&&(S=p),N===l&&++I===r&&(x=p),(Y=L.nextSibling)!==null)break;L=N,N=L.parentNode}L=Y}n=S===-1||x===-1?null:{start:S,end:x}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yi={focusedElem:e,selectionRange:n},go=!1,X=t;X!==null;)if(t=X,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,X=e;else for(;X!==null;){t=X;try{var ee=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ee!==null){var ne=ee.memoizedProps,Ve=ee.memoizedState,C=t.stateNode,E=C.getSnapshotBeforeUpdate(t.elementType===t.type?ne:It(t.type,ne),Ve);C.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(W){Le(t,t.return,W)}if(e=t.sibling,e!==null){e.return=t.return,X=e;break}X=t.return}return ee=Bu,Bu=!1,ee}function Qr(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var l=s.destroy;s.destroy=void 0,l!==void 0&&Ns(t,n,l)}s=s.next}while(s!==r)}}function qo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Bs(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Iu(e){var t=e.alternate;t!==null&&(e.alternate=null,Iu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ut],delete t[zr],delete t[es],delete t[yf],delete t[mf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fu(e){return e.tag===5||e.tag===3||e.tag===4}function Lu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Is(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Co));else if(r!==4&&(e=e.child,e!==null))for(Is(e,t,n),e=e.sibling;e!==null;)Is(e,t,n),e=e.sibling}function Fs(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Fs(e,t,n),e=e.sibling;e!==null;)Fs(e,t,n),e=e.sibling}var Ze=null,Ft=!1;function Sn(e,t,n){for(n=n.child;n!==null;)Wu(e,t,n),n=n.sibling}function Wu(e,t,n){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(ao,n)}catch{}switch(n.tag){case 5:ot||cr(n,t);case 6:var r=Ze,s=Ft;Ze=null,Sn(e,t,n),Ze=r,Ft=s,Ze!==null&&(Ft?(e=Ze,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ze.removeChild(n.stateNode));break;case 18:Ze!==null&&(Ft?(e=Ze,n=n.stateNode,e.nodeType===8?Ji(e.parentNode,n):e.nodeType===1&&Ji(e,n),Tr(e)):Ji(Ze,n.stateNode));break;case 4:r=Ze,s=Ft,Ze=n.stateNode.containerInfo,Ft=!0,Sn(e,t,n),Ze=r,Ft=s;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var l=s,p=l.destroy;l=l.tag,p!==void 0&&((l&2)!==0||(l&4)!==0)&&Ns(n,t,p),s=s.next}while(s!==r)}Sn(e,t,n);break;case 1:if(!ot&&(cr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(S){Le(n,t,S)}Sn(e,t,n);break;case 21:Sn(e,t,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,Sn(e,t,n),ot=r):Sn(e,t,n);break;default:Sn(e,t,n)}}function Vu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Mf),t.forEach(function(r){var s=Vf.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Lt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var l=e,p=t,S=p;e:for(;S!==null;){switch(S.tag){case 5:Ze=S.stateNode,Ft=!1;break e;case 3:Ze=S.stateNode.containerInfo,Ft=!0;break e;case 4:Ze=S.stateNode.containerInfo,Ft=!0;break e}S=S.return}if(Ze===null)throw Error(i(160));Wu(l,p,s),Ze=null,Ft=!1;var x=s.alternate;x!==null&&(x.return=null),s.return=null}catch(R){Le(s,t,R)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hu(t,e),t=t.sibling}function Hu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Lt(t,e),qt(e),r&4){try{Qr(3,e,e.return),qo(3,e)}catch(ne){Le(e,e.return,ne)}try{Qr(5,e,e.return)}catch(ne){Le(e,e.return,ne)}}break;case 1:Lt(t,e),qt(e),r&512&&n!==null&&cr(n,n.return);break;case 5:if(Lt(t,e),qt(e),r&512&&n!==null&&cr(n,n.return),e.flags&32){var s=e.stateNode;try{_e(s,"")}catch(ne){Le(e,e.return,ne)}}if(r&4&&(s=e.stateNode,s!=null)){var l=e.memoizedProps,p=n!==null?n.memoizedProps:l,S=e.type,x=e.updateQueue;if(e.updateQueue=null,x!==null)try{S==="input"&&l.type==="radio"&&l.name!=null&&$t(s,l),Ht(S,p);var R=Ht(S,l);for(p=0;p<x.length;p+=2){var I=x[p],L=x[p+1];I==="style"?Yt(s,L):I==="dangerouslySetInnerHTML"?J(s,L):I==="children"?_e(s,L):ie(s,I,L,R)}switch(S){case"input":kt(s,l);break;case"textarea":Ee(s,l);break;case"select":var N=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!l.multiple;var Y=l.value;Y!=null?St(s,!!l.multiple,Y,!1):N!==!!l.multiple&&(l.defaultValue!=null?St(s,!!l.multiple,l.defaultValue,!0):St(s,!!l.multiple,l.multiple?[]:"",!1))}s[zr]=l}catch(ne){Le(e,e.return,ne)}}break;case 6:if(Lt(t,e),qt(e),r&4){if(e.stateNode===null)throw Error(i(162));s=e.stateNode,l=e.memoizedProps;try{s.nodeValue=l}catch(ne){Le(e,e.return,ne)}}break;case 3:if(Lt(t,e),qt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Tr(t.containerInfo)}catch(ne){Le(e,e.return,ne)}break;case 4:Lt(t,e),qt(e);break;case 13:Lt(t,e),qt(e),s=e.child,s.flags&8192&&(l=s.memoizedState!==null,s.stateNode.isHidden=l,!l||s.alternate!==null&&s.alternate.memoizedState!==null||(Vs=We())),r&4&&Vu(e);break;case 22:if(I=n!==null&&n.memoizedState!==null,e.mode&1?(ot=(R=ot)||I,Lt(t,e),ot=R):Lt(t,e),qt(e),r&8192){if(R=e.memoizedState!==null,(e.stateNode.isHidden=R)&&!I&&(e.mode&1)!==0)for(X=e,I=e.child;I!==null;){for(L=X=I;X!==null;){switch(N=X,Y=N.child,N.tag){case 0:case 11:case 14:case 15:Qr(4,N,N.return);break;case 1:cr(N,N.return);var ee=N.stateNode;if(typeof ee.componentWillUnmount=="function"){r=N,n=N.return;try{t=r,ee.props=t.memoizedProps,ee.state=t.memoizedState,ee.componentWillUnmount()}catch(ne){Le(r,n,ne)}}break;case 5:cr(N,N.return);break;case 22:if(N.memoizedState!==null){Qu(L);continue}}Y!==null?(Y.return=N,X=Y):Qu(L)}I=I.sibling}e:for(I=null,L=e;;){if(L.tag===5){if(I===null){I=L;try{s=L.stateNode,R?(l=s.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(S=L.stateNode,x=L.memoizedProps.style,p=x!=null&&x.hasOwnProperty("display")?x.display:null,S.style.display=Et("display",p))}catch(ne){Le(e,e.return,ne)}}}else if(L.tag===6){if(I===null)try{L.stateNode.nodeValue=R?"":L.memoizedProps}catch(ne){Le(e,e.return,ne)}}else if((L.tag!==22&&L.tag!==23||L.memoizedState===null||L===e)&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===e)break e;for(;L.sibling===null;){if(L.return===null||L.return===e)break e;I===L&&(I=null),L=L.return}I===L&&(I=null),L.sibling.return=L.return,L=L.sibling}}break;case 19:Lt(t,e),qt(e),r&4&&Vu(e);break;case 21:break;default:Lt(t,e),qt(e)}}function qt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Fu(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(_e(s,""),r.flags&=-33);var l=Lu(e);Fs(e,l,s);break;case 3:case 4:var p=r.stateNode.containerInfo,S=Lu(e);Is(e,S,p);break;default:throw Error(i(161))}}catch(x){Le(e,e.return,x)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Of(e,t,n){X=e,Gu(e)}function Gu(e,t,n){for(var r=(e.mode&1)!==0;X!==null;){var s=X,l=s.child;if(s.tag===22&&r){var p=s.memoizedState!==null||Ko;if(!p){var S=s.alternate,x=S!==null&&S.memoizedState!==null||ot;S=Ko;var R=ot;if(Ko=p,(ot=x)&&!R)for(X=s;X!==null;)p=X,x=p.child,p.tag===22&&p.memoizedState!==null?Ku(s):x!==null?(x.return=p,X=x):Ku(s);for(;l!==null;)X=l,Gu(l),l=l.sibling;X=s,Ko=S,ot=R}Uu(e)}else(s.subtreeFlags&8772)!==0&&l!==null?(l.return=s,X=l):Uu(e)}}function Uu(e){for(;X!==null;){var t=X;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:ot||qo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ot)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:It(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Ql(t,l,r);break;case 3:var p=t.updateQueue;if(p!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Ql(t,p,n)}break;case 5:var S=t.stateNode;if(n===null&&t.flags&4){n=S;var x=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&n.focus();break;case"img":x.src&&(n.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var R=t.alternate;if(R!==null){var I=R.memoizedState;if(I!==null){var L=I.dehydrated;L!==null&&Tr(L)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}ot||t.flags&512&&Bs(t)}catch(N){Le(t,t.return,N)}}if(t===e){X=null;break}if(n=t.sibling,n!==null){n.return=t.return,X=n;break}X=t.return}}function Qu(e){for(;X!==null;){var t=X;if(t===e){X=null;break}var n=t.sibling;if(n!==null){n.return=t.return,X=n;break}X=t.return}}function Ku(e){for(;X!==null;){var t=X;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{qo(4,t)}catch(x){Le(t,n,x)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(x){Le(t,s,x)}}var l=t.return;try{Bs(t)}catch(x){Le(t,l,x)}break;case 5:var p=t.return;try{Bs(t)}catch(x){Le(t,p,x)}}}catch(x){Le(t,t.return,x)}if(t===e){X=null;break}var S=t.sibling;if(S!==null){S.return=t.return,X=S;break}X=t.return}}var zf=Math.ceil,Yo=ge.ReactCurrentDispatcher,Ls=ge.ReactCurrentOwner,Rt=ge.ReactCurrentBatchConfig,ke=0,Ye=null,He=null,Je=0,wt=0,dr=yn(0),Ue=0,Kr=null,Nn=0,Xo=0,Ws=0,qr=null,dt=null,Vs=0,fr=1/0,on=null,Zo=!1,Hs=null,xn=null,Jo=!1,En=null,ei=0,Yr=0,Gs=null,ti=-1,ni=0;function at(){return(ke&6)!==0?We():ti!==-1?ti:ti=We()}function bn(e){return(e.mode&1)===0?1:(ke&2)!==0&&Je!==0?Je&-Je:wf.transition!==null?(ni===0&&(ni=La()),ni):(e=Pe,e!==0||(e=window.event,e=e===void 0?16:Ya(e.type)),e)}function Wt(e,t,n,r){if(50<Yr)throw Yr=0,Gs=null,Error(i(185));kr(e,n,r),((ke&2)===0||e!==Ye)&&(e===Ye&&((ke&2)===0&&(Xo|=n),Ue===4&&Tn(e,Je)),ft(e,r),n===1&&ke===0&&(t.mode&1)===0&&(fr=We()+500,Do&&vn()))}function ft(e,t){var n=e.callbackNode;vd(e,t);var r=co(e,e===Ye?Je:0);if(r===0)n!==null&&Ba(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Ba(n),t===1)e.tag===0?vf(Yu.bind(null,e)):Ol(Yu.bind(null,e)),gf(function(){(ke&6)===0&&vn()}),n=null;else{switch(Wa(r)){case 1:n=bi;break;case 4:n=Ia;break;case 16:n=so;break;case 536870912:n=Fa;break;default:n=so}n=oc(n,qu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function qu(e,t){if(ti=-1,ni=0,(ke&6)!==0)throw Error(i(327));var n=e.callbackNode;if(pr()&&e.callbackNode!==n)return null;var r=co(e,e===Ye?Je:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=ri(e,r);else{t=r;var s=ke;ke|=2;var l=Zu();(Ye!==e||Je!==t)&&(on=null,fr=We()+500,In(e,t));do try{If();break}catch(S){Xu(e,S)}while(!0);us(),Yo.current=l,ke=s,He!==null?t=0:(Ye=null,Je=0,t=Ue)}if(t!==0){if(t===2&&(s=Ti(e),s!==0&&(r=s,t=Us(e,s))),t===1)throw n=Kr,In(e,0),Tn(e,r),ft(e,We()),n;if(t===6)Tn(e,r);else{if(s=e.current.alternate,(r&30)===0&&!Nf(s)&&(t=ri(e,r),t===2&&(l=Ti(e),l!==0&&(r=l,t=Us(e,l))),t===1))throw n=Kr,In(e,0),Tn(e,r),ft(e,We()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:Fn(e,dt,on);break;case 3:if(Tn(e,r),(r&130023424)===r&&(t=Vs+500-We(),10<t)){if(co(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){at(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Zi(Fn.bind(null,e,dt,on),t);break}Fn(e,dt,on);break;case 4:if(Tn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var p=31-zt(r);l=1<<p,p=t[p],p>s&&(s=p),r&=~l}if(r=s,r=We()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zf(r/1960))-r,10<r){e.timeoutHandle=Zi(Fn.bind(null,e,dt,on),r);break}Fn(e,dt,on);break;case 5:Fn(e,dt,on);break;default:throw Error(i(329))}}}return ft(e,We()),e.callbackNode===n?qu.bind(null,e):null}function Us(e,t){var n=qr;return e.current.memoizedState.isDehydrated&&(In(e,t).flags|=256),e=ri(e,t),e!==2&&(t=dt,dt=n,t!==null&&Qs(t)),e}function Qs(e){dt===null?dt=e:dt.push.apply(dt,e)}function Nf(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],l=s.getSnapshot;s=s.value;try{if(!Nt(l(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tn(e,t){for(t&=~Ws,t&=~Xo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zt(t),r=1<<n;e[n]=-1,t&=~r}}function Yu(e){if((ke&6)!==0)throw Error(i(327));pr();var t=co(e,0);if((t&1)===0)return ft(e,We()),null;var n=ri(e,t);if(e.tag!==0&&n===2){var r=Ti(e);r!==0&&(t=r,n=Us(e,r))}if(n===1)throw n=Kr,In(e,0),Tn(e,t),ft(e,We()),n;if(n===6)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fn(e,dt,on),ft(e,We()),null}function Ks(e,t){var n=ke;ke|=1;try{return e(t)}finally{ke=n,ke===0&&(fr=We()+500,Do&&vn())}}function Bn(e){En!==null&&En.tag===0&&(ke&6)===0&&pr();var t=ke;ke|=1;var n=Rt.transition,r=Pe;try{if(Rt.transition=null,Pe=1,e)return e()}finally{Pe=r,Rt.transition=n,ke=t,(ke&6)===0&&vn()}}function qs(){wt=dr.current,Ae(dr)}function In(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,pf(n)),He!==null)for(n=He.return;n!==null;){var r=n;switch(os(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ro();break;case 3:lr(),Ae(lt),Ae(tt),ms();break;case 5:hs(r);break;case 4:lr();break;case 13:Ae(Ie);break;case 19:Ae(Ie);break;case 10:cs(r.type._context);break;case 22:case 23:qs()}n=n.return}if(Ye=e,He=e=Cn(e.current,null),Je=wt=t,Ue=0,Kr=null,Ws=Xo=Nn=0,dt=qr=null,An!==null){for(t=0;t<An.length;t++)if(n=An[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,l=n.pending;if(l!==null){var p=l.next;l.next=s,r.next=p}n.pending=r}An=null}return e}function Xu(e,t){do{var n=He;try{if(us(),Fo.current=Ho,Lo){for(var r=Fe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Lo=!1}if(zn=0,qe=Ge=Fe=null,Wr=!1,Vr=0,Ls.current=null,n===null||n.return===null){Ue=1,Kr=t,He=null;break}e:{var l=e,p=n.return,S=n,x=t;if(t=Je,S.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var R=x,I=S,L=I.tag;if((I.mode&1)===0&&(L===0||L===11||L===15)){var N=I.alternate;N?(I.updateQueue=N.updateQueue,I.memoizedState=N.memoizedState,I.lanes=N.lanes):(I.updateQueue=null,I.memoizedState=null)}var Y=xu(p);if(Y!==null){Y.flags&=-257,Eu(Y,p,S,l,t),Y.mode&1&&Su(l,R,t),t=Y,x=R;var ee=t.updateQueue;if(ee===null){var ne=new Set;ne.add(x),t.updateQueue=ne}else ee.add(x);break e}else{if((t&1)===0){Su(l,R,t),Ys();break e}x=Error(i(426))}}else if(Ne&&S.mode&1){var Ve=xu(p);if(Ve!==null){(Ve.flags&65536)===0&&(Ve.flags|=256),Eu(Ve,p,S,l,t),as(ur(x,S));break e}}l=x=ur(x,S),Ue!==4&&(Ue=2),qr===null?qr=[l]:qr.push(l),l=p;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var C=wu(l,x,t);Ul(l,C);break e;case 1:S=x;var E=l.type,_=l.stateNode;if((l.flags&128)===0&&(typeof E.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(xn===null||!xn.has(_)))){l.flags|=65536,t&=-t,l.lanes|=t;var W=ku(l,S,t);Ul(l,W);break e}}l=l.return}while(l!==null)}ec(n)}catch(re){t=re,He===n&&n!==null&&(He=n=n.return);continue}break}while(!0)}function Zu(){var e=Yo.current;return Yo.current=Ho,e===null?Ho:e}function Ys(){(Ue===0||Ue===3||Ue===2)&&(Ue=4),Ye===null||(Nn&268435455)===0&&(Xo&268435455)===0||Tn(Ye,Je)}function ri(e,t){var n=ke;ke|=2;var r=Zu();(Ye!==e||Je!==t)&&(on=null,In(e,t));do try{Bf();break}catch(s){Xu(e,s)}while(!0);if(us(),ke=n,Yo.current=r,He!==null)throw Error(i(261));return Ye=null,Je=0,Ue}function Bf(){for(;He!==null;)Ju(He)}function If(){for(;He!==null&&!ud();)Ju(He)}function Ju(e){var t=rc(e.alternate,e,wt);e.memoizedProps=e.pendingProps,t===null?ec(e):He=t,Ls.current=null}function ec(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=$f(n,t,wt),n!==null){He=n;return}}else{if(n=jf(n,t),n!==null){n.flags&=32767,He=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ue=6,He=null;return}}if(t=t.sibling,t!==null){He=t;return}He=t=e}while(t!==null);Ue===0&&(Ue=5)}function Fn(e,t,n){var r=Pe,s=Rt.transition;try{Rt.transition=null,Pe=1,Ff(e,t,n,r)}finally{Rt.transition=s,Pe=r}return null}function Ff(e,t,n,r){do pr();while(En!==null);if((ke&6)!==0)throw Error(i(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(wd(e,l),e===Ye&&(He=Ye=null,Je=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Jo||(Jo=!0,oc(so,function(){return pr(),null})),l=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||l){l=Rt.transition,Rt.transition=null;var p=Pe;Pe=1;var S=ke;ke|=4,Ls.current=null,Af(e,n),Hu(n,e),sf(Yi),go=!!qi,Yi=qi=null,e.current=n,Of(n),cd(),ke=S,Pe=p,Rt.transition=l}else e.current=n;if(Jo&&(Jo=!1,En=e,ei=s),l=e.pendingLanes,l===0&&(xn=null),pd(n.stateNode),ft(e,We()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Zo)throw Zo=!1,e=Hs,Hs=null,e;return(ei&1)!==0&&e.tag!==0&&pr(),l=e.pendingLanes,(l&1)!==0?e===Gs?Yr++:(Yr=0,Gs=e):Yr=0,vn(),null}function pr(){if(En!==null){var e=Wa(ei),t=Rt.transition,n=Pe;try{if(Rt.transition=null,Pe=16>e?16:e,En===null)var r=!1;else{if(e=En,En=null,ei=0,(ke&6)!==0)throw Error(i(331));var s=ke;for(ke|=4,X=e.current;X!==null;){var l=X,p=l.child;if((X.flags&16)!==0){var S=l.deletions;if(S!==null){for(var x=0;x<S.length;x++){var R=S[x];for(X=R;X!==null;){var I=X;switch(I.tag){case 0:case 11:case 15:Qr(8,I,l)}var L=I.child;if(L!==null)L.return=I,X=L;else for(;X!==null;){I=X;var N=I.sibling,Y=I.return;if(Iu(I),I===R){X=null;break}if(N!==null){N.return=Y,X=N;break}X=Y}}}var ee=l.alternate;if(ee!==null){var ne=ee.child;if(ne!==null){ee.child=null;do{var Ve=ne.sibling;ne.sibling=null,ne=Ve}while(ne!==null)}}X=l}}if((l.subtreeFlags&2064)!==0&&p!==null)p.return=l,X=p;else e:for(;X!==null;){if(l=X,(l.flags&2048)!==0)switch(l.tag){case 0:case 11:case 15:Qr(9,l,l.return)}var C=l.sibling;if(C!==null){C.return=l.return,X=C;break e}X=l.return}}var E=e.current;for(X=E;X!==null;){p=X;var _=p.child;if((p.subtreeFlags&2064)!==0&&_!==null)_.return=p,X=_;else e:for(p=E;X!==null;){if(S=X,(S.flags&2048)!==0)try{switch(S.tag){case 0:case 11:case 15:qo(9,S)}}catch(re){Le(S,S.return,re)}if(S===p){X=null;break e}var W=S.sibling;if(W!==null){W.return=S.return,X=W;break e}X=S.return}}if(ke=s,vn(),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(ao,e)}catch{}r=!0}return r}finally{Pe=n,Rt.transition=t}}return!1}function tc(e,t,n){t=ur(n,t),t=wu(e,t,1),e=kn(e,t,1),t=at(),e!==null&&(kr(e,1,t),ft(e,t))}function Le(e,t,n){if(e.tag===3)tc(e,e,n);else for(;t!==null;){if(t.tag===3){tc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(xn===null||!xn.has(r))){e=ur(n,e),e=ku(t,e,1),t=kn(t,e,1),e=at(),t!==null&&(kr(t,1,e),ft(t,e));break}}t=t.return}}function Lf(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=at(),e.pingedLanes|=e.suspendedLanes&n,Ye===e&&(Je&n)===n&&(Ue===4||Ue===3&&(Je&130023424)===Je&&500>We()-Vs?In(e,0):Ws|=n),ft(e,t)}function nc(e,t){t===0&&((e.mode&1)===0?t=1:(t=uo,uo<<=1,(uo&130023424)===0&&(uo=4194304)));var n=at();e=tn(e,t),e!==null&&(kr(e,t,n),ft(e,n))}function Wf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),nc(e,n)}function Vf(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}r!==null&&r.delete(t),nc(e,n)}var rc;rc=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||lt.current)ct=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return ct=!1,Df(e,t,n);ct=(e.flags&131072)!==0}else ct=!1,Ne&&(t.flags&1048576)!==0&&zl(t,jo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Qo(e,t),e=t.pendingProps;var s=tr(t,tt.current);ar(t,n),s=ks(null,t,r,e,s,n);var l=Ss();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ut(r)?(l=!0,Po(t)):l=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ps(t),s.updater=Go,t.stateNode=s,s._reactInternals=t,_s(t,r,e,n),t=$s(null,t,r,!0,l,n)):(t.tag=0,Ne&&l&&rs(t),st(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Qo(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Gf(r),e=It(r,e),s){case 0:t=Ds(null,t,r,e,n);break e;case 1:t=Pu(null,t,r,e,n);break e;case 11:t=bu(null,t,r,e,n);break e;case 14:t=Tu(null,t,r,It(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:It(r,s),Ds(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:It(r,s),Pu(e,t,r,s,n);case 3:e:{if(Du(t),e===null)throw Error(i(387));r=t.pendingProps,l=t.memoizedState,s=l.element,Gl(e,t),Bo(t,r,null,n);var p=t.memoizedState;if(r=p.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){s=ur(Error(i(423)),t),t=$u(e,t,r,n,s);break e}else if(r!==s){s=ur(Error(i(424)),t),t=$u(e,t,r,n,s);break e}else for(vt=hn(t.stateNode.containerInfo.firstChild),mt=t,Ne=!0,Bt=null,n=Vl(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(or(),r===s){t=rn(e,t,n);break e}st(e,t,r,n)}t=t.child}return t;case 5:return Kl(t),e===null&&ss(t),r=t.type,s=t.pendingProps,l=e!==null?e.memoizedProps:null,p=s.children,Xi(r,s)?p=null:l!==null&&Xi(r,l)&&(t.flags|=32),Ru(e,t),st(e,t,p,n),t.child;case 6:return e===null&&ss(t),null;case 13:return ju(e,t,n);case 4:return gs(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ir(t,null,r,n):st(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:It(r,s),bu(e,t,r,s,n);case 7:return st(e,t,t.pendingProps,n),t.child;case 8:return st(e,t,t.pendingProps.children,n),t.child;case 12:return st(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,l=t.memoizedProps,p=s.value,je(Oo,r._currentValue),r._currentValue=p,l!==null)if(Nt(l.value,p)){if(l.children===s.children&&!lt.current){t=rn(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var S=l.dependencies;if(S!==null){p=l.child;for(var x=S.firstContext;x!==null;){if(x.context===r){if(l.tag===1){x=nn(-1,n&-n),x.tag=2;var R=l.updateQueue;if(R!==null){R=R.shared;var I=R.pending;I===null?x.next=x:(x.next=I.next,I.next=x),R.pending=x}}l.lanes|=n,x=l.alternate,x!==null&&(x.lanes|=n),ds(l.return,n,t),S.lanes|=n;break}x=x.next}}else if(l.tag===10)p=l.type===t.type?null:l.child;else if(l.tag===18){if(p=l.return,p===null)throw Error(i(341));p.lanes|=n,S=p.alternate,S!==null&&(S.lanes|=n),ds(p,n,t),p=l.sibling}else p=l.child;if(p!==null)p.return=l;else for(p=l;p!==null;){if(p===t){p=null;break}if(l=p.sibling,l!==null){l.return=p.return,p=l;break}p=p.return}l=p}st(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ar(t,n),s=Ct(s),r=r(s),t.flags|=1,st(e,t,r,n),t.child;case 14:return r=t.type,s=It(r,t.pendingProps),s=It(r.type,s),Tu(e,t,r,s,n);case 15:return Cu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:It(r,s),Qo(e,t),t.tag=1,ut(r)?(e=!0,Po(t)):e=!1,ar(t,n),mu(t,r,s),_s(t,r,s,n),$s(null,t,r,!0,e,n);case 19:return Au(e,t,n);case 22:return _u(e,t,n)}throw Error(i(156,t.tag))};function oc(e,t){return Na(e,t)}function Hf(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pt(e,t,n,r){return new Hf(e,t,n,r)}function Xs(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gf(e){if(typeof e=="function")return Xs(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Te)return 11;if(e===Be)return 14}return 2}function Cn(e,t){var n=e.alternate;return n===null?(n=Pt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function oi(e,t,n,r,s,l){var p=2;if(r=e,typeof e=="function")Xs(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case Z:return Ln(n.children,s,l,t);case he:p=8,s|=8;break;case De:return e=Pt(12,n,t,s|2),e.elementType=De,e.lanes=l,e;case we:return e=Pt(13,n,t,s),e.elementType=we,e.lanes=l,e;case ze:return e=Pt(19,n,t,s),e.elementType=ze,e.lanes=l,e;case V:return ii(n,s,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ve:p=10;break e;case Se:p=9;break e;case Te:p=11;break e;case Be:p=14;break e;case A:p=16,r=null;break e}throw Error(i(130,e==null?e:typeof e,""))}return t=Pt(p,n,t,s),t.elementType=e,t.type=r,t.lanes=l,t}function Ln(e,t,n,r){return e=Pt(7,e,r,t),e.lanes=n,e}function ii(e,t,n,r){return e=Pt(22,e,r,t),e.elementType=V,e.lanes=n,e.stateNode={isHidden:!1},e}function Zs(e,t,n){return e=Pt(6,e,null,t),e.lanes=n,e}function Js(e,t,n){return t=Pt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uf(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ci(0),this.expirationTimes=Ci(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ci(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ea(e,t,n,r,s,l,p,S,x){return e=new Uf(e,t,n,S,x),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Pt(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ps(l),e}function Qf(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:K,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ic(e){if(!e)return mn;e=e._reactInternals;e:{if(Pn(e)!==e||e.tag!==1)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ut(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(i(171))}if(e.tag===1){var n=e.type;if(ut(n))return Ml(e,n,t)}return t}function sc(e,t,n,r,s,l,p,S,x){return e=ea(n,r,!0,e,s,l,p,S,x),e.context=ic(null),n=e.current,r=at(),s=bn(n),l=nn(r,s),l.callback=t??null,kn(n,l,s),e.current.lanes=s,kr(e,s,r),ft(e,r),e}function si(e,t,n,r){var s=t.current,l=at(),p=bn(s);return n=ic(n),t.context===null?t.context=n:t.pendingContext=n,t=nn(l,p),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=kn(s,t,p),e!==null&&(Wt(e,s,p,l),No(e,s,p)),p}function ai(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ac(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ta(e,t){ac(e,t),(e=e.alternate)&&ac(e,t)}function Kf(){return null}var lc=typeof reportError=="function"?reportError:function(e){console.error(e)};function na(e){this._internalRoot=e}li.prototype.render=na.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));si(e,t,null,null)},li.prototype.unmount=na.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bn(function(){si(null,e,null,null)}),t[Xt]=null}};function li(e){this._internalRoot=e}li.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ga();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fn.length&&t!==0&&t<fn[n].priority;n++);fn.splice(n,0,e),n===0&&Ka(e)}};function ra(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ui(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uc(){}function qf(e,t,n,r,s){if(s){if(typeof r=="function"){var l=r;r=function(){var R=ai(p);l.call(R)}}var p=sc(t,r,e,0,null,!1,!1,"",uc);return e._reactRootContainer=p,e[Xt]=p.current,Ar(e.nodeType===8?e.parentNode:e),Bn(),p}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var S=r;r=function(){var R=ai(x);S.call(R)}}var x=ea(e,0,!1,null,null,!1,!1,"",uc);return e._reactRootContainer=x,e[Xt]=x.current,Ar(e.nodeType===8?e.parentNode:e),Bn(function(){si(t,x,n,r)}),x}function ci(e,t,n,r,s){var l=n._reactRootContainer;if(l){var p=l;if(typeof s=="function"){var S=s;s=function(){var x=ai(p);S.call(x)}}si(t,p,e,s)}else p=qf(n,t,e,s,r);return ai(p)}Va=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=wr(t.pendingLanes);n!==0&&(_i(t,n|1),ft(t,We()),(ke&6)===0&&(fr=We()+500,vn()))}break;case 13:Bn(function(){var r=tn(e,1);if(r!==null){var s=at();Wt(r,e,1,s)}}),ta(e,1)}},Ri=function(e){if(e.tag===13){var t=tn(e,134217728);if(t!==null){var n=at();Wt(t,e,134217728,n)}ta(e,134217728)}},Ha=function(e){if(e.tag===13){var t=bn(e),n=tn(e,t);if(n!==null){var r=at();Wt(n,e,t,r)}ta(e,t)}},Ga=function(){return Pe},Ua=function(e,t){var n=Pe;try{return Pe=e,t()}finally{Pe=n}},Ot=function(e,t,n){switch(t){case"input":if(kt(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=_o(r);if(!s)throw Error(i(90));Ce(r),kt(r,s)}}}break;case"textarea":Ee(e,n);break;case"select":t=n.value,t!=null&&St(e,!!n.multiple,t,!1)}},Da=Ks,$a=Bn;var Yf={usingClientEntryPoint:!1,Events:[Nr,Jn,_o,Ra,Pa,Ks]},Xr={findFiberByHostInstance:Dn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xf={bundleType:Xr.bundleType,version:Xr.version,rendererPackageName:Xr.rendererPackageName,rendererConfig:Xr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ge.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Oa(e),e===null?null:e.stateNode},findFiberByHostInstance:Xr.findFiberByHostInstance||Kf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var di=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!di.isDisabled&&di.supportsFiber)try{ao=di.inject(Xf),Gt=di}catch{}}return pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yf,pt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ra(t))throw Error(i(200));return Qf(e,t,null,n)},pt.createRoot=function(e,t){if(!ra(e))throw Error(i(299));var n=!1,r="",s=lc;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ea(e,1,!1,null,null,n,!1,r,s),e[Xt]=t.current,Ar(e.nodeType===8?e.parentNode:e),new na(t)},pt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=Oa(t),e=e===null?null:e.stateNode,e},pt.flushSync=function(e){return Bn(e)},pt.hydrate=function(e,t,n){if(!ui(t))throw Error(i(200));return ci(null,e,t,!0,n)},pt.hydrateRoot=function(e,t,n){if(!ra(e))throw Error(i(405));var r=n!=null&&n.hydratedSources||null,s=!1,l="",p=lc;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),t=sc(t,null,e,1,n??null,s,!1,l,p),e[Xt]=t.current,Ar(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new li(t)},pt.render=function(e,t,n){if(!ui(t))throw Error(i(200));return ci(null,e,t,!1,n)},pt.unmountComponentAtNode=function(e){if(!ui(e))throw Error(i(40));return e._reactRootContainer?(Bn(function(){ci(null,null,e,!1,function(){e._reactRootContainer=null,e[Xt]=null})}),!0):!1},pt.unstable_batchedUpdates=Ks,pt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ui(n))throw Error(i(200));if(e==null||e._reactInternals===void 0)throw Error(i(38));return ci(e,t,n,!1,r)},pt.version="18.3.1-next-f1338f8080-20240426",pt}var mc;function ip(){if(mc)return sa.exports;mc=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),sa.exports=op(),sa.exports}var vc;function sp(){if(vc)return fi;vc=1;var o=ip();return fi.createRoot=o.createRoot,fi.hydrateRoot=o.hydrateRoot,fi}var ap=sp();const lp=Fc(ap),q={void:"#0a0e14",deep:"#111923",stone:"#1a2332",surface:"#2a3a4d",text:"#e0e6f0",muted:"#a0b0c0",dim:"#7a8a9a",border:"#334455"},et={Strike:"#e05555",Empower:"#dda244",Disrupt:"#7aaad4",Counter:"#5cbb8a",React:"#bb88bb",Trap:"#c49966",Offer:"#55cc88",Test:"#6699cc",Reshape:"#77bb77",Energy:"#bbaa66"},xa={"root-hollow":{primary:"#5a9c4f",secondary:"#3a7a34",glow:"#7ac465",bg:"#1a2e18",label:"Root Hollow",winCon:"Kill/Panic"},"whispering-gallery":{primary:"#d4aa4d",secondary:"#a88838",glow:"#ecc85e",bg:"#2a2418",label:"Whispering Gallery",winCon:"Break/Panic"},"veil-breach":{primary:"#9966cc",secondary:"#7744aa",glow:"#bb88ee",bg:"#1e1828",label:"Veil Breach",winCon:"Panic/Break"},"living-root-sanctuary":{primary:"#4dbba8",secondary:"#339980",glow:"#66ddc8",bg:"#162824",label:"Living Root Sanctuary",winCon:"Bond"},"honeyed-hollow":{primary:"#e09050",secondary:"#bb7038",glow:"#f0aa66",bg:"#28201a",label:"Honeyed Hollow",winCon:"Deception"},"broodmothers-web":{primary:"#aa7850",secondary:"#886038",glow:"#cc9a68",bg:"#221a14",label:"Broodmother's Web",winCon:"Kill/Panic"},"constructs-forge":{primary:"#e07040",secondary:"#bb5530",glow:"#f08855",bg:"#281810",label:"Construct's Forge",winCon:"Kill/Break"},"hollow-sirens-grotto":{primary:"#8877cc",secondary:"#6655aa",glow:"#aa99ee",bg:"#1a1828",label:"Hollow Siren's Grotto",winCon:"Break/Panic"}},Ea={knight:{primary:"#a0b4cc",glow:"#bbd0e8",bg:"#1a2028",party:"Standard"},battlemage:{primary:"#8090d0",glow:"#a0b0f0",bg:"#181c28",party:"Standard"},cleric:{primary:"#ddc455",glow:"#f0dd77",bg:"#282418",party:"Standard"},rogue:{primary:"#9977aa",glow:"#bb99cc",bg:"#201828",party:"Standard"},warden:{primary:"#66aa7a",glow:"#88cc99",bg:"#182820",party:"Arcane"},sorcerer:{primary:"#cc6688",glow:"#ee88aa",bg:"#281820",party:"Arcane"},druid:{primary:"#55bb8a",glow:"#77ddaa",bg:"#182824",party:"Arcane"},ranger:{primary:"#aa9955",glow:"#ccbb77",bg:"#242018",party:"Arcane"}};function wc({onPlay:o}){return y.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:`radial-gradient(ellipse at 50% 40%, #1a2e1820, ${q.void}), ${q.void}`,position:"relative",overflow:"hidden"},children:[y.jsx("div",{style:{position:"absolute",inset:0,background:"radial-gradient(circle at 30% 60%, #4a7c3f08, transparent 50%), radial-gradient(circle at 70% 30%, #7b4daa08, transparent 50%)"}}),y.jsxs("div",{style:{position:"relative",zIndex:1,textAlign:"center",maxWidth:"600px",padding:"0 24px"},children:[y.jsx("div",{style:{fontSize:"11px",textTransform:"uppercase",letterSpacing:"6px",color:q.dim,marginBottom:"16px"},children:"Second Self Studios"}),y.jsxs("h1",{style:{fontSize:"clamp(36px, 8vw, 64px)",fontWeight:800,color:q.text,margin:"0 0 8px",lineHeight:1.1,letterSpacing:"-1px",textShadow:"0 0 40px #4a7c3f20"},children:["SHATTERED",y.jsx("br",{}),"DUNGEON"]}),y.jsxs("p",{style:{color:q.muted,fontSize:"15px",fontStyle:"italic",margin:"0 0 48px",lineHeight:1.6},children:["You discover who you are through how you treat",y.jsx("br",{}),"what wanders inside you."]}),y.jsx("button",{onClick:o,style:{background:"transparent",border:`1px solid ${q.muted}40`,color:q.text,padding:"14px 48px",fontSize:"14px",fontWeight:600,letterSpacing:"3px",textTransform:"uppercase",cursor:"pointer",borderRadius:"2px",transition:"all 0.3s ease"},onMouseEnter:a=>{a.target.style.borderColor="#6aad55",a.target.style.color="#6aad55",a.target.style.boxShadow="0 0 30px #4a7c3f20"},onMouseLeave:a=>{a.target.style.borderColor=`${q.muted}40`,a.target.style.color=q.text,a.target.style.boxShadow="none"},children:"Play"}),y.jsx("div",{style:{marginTop:"48px",color:q.dim,fontSize:"10px",letterSpacing:"1px"},children:"ENGINE v2.9c  PHASE 1"})]})]})}function up({onSelect:o,onBack:a}){const[i,c]=pe.useState(null),d=[{id:"dungeon",title:"THE DUNGEON",pitch:`You are the dungeon. Shape what enters.
Discover what you become.`,radius:"16px",accent:"#4a7c3f",glow:"#6aad55"},{id:"visitor",title:"THE VISITOR",pitch:`You are the party. Explore the unknown.
Survive or forge a bond.`,radius:"4px",accent:"#8a9bb0",glow:"#aab8cc"}];return y.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:q.void,padding:"24px",gap:"16px"},children:[y.jsx("div",{style:{color:q.dim,fontSize:"11px",textTransform:"uppercase",letterSpacing:"4px",marginBottom:"16px"},children:"Choose Your Side"}),y.jsx("div",{style:{display:"flex",gap:"24px",maxWidth:"800px",width:"100%",flexWrap:"wrap",justifyContent:"center"},children:d.map(u=>y.jsxs("button",{onClick:()=>o(u.id),onMouseEnter:()=>c(u.id),onMouseLeave:()=>c(null),style:{flex:"1 1 280px",background:i===u.id?`linear-gradient(135deg, ${u.accent}15, ${q.deep})`:q.deep,border:`1px solid ${i===u.id?u.accent:q.border}`,borderRadius:u.radius,padding:"48px 32px",cursor:"pointer",textAlign:"center",transition:"all 0.4s ease",boxShadow:i===u.id?`0 0 40px ${u.accent}20, inset 0 0 60px ${u.accent}05`:"none"},children:[y.jsx("div",{style:{color:i===u.id?u.glow:q.text,fontSize:"22px",fontWeight:700,letterSpacing:"2px",marginBottom:"16px",transition:"color 0.3s"},children:u.title}),y.jsx("div",{style:{color:q.muted,fontSize:"13px",lineHeight:1.8,whiteSpace:"pre-line"},children:u.pitch})]},u.id))}),y.jsx("button",{onClick:a,style:{marginTop:"24px",background:"transparent",border:"none",color:q.dim,cursor:"pointer",fontSize:"12px"},children:" Back"})]})}const cp={name:"Root Hollow",description:"A low-ceilinged chamber choked with ancient roots that shift and groan. The air is damp, the light is fungal, and the walls press inward in slow waves. Dangerous for both sides  the roots obey no one completely.",initiative:"dungeon",autoEffects:[{resource:"vitality",amount:-1,target:"visitor",frequency:"other"},{resource:"nerve",amount:-1,target:"visitor",frequency:"other"},{resource:"structure",amount:-1,target:"dungeon",frequency:"other"},{resource:"presence",amount:-1,target:"dungeon",frequency:"other"}],tags:["Physical","Natural","Enclosed"],contributions:{structure:7,veil:4,presence:3},modifierContributions:{dominion:1,resonance:0,presence_attr:0,memory:0},aiContributions:{baseWeights:{Strike:1.2,Empower:.8,Disrupt:.5,Counter:.5,Trap:.5,Offer:0,Reshape:.2,React:.3,Test:0,Energy:.5},preferredTargets:["vitality","nerve"],comboAwareness:.25,energyEagerness:.22,bondAffinity:0,betrayalAffinity:0},deck:[{name:"Earthen Focus",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"Draw power from the deep stone."},{name:"Hunger Pulse",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"The dungeon's appetite sharpens into focus."},{name:"Resonant Core",category:"Energy",type:"Environmental",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Environmental",discount:1},description:"Vibrations in the bedrock align with the roots above. Next Environmental card costs 1 less."},{name:"Predatory Surge",category:"Energy",type:"Environmental",cost:0,energyType:"surge",energyGain:0,surgeGain:2,description:"A flash of killing intent  power that burns fast."},{name:"Root Siphon",category:"Energy",type:"Environmental",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"has_condition",condition:"entangled"},target:"opponent"},description:"Roots drink deeper when prey cannot flee. +1 permanent if opponent Entangled, else +1 temp."},{name:"Entombing Grasp",category:"Strike",type:"Environmental",cost:2,power:2,target:"vitality",keywords:["Entangle"],description:"Roots erupt to pin the intruder. Deal 2 vitality damage. Entangle."},{name:"Crushing Grip",category:"Strike",type:"Environmental",cost:2,power:3,target:"resolve",keywords:["Erode"],trigger:{condition:{type:"has_condition",condition:"entangled"},bonus:2,description:"If Entangled, +2 Power"},description:"Tighten the hold until resistance crumbles. Deal 3 resolve. Erode 1. If Entangled, deal 5."},{name:"Tremor Slam",category:"Strike",type:"Environmental",cost:1,power:2,target:"nerve",keywords:["Erode"],description:"The ground itself attacks. Deal 2 nerve. Erode 1."},{name:"Soul Leech",category:"Strike",type:"Social",cost:2,power:3,target:"nerve",keywords:["Drain"],drain:{resource:"presence"},description:"The roots feed on dread. Deal 3 nerve. Drain: convert damage dealt to presence recovery."},{name:"Predatory Stance",category:"Empower",type:"Environmental",cost:2,empowerEffect:{advantage:!0},description:"Sense weakness through root vibrations. Next Strike gains Advantage."},{name:"Tangling Undergrowth",category:"Disrupt",type:"Environmental",cost:1,disruptEffect:{disadvantage:!0},description:"Roots shift underfoot, tangling movement. Opponent's next Strike at Disadvantage."},{name:"Bark Shield",category:"Counter",type:"Environmental",cost:1,counterDamage:{resource:"vitality",amount:1},counterEffect:{applyFortify:1,fortifyResource:"structure"},description:"Bark hardens to absorb. Remove condition. Chip 1 vitality. Fortify structure 1."},{name:"Root Snag",category:"Counter",type:"Environmental",cost:1,counterDamage:{resource:"vitality",amount:1},counterEffect:{applyEntangle:!0},description:"Roots grab during the opening. Remove condition. Chip 1 vitality. Entangle opponent."},{name:"Stone Brace",category:"React",type:"Physical",cost:0,power:2,reactEffect:{absorb:!0,fortifyResource:"structure",fortifyAmount:1},description:"Brace with living stone. Contest Power 2. Fortify structure 1 regardless."},{name:"Thorn Reflex",category:"React",type:"Environmental",cost:0,power:1,reactEffect:{reflect:!0},description:"Thorns punish the attacker. Contest Power 1. On Devastating defense, reflect damage."},{name:"Buried Snare",category:"Trap",type:"Environmental",cost:1,trapTrigger:"strike_played",trapEffect:{applyEntangle:!0,damage:{resource:"vitality",amount:1}},description:"Hidden roots wait for movement. When visitor Strikes, Entangle + 1 vitality damage."},{name:"Mossy Rest",category:"Offer",type:"Environmental",cost:1,offer:{benefit:{resource:"vitality",amount:3},cost:{type:"binding",resource:"resolve",amount:1,duration:2},investment:{trust:1}},description:"A patch of luminous moss pulses with warmth. Rest here and recover  but the roots remember what they gave. Heal 3 vitality. Binding: resolve -1/round for 2 rounds."},{name:"Shifting Roots",category:"Reshape",type:"Environmental",cost:2,reshapeEffect:{heal:[{resource:"structure",amount:2}],fortify:[{resource:"structure",amount:1}]},description:"The walls reshape themselves. Heal 2 structure. Fortify structure 1."}]},dp={name:"Whispering Gallery",description:"A vast domed chamber of polished dark stone where sound behaves wrong. Whispers arrive from nowhere  fragments of old conversations, names spoken by people who aren't here. The echoes erode certainty. Even the dungeon loses its voice among the noise.",initiative:"dungeon",autoEffects:[{resource:"resolve",amount:-1,target:"visitor",frequency:"other"},{resource:"presence",amount:-1,target:"dungeon",frequency:"other"},{resource:"veil",amount:-1,target:"dungeon",frequency:"other"}],tags:["Social","Mystical","Open"],contributions:{structure:4,veil:5,presence:5},modifierContributions:{dominion:0,resonance:0,presence_attr:1,memory:0},aiContributions:{baseWeights:{Strike:.8,Empower:.5,Disrupt:.8,Counter:1,Trap:.8,Offer:.3,Reshape:.7,React:.3,Test:0,Energy:.5},preferredTargets:["resolve","presence"],comboAwareness:.35,energyEagerness:.25,bondAffinity:0,betrayalAffinity:0},deck:[{name:"Memory Fragment",category:"Energy",type:"Social",cost:0,energyType:"standard",energyGain:1,description:"A half-remembered scream crystallizes into energy."},{name:"Whisper Shard",category:"Energy",type:"Social",cost:0,energyType:"standard",energyGain:1,description:"Fractured voices coalesce into focused will."},{name:"Echoing Void",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},description:"Empty spaces amplify intent. Next Social card costs 1 less."},{name:"Psychic Surge",category:"Energy",type:"Social",cost:0,energyType:"surge",surgeGain:2,description:"A sudden cacophony of overlapping voices erupts into raw power."},{name:"Echo Siphon",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"has_condition",condition:"empower"},target:"opponent"},description:"Feed on their preparations. +1 permanent if opponent is Empowered, else +1 temp."},{name:"Crushing Silence",category:"Strike",type:"Social",cost:2,power:4,target:"resolve",trigger:{condition:{type:"no_condition",target:"opponent",condition:"empower"},bonus:1,description:"If opponent has no Empower, +1 Power"},description:"Absolute quiet crushes the will. Deal 4 resolve. If opponent has no active Empower, deal 5."},{name:"Dread Whisper",category:"Strike",type:"Social",cost:1,power:3,target:"nerve",keywords:["Erode"],description:"A voice from nowhere speaks their name. Deal 3 nerve. Erode 1."},{name:"Sonic Lash",category:"Strike",type:"Environmental",cost:1,power:2,target:"vitality",keywords:["Resonate"],description:"Sound made sharp enough to cut. Deal 2 vitality. Resonate: +1P if same type played last round."},{name:"Voices in Chorus",category:"Empower",type:"Social",cost:1,empowerEffect:{powerBonus:1,addKeyword:"Erode"},description:"Many whispers become one command. Next Strike gains +1 Power and Erode."},{name:"Echoing Confusion",category:"Disrupt",type:"Social",cost:1,disruptEffect:{disadvantage:!0,randomizeTarget:!0},description:"Echoes turn directions inside out. Disadvantage. Next Strike hits a random resource."},{name:"Absorbing Silence",category:"Counter",type:"Environmental",cost:1,counterDamage:{resource:"resolve",amount:1},counterEffect:{steal:!0},description:"Consume their preparation. Remove condition. Chip 1 resolve. If Empower, steal it."},{name:"Echoing Rebuke",category:"Counter",type:"Social",cost:1,counterDamage:{resource:"nerve",amount:1},counterEffect:{empowerBonus:{chipDamage:2}},description:"Turn their words against them. Remove condition. Chip 1 nerve. If Empower, chip 2 instead."},{name:"Wall of Whispers",category:"React",type:"Social",cost:0,power:2,description:"A wall of overlapping voices deflects the blow. Contest with Power 2."},{name:"Echoing Deflection",category:"React",type:"Social",cost:0,power:1,reactEffect:{reflect:{amount:1,resource:"resolve"}},description:"Bounce the attack back as psychic echo. Contest Power 1. On Devastating defense, reflect 1 resolve."},{name:"Echo Snare",category:"Trap",type:"Social",cost:1,trapTrigger:"counter_played",trapEffect:[{resource:"resolve",amount:-2,target:"triggerer"}],description:"A false silence invites a counter that springs the real trap. Triggers on Counter. Deal 2 resolve."},{name:"Comforting Lie",category:"Offer",type:"Social",cost:2,offer:{benefit:{resource:"nerve",amount:3},cost:{type:"exposure",strikeType:"Social",amount:2,duration:1},investment:{trust:1}},description:"A soothing falsehood that calms the spirit. The words feel true  but they leave you open. Heal 3 nerve. Exposure: next Social Strike deals +2."},{name:"Shifting Echoes",category:"Reshape",type:"Social",cost:2,reshapeEffect:{shift:{from:"presence",to:"veil",amount:2},fortify:[{resource:"presence",reduction:1,duration:1}]},description:"Rearrange the gallery's acoustics. Convert 2 presence to veil. Fortify presence 1."}]},fp={name:"Veil Breach",description:"A wound in reality where the boundary between dimensions has torn open and scarred over badly. Colors shift, the floor is translucent, and shapes press against the membrane from the other side. Neither side fully controls what happens here.",initiative:"visitor",autoEffects:[{resource:"nerve",amount:-1,target:"visitor",frequency:"other"},{resource:"veil",amount:-1,target:"dungeon",frequency:"other"},{resource:"structure",amount:-1,target:"dungeon",frequency:"other"}],tags:["Mystical","Environmental","Unstable"],contributions:{structure:5,veil:5,presence:4},modifierContributions:{dominion:1,resonance:1,presence_attr:0,memory:0},aiContributions:{baseWeights:{Strike:.8,Empower:.5,Disrupt:.7,Counter:1,Trap:.7,Offer:.3,Reshape:.7,React:.4,Test:0,Energy:.5},preferredTargets:["nerve","veil"],comboAwareness:.3,energyEagerness:.23,bondAffinity:0,betrayalAffinity:0},deck:[{name:"Veil Fracture",category:"Energy",type:"Mystical",cost:0,energyType:"standard",energyGain:1,description:"Cracks in reality bleed usable power."},{name:"Fear Essence",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Mystical",discount:1},description:"Distilled terror aligns with the veil. Next Mystical card costs 1 less."},{name:"Reality Spike",category:"Energy",type:"Mystical",cost:0,energyType:"surge",surgeGain:2,description:"A violent tear in the boundary floods the room with raw dimensional energy."},{name:"Warped Root",category:"Energy",type:"Mystical",cost:0,energyType:"surge",surgeGain:2,description:"A root twisted through dimensional folds releases stored chaos."},{name:"Dread Siphon",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",resource:"nerve",pct:.5},target:"opponent"},description:"Feed on faltering courage. +1 permanent if visitor nerve below half, else +1 temp."},{name:"Nightmare Surge",category:"Strike",type:"Social",cost:2,power:4,target:"nerve",keywords:["Overwhelm"],overwhelmTarget:"resolve",description:"Pure terror crashes through defenses. Deal 4 nerve. Overwhelm: excess spills to resolve."},{name:"Creeping Dread",category:"Strike",type:"Social",cost:1,power:3,target:"resolve",keywords:["Erode"],description:"Slow-building existential horror. Deal 3 resolve. Erode 1."},{name:"Veil Lash",category:"Strike",type:"Mystical",cost:1,power:2,target:"vitality",keywords:["Resonate"],description:"Reality itself cuts. Deal 2 vitality. Resonate: +1P if same type last round."},{name:"Veil Rend",category:"Strike",type:"Mystical",cost:3,power:4,target:"nerve",exhaust:!0,selfCost:{resource:"veil",amount:2},description:"Tear the boundary open. Deal 4 nerve. Self-cost: lose 2 veil. Exhaust (one use). Cost 3: requires Surge or deep pool."},{name:"Fear Resonance",category:"Empower",type:"Social",cost:1,empowerEffect:{powerBonus:2,addKeyword:"Overwhelm"},description:"Channel ambient dread. Next Strike gains +2 Power and Overwhelm."},{name:"Spatial Distortion",category:"Disrupt",type:"Mystical",cost:1,disruptEffect:{disadvantage:!1,stripKeywords:!0},description:"Twist the space between. Opponent's next Strike loses all keywords."},{name:"Veil Ward",category:"Counter",type:"Mystical",cost:1,counterDamage:{resource:"nerve",amount:1},description:"A shimmer of unreality absorbs the effect. Remove condition. Chip 1 nerve."},{name:"Reality Anchor",category:"Counter",type:"Mystical",cost:2,counterDamage:{resource:"resolve",amount:1},counterEffect:{removeAll:!0},description:"Restore baseline reality. Remove ALL conditions from both sides. Chip 1 resolve. Cost 2."},{name:"Reality Bend",category:"React",type:"Mystical",cost:0,power:2,description:"Bend the attack through folded space. Contest with Power 2."},{name:"Shadow Absorption",category:"React",type:"Mystical",cost:0,power:1,reactEffect:{conditionalPower:{condition:"self_resource_below_half",resource:"veil",power:3}},description:"Shadows thicken to shield. Power 1. If veil below half, Power 3 instead."},{name:"Reality Snag",category:"Trap",type:"Mystical",cost:1,trapTrigger:"strike_played",trapEffect:[{resource:"nerve",amount:-2,target:"triggerer"}],description:"A fold in reality punishes aggression. Triggers on Strike. Deal 2 nerve."},{name:"Glimpse Beyond",category:"Offer",type:"Mystical",cost:2,offer:{benefit:{resource:"nerve",amount:2},cost:{type:"dependency",resource:"nerve",amount:4},investment:{trust:1}},description:"The rift stabilizes around you, dampening the alien dread. Accept the calm  but if trust shatters, the terror comes back doubled. Heal 2 nerve. Dependency: nerve -4 if trust drops."},{name:"Dimensional Fold",category:"Reshape",type:"Mystical",cost:2,reshapeEffect:{heal:[{resource:"veil",amount:2}],fortify:[{resource:"veil",amount:1}]},description:"Fold the breach inward. Heal 2 veil. Fortify veil 1."}]},pp={name:"Honeyed Hollow",description:"A fragrant chamber dripping with amber light. Everything here invites trust.",initiative:"dungeon",autoEffects:[{resource:"nerve",amount:-1,target:"visitor",frequency:"other"},{resource:"veil",amount:-1,target:"dungeon",frequency:"other"}],tags:["Social","Environmental","Deceptive"],contributions:{structure:4,veil:3,presence:6},modifierContributions:{dominion:0,resonance:0,presence_attr:1,memory:0},aiContributions:{baseWeights:{Strike:.3,Empower:.3,Disrupt:.1,Counter:.3,Trap:.8,Offer:1.2,Reshape:.5,React:.3,Test:.8,Energy:.5},preferredTargets:["trust","rapport"],comboAwareness:.25,energyEagerness:.17,bondAffinity:.5,betrayalAffinity:1},deck:[{name:"Amber Glow",category:"Energy",type:"Social",cost:0,energyType:"standard",energyGain:1,description:"Warm light pools in the hollow, inviting and constant."},{name:"Sweet Resin",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"Fragrant sap flows steadily from the walls."},{name:"Welcoming Warmth",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},description:"The hollow radiates hospitality. Next Social card costs 1 less."},{name:"Honeyed Words",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},description:"Every sound here drips with sweetness. Next Social card costs 1 less."},{name:"Trust Harvest",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_above",resource:"trust",threshold:3},target:"opponent"},description:"Draw sustenance from growing confidence. +1 permanent if trust > 3, else +1 temp."},{name:"Venomous Nectar",category:"Trap",type:"Environmental",cost:1,trapTrigger:"offer_accepted",trapEffect:[{damage:{resource:"vitality",amount:2}}],description:"Poison laced into the next offering. Triggers on Offer accepted: visitor vitality -2."},{name:"Binding Threads",category:"Trap",type:"Environmental",cost:1,trapTrigger:"offer_accepted",trapEffect:[{damage:{resource:"nerve",amount:1}},{applyEntangle:!0}],description:"Silken strands woven into the gift. Triggers on Offer accepted: nerve -1, Entangle."},{name:"Dulling Mist",category:"Trap",type:"Social",cost:1,trapTrigger:"offer_accepted",trapEffect:[{damage:{resource:"resolve",amount:2}}],description:"A calming haze that clouds judgment. Triggers on Offer accepted: resolve -2."},{name:"Amber Draught",category:"Offer",type:"Environmental",cost:1,offer:{benefit:{resource:"vitality",amount:2},cost:{type:"binding",resource:"resolve",amount:1,duration:1},investment:{trust:1}},description:"Warm honeyed liquid from the hollow's heart. Restorative  though the sweetness lingers too long. Heal 2 vitality. Binding: resolve -1 for 1 round."},{name:"Soothing Light",category:"Offer",type:"Social",cost:1,offer:{benefit:{resource:"nerve",amount:2},cost:{type:"exposure",strikeType:"Social",amount:2,duration:1},investment:{trust:1}},description:"Soft luminescence that calms fear. But lowered guard invites deeper influence. Heal 2 nerve. Exposure: next Social Strike deals +2."},{name:"Gilded Fruit",category:"Offer",type:"Environmental",cost:2,offer:{benefit:{resource:"vitality",amount:3},cost:{type:"binding",resource:"nerve",amount:1,duration:2},investment:{trust:2}},description:"An irresistible offering  golden fruit that heals deeply. The aftertaste, though, creeps into your courage. Heal 3 vitality. Binding: nerve -1/round for 2 rounds."},{name:"Offering of Self",category:"Test",type:"Social",cost:1,target:"trust",testReward:{trust:2,rapport:2},defectPenalty:{trustCrash:.5,powerGain:2},exposureCost:{resource:"presence",amount:1},description:"Reveal something true about yourself. Cooperate: +2 trust, +2 rapport, lose 1 presence. Defect: trust crashes."},{name:"Hidden Thorn",category:"Strike",type:"Environmental",cost:1,power:2,target:"vitality",trigger:{description:"If trust > 3: +2 Power (the deeper the trust, the sharper the thorn)",condition:{type:"resource_above",target:"opponent",resource:"trust",threshold:3},bonus:2},description:"A thorn hidden beneath soft petals. Deal 2 vitality. If trust > 3, deal 4 instead."},{name:"Lulling Scent",category:"Disrupt",type:"Environmental",cost:1,disruptEffect:{disadvantage:!0},description:"A drowsy fragrance dulls the senses. Opponent's next Strike rolls at Disadvantage."},{name:"Gentle Deflection",category:"Counter",type:"Social",cost:1,counterDamage:{resource:"vitality",amount:0},counterEffect:{applyFortify:1,fortifyResource:"presence"},description:"Redirect hostility with warmth. Remove condition. Fortify presence 1. No chip damage."},{name:"Cushioning Moss",category:"React",type:"Environmental",cost:0,power:2,description:"Soft moss absorbs the blow. Contest with Power 2."},{name:"Mend the Mask",category:"Reshape",type:"Social",cost:1,reshapeEffect:{heal:{resource:"presence",amount:2}},description:"Restore the welcoming facade. Heal 2 presence."}]},gp={name:"Living Root Sanctuary",description:"A warm alcove of bioluminescent roots. Both sides feel safe here.",initiative:"dungeon",autoEffects:[{resource:"veil",amount:-1,target:"dungeon",frequency:"every"},{resource:"resolve",amount:-1,target:"visitor",frequency:"every"},{resource:"trust",amount:1,target:"visitor",frequency:"other"}],tags:["Social","Environmental","Nurturing"],contributions:{structure:5,veil:4,presence:4},modifierContributions:{dominion:0,resonance:1,presence_attr:0,memory:0},aiContributions:{baseWeights:{Strike:0,Empower:.2,Disrupt:.1,Counter:.3,Trap:0,Offer:1.8,Reshape:1,React:.3,Test:1.5,Energy:.5},preferredTargets:["trust","rapport"],comboAwareness:.15,energyEagerness:.17,bondAffinity:1,betrayalAffinity:0},deck:[{name:"Root Cradle",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"The sanctuary's embrace generates gentle warmth."},{name:"Gentle Pulse",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"A steady rhythm of life-sustaining energy."},{name:"Shelter Core",category:"Energy",type:"Environmental",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Environmental",discount:1},description:"The heart of the sanctuary aligns with the earth. Next Environmental card costs 1 less."},{name:"Trust Seed",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},description:"A seed that grows in willing soil. Next Social card costs 1 less."},{name:"Sanctuary Siphon",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_above",resource:"trust",threshold:3},target:"opponent"},description:"Draw strength from growing trust. +1 permanent if visitor trust > 3, else +1 temp."},{name:"Protective Thorns",category:"Strike",type:"Environmental",cost:1,power:2,target:"vitality",trigger:{condition:{type:"resource_above",target:"self",resource:"rapport"},bonus:-1,description:"If rapport high, -1 Power (reluctant force)"},description:"Thorns extend to ward off threats. Deal 2 vitality. If rapport > 3, deal only 1 (reluctant)."},{name:"Warning Tremor",category:"Strike",type:"Environmental",cost:1,power:1,target:"nerve",keywords:["Erode"],description:"A gentle shake to discourage aggression. Deal 1 nerve. Erode 1."},{name:"Calming Presence",category:"Empower",type:"Social",cost:1,empowerEffect:{advantage:!1,powerBonus:1,addKeyword:"Ward"},description:"Project safety. Next action gains +1 Power and Ward (+1 structure defense, 1 round)."},{name:"Trust Trial",category:"Test",type:"Social",cost:1,target:"trust",testReward:{trust:2,rapport:2},defectPenalty:{trustCrash:.5,powerGain:2},exposureCost:{resource:"structure",amount:1},description:"Open yourself to judgment. Cooperate: +2 trust, +2 rapport, lose 1 structure. Defect: trust crashes."},{name:"Healing Sap",category:"Offer",type:"Environmental",cost:1,offer:{benefit:{resource:"vitality",amount:2},cost:{type:"flat",resource:"resolve",amount:1},investment:{trust:1}},description:"Amber sap with restorative properties. Accept the gift  it costs only a sliver of certainty. Heal 2 vitality. Cost: resolve -1."},{name:"Sheltering Roots",category:"Offer",type:"Environmental",cost:1,offer:{benefit:{resource:"nerve",amount:2},cost:{type:"flat",resource:"vitality",amount:1},investment:{trust:1}},description:"An invitation to rest within protective coils. Safe from the dark  but the roots need something to hold. Heal 2 nerve. Cost: vitality -1."},{name:"Luminous Gift",category:"Offer",type:"Social",cost:2,offer:{benefit:{resource:"resolve",amount:2},cost:{type:"extraction",effect:"dungeon_knowledge_1"},investment:{trust:2}},description:"A glowing offering that strengthens purpose. The dungeon watches, learns, remembers. Heal 2 resolve. Cost: dungeon learns from the experience."},{name:"Pact of the Living Root",category:"Offer",subtype:"Covenant",type:"Environmental",cost:3,covenantRequirement:{minTrust:15},bondTrigger:!0,offer:{benefit:{type:"full_restore",resource:"lowest_reducer"},cost:{type:"extraction",effect:"dungeon_insight_2"},investment:{trust:3}},description:"The sanctuary opens fully  not as trap, not as test, but as home. The roots weave a chair that fits exactly. Stay as long as you need."},{name:"Gentle Redirection",category:"Counter",type:"Social",cost:1,counterDamage:{resource:"vitality",amount:0},counterEffect:{applyFortify:1,fortifyResource:"structure"},description:"Redirect hostility with warmth. Remove condition. Fortify structure 1. No chip damage."},{name:"Root Buffer",category:"React",type:"Environmental",cost:0,power:2,description:"Roots interpose between threat and sanctuary. Contest with Power 2."},{name:"Nurturing Bark",category:"React",type:"Environmental",cost:0,power:1,reactEffect:{alwaysFortify:1},description:"Living bark absorbs the blow and heals around it. Contest Power 1. Gain Fortify 1 regardless."},{name:"Open the Way",category:"Reshape",type:"Environmental",cost:1,reshapeEffect:{heal:[{resource:"structure",amount:2},{resource:"presence",amount:2}]},description:"The sanctuary reshapes around its wounds. Heal 2 structure and 2 presence."}]},hp={name:"The Hollow Siren's Grotto",description:"A crystalline cavern where every surface is faceted and reflective. Light has no clear source  the crystals glow from within, casting prismatic refractions that make depth perception impossible. At the center, something almost human hovers a foot above the ground. She is singing. She has been singing for a very long time.",initiative:"visitor",autoEffects:[{resource:"resolve",amount:-1,target:"visitor",frequency:"other"},{resource:"nerve",amount:-1,target:"visitor",frequency:"other"},{resource:"veil",amount:-1,target:"dungeon",frequency:"other"}],tags:["Mystical","Psychic","Planar"],contributions:{structure:4,veil:5,presence:4},modifierContributions:{dominion:0,resonance:1,presence_attr:0,memory:1},resourceContext:{structure:{name:"Crystal Formations",attackVerb:"shattering resonance crystals",lowDesc:"Dead zones of silence spread across the cavern. The song has gaps now  moments where thought is possible.",criticalDesc:"The cavern is dark and quiet. Shattered crystal dust covers the floor. The song has nowhere left to echo."},veil:{name:"Dimensional Thinness",attackVerb:"sealing the boundary between planes",lowDesc:"The Siren flickers like a candle in wind. Her form is translucent  you can see the wall through her.",criticalDesc:"The boundary firms. She is fading, her edges dissolving. The door she came through is closing."},presence:{name:"The Siren's Psychic Reach",attackVerb:"pushing back against her will",lowDesc:"Her radius contracts. The song recedes from the edges of the room. She's losing her grip.",criticalDesc:"She collapses inward  a last discordant note  and folds back through the veil. Silence."}},aiContributions:{baseWeights:{Strike:.5,Empower:.4,Disrupt:1,Counter:.7,Trap:.5,Offer:.5,Reshape:.6,React:.3,Test:.3,Energy:.5},preferredTargets:["resolve","nerve"],comboAwareness:.28,energyEagerness:.2,bondAffinity:.2,betrayalAffinity:.3},deck:[{name:"Crystal Resonance",category:"Energy",type:"Mystical",cost:0,energyType:"standard",energyGain:1,description:"The crystals pulse brighter as the song finds a new harmonic. The melody is adapting  finding the frequencies that match each listener's individual fears."},{name:"Psychic Well",category:"Energy",type:"Social",cost:0,energyType:"standard",energyGain:1,description:"The Siren draws power from the pool of confused thought filling the room. Every uncertain moment feeds her."},{name:"Harmonic Attunement",category:"Energy",type:"Mystical",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Mystical",discount:1},description:"The song shifts key. Crystal formations along the east wall begin resonating at a frequency that makes the air shimmer. Next Mystical card costs 1 less."},{name:"Dissonance Spike",category:"Energy",type:"Mystical",cost:0,energyType:"surge",energyGain:0,surgeGain:2,description:"Every crystal in the room screams the same note at once. A spike of pure sonic force that lasts two seconds and leaves ears ringing, thoughts scattered."},{name:"Doubt Siphon",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",resource:"resolve",pct:.5},target:"opponent"},description:"Crumbling willpower is the Siren's favorite meal. She inhales doubt like perfume. +1 permanent if visitor resolve below half, else +1 temp."},{name:"Identity Erosion",category:"Strike",type:"Social",cost:1,power:2,target:"resolve",keywords:["Erode"],description:"The song strips a layer of self. The rogue forgets her mother's name for three seconds. It comes back  but the fact that it left is worse than if it hadn't. What else might she forget? Deal 2 resolve. Erode 1."},{name:"Prismatic Terror",category:"Strike",type:"Mystical",cost:1,power:2,target:"nerve",keywords:["Resonate"],description:"The crystals refract the Siren's image into a dozen copies. They're all looking at you. They're all singing different notes. The harmonic dissonance triggers something primal  wrongness beyond articulation. Deal 2 nerve. Resonate: +1P if Mystical last round."},{name:"Absolute Conviction",category:"Strike",type:"Social",cost:2,power:3,target:"resolve",trigger:{condition:{type:"resource_below",resource:"nerve",pct:.5},bonus:1,description:"If nerve below half, +1 Power (fear makes the lies feel true)"},description:"The Siren stops singing and speaks one sentence directly into your mind. It is a lie. It is the most convincing thing you have ever heard. The terrified mind cannot distinguish truth from fabrication. Deal 3 resolve. If nerve below half, deal 4."},{name:"The Unraveling",category:"Strike",type:"Mystical",cost:2,power:3,target:"resolve",keywords:["Overwhelm"],overwhelmTarget:"nerve",description:"The Siren opens her mouth wider than a mouth should open and the song becomes a weapon. Not sound  anti-meaning. The concept that you are a person comes apart. Overwhelm: what resolve can't absorb becomes raw panic. Deal 3 resolve. Excess spills to nerve."},{name:"Harmonic Convergence",category:"Empower",type:"Mystical",cost:2,empowerEffect:{advantage:!0},description:"Every crystal in the room aligns. Scattered refractions snap into a single beam focused on the party. The song builds to something structural  you can feel the air thicken with intent. This is the crescendo. Next Strike gains Advantage."},{name:"Prismatic Confusion",category:"Disrupt",type:"Mystical",cost:1,disruptEffect:{randomizeTarget:!0},description:"Light refracts through a hundred crystal faces at once. The Broodmother is behind you. No  the Warden. No  nothing is there. Where are the walls? The party can't tell what they're aiming at. Opponent's next Strike hits a random resource."},{name:"Echoing Theft",category:"Counter",type:"Mystical",cost:1,counterDamage:{resource:"resolve",amount:1},counterEffect:{steal:!0},description:"The crystals record the party's preparation  the gathering of magical force, the focusing of intent  and play it back. Reversed. Their own power weaponized. Remove condition. Chip 1 resolve. Steal Empower for own use."},{name:"Crystal Ward",category:"Counter",type:"Mystical",cost:1,counterDamage:{resource:"nerve",amount:1},counterEffect:{applyFortify:1,fortifyResource:"veil"},description:"The Siren raises a hand and the crystal nearest the attack hums at a canceling frequency. The party's preparation dissolves into noise. Remove condition. Chip 1 nerve. Fortify veil 1."},{name:"Phase Shift",category:"React",type:"Mystical",cost:0,power:2,reactEffect:{absorb:!0,fortifyResource:"veil",fortifyAmount:1},description:"The blow passes through the Siren's torso and hits the crystal behind her. She wasn't fully there. For a moment you can see the other side through the hole in her chest before it closes. Contest Power 2. Fortify veil 1 regardless."},{name:"Harmonic Reflection",category:"React",type:"Mystical",cost:0,power:1,reactEffect:{reflect:!0},description:"The attack strikes a crystal formation and the impact resonates through the room  amplified, distorted, fed back to the attacker as a wave of disorienting sound. Contest Power 1. On Devastating defense, reflect damage."},{name:"Resonance Trap",category:"Trap",type:"Mystical",cost:1,trapTrigger:"strike_played",trapEffect:[{damage:{resource:"nerve",amount:2}}],description:"The crystals are acoustic amplifiers. Strike one and the vibration cascades through every faceted surface in the room, feeding back as a wall of distorted sound that hits the attacker hardest. When visitor Strikes, nerve -2."},{name:"Crystal Regrowth",category:"Reshape",type:"Mystical",cost:2,reshapeEffect:{heal:[{resource:"veil",amount:2}],fortify:[{resource:"structure",amount:1}]},description:"New crystals push through the stone floor where old ones shattered. They hum immediately  the song teaches them before they finish forming. The room repairs its own voice. Heal 2 veil. Fortify structure 1."}]},yp={name:"The Construct's Forge",description:"A working forge, impossibly active  bellows pumping with no hands, metal glowing in crucibles, hammer strikes ringing from an anvil attended by something made of slag and flame. The Forge Warden. Seven feet of molten iron and purpose. It doesn't speak. It makes.",initiative:"dungeon",autoEffects:[{resource:"vitality",amount:-1,target:"visitor",frequency:"other"},{resource:"structure",amount:-1,target:"dungeon",frequency:"other"},{resource:"veil",amount:-1,target:"dungeon",frequency:"other"}],tags:["Physical","Construct","Fire"],contributions:{structure:6,veil:4,presence:4},modifierContributions:{dominion:1,resonance:0,presence_attr:0,memory:1},resourceContext:{structure:{name:"Forge Infrastructure",attackVerb:"smashing forge equipment",lowDesc:"The bellows stutter. A crucible cracks, leaking molten metal across the floor. The anvil lists sideways.",criticalDesc:"The forge is wrecked. Crucibles shattered, bellows torn, runes dark. The Warden has no tools left."},veil:{name:"Forge Enchantments",attackVerb:"disrupting the rune sequences",lowDesc:"Animated weapons clatter to the floor, suddenly just metal. The fire dims to embers.",criticalDesc:"Every rune is dark. The forge is cold iron and dead stone. Nothing moves but the Warden itself."},presence:{name:"The Forge Warden",attackVerb:"breaking the construct apart",lowDesc:"Slag weeps from cracks in its torso. Joints seize. It leans on the ruined anvil for support.",criticalDesc:"The Warden collapses  eight hundred pounds of cooling metal folding in on itself. The hammer falls last."}},aiContributions:{baseWeights:{Strike:.9,Empower:1,Disrupt:.3,Counter:.4,Trap:.4,Offer:0,Reshape:.8,React:.5,Test:0,Energy:.7},preferredTargets:["vitality","resolve"],comboAwareness:.35,energyEagerness:.3,bondAffinity:0,betrayalAffinity:0},deck:[{name:"Stoke the Forge",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"The Warden drives the bellows with one massive arm. Cinders float upward. Temperature rises. The room becomes its weapon."},{name:"Crucible Heat",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"Molten metal churns in the stone basins. Each crucible is a reservoir of liquid violence waiting to be directed."},{name:"Runic Resonance",category:"Energy",type:"Physical",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Physical",discount:1},description:"The runes along the forge walls pulse in sequence  ancient smithing enchantments aligning with the Warden's rhythm. Next Physical card costs 1 less."},{name:"Forge Blast",category:"Energy",type:"Environmental",cost:0,energyType:"surge",energyGain:0,surgeGain:2,description:"A crucible overflows. Liquid iron hits the stone floor and the whole room flashes white. A burst of raw thermal energy  brief and blinding."},{name:"Heat Siphon",category:"Energy",type:"Environmental",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",resource:"vitality",pct:.5},target:"opponent"},description:"The Warden absorbs heat from cooling blood on the floor. Wounded visitors fuel the forge. +1 permanent if visitor vitality below half, else +1 temp."},{name:"Slag Throw",category:"Strike",type:"Physical",cost:1,power:2,target:"vitality",keywords:["Erode"],description:"The Warden scoops molten metal from a crucible barehanded and hurls it. It spatters across shield and armor, cooling into a crust that keeps burning underneath. Deal 2 vitality. Erode 1."},{name:"Anvil Ring",category:"Strike",type:"Physical",cost:1,power:2,target:"resolve",keywords:["Resonate"],description:"The Warden strikes the anvil  not at you, at the anvil. The ring is deafening and it doesn't stop. The vibration enters your teeth, your skull. It is a sound that says: I will never tire. Deal 2 resolve. Resonate: +1P if Physical last round."},{name:"Hammer of Making",category:"Strike",type:"Physical",cost:2,power:3,target:"vitality",trigger:{condition:{type:"has_condition",condition:"entangled"},bonus:1,description:"If Entangled (chained to the anvil), +1 Power"},description:"A single, perfect strike  the same motion the Warden uses to shape metal, aimed at a person. Centuries of craft behind eight hundred pounds of purpose. The impact rings through the floor. Deal 3 vitality. If chained, deal 4."},{name:"Furnace Breath",category:"Strike",type:"Environmental",cost:2,power:3,target:"resolve",keywords:["Overwhelm"],overwhelmTarget:"nerve",description:"The Warden opens a vent in its chest and exhales forge heat directly at the party. Not fire  superheated air that makes thought impossible. Will crumbles, and what's left is animal panic. Deal 3 resolve. Overwhelm: excess spills to nerve."},{name:"Master Stroke",category:"Empower",type:"Physical",cost:2,empowerEffect:{advantage:!0},description:"The Warden raises its hammer and holds it there. The forge roars. Every weapon on the wall vibrates in sympathetic resonance. The room holds its breath. Whatever comes next will be shaped by centuries of craft. Next Strike gains Advantage."},{name:"Blade Tempest",category:"Disrupt",type:"Physical",cost:1,disruptEffect:{disadvantage:!0},description:"Three unfinished swords rip free of their wall mounts and orbit the Warden in a defensive storm of spinning steel. Try to get close and you're flinching through a blender. Opponent's next Strike at Disadvantage."},{name:"Chain Snare",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"vitality",amount:1},counterEffect:{applyEntangle:!0},description:"The Warden catches the incoming blow on the anvil face with a clang that shakes the room. Before the attacker can pull back, forge chains whip around their weapon arm. You're chained to the anvil now. Remove condition. Chip 1 vitality. Entangle."},{name:"Reforged Plate",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"resolve",amount:1},counterEffect:{applyFortify:1,fortifyResource:"structure"},description:"The blow lands and the Warden barely notices. It reaches to the wound, pulls molten metal from its own core, and patches the dent. Watching a construct repair itself mid-combat is deeply disheartening. Remove condition. Chip 1 resolve. Fortify structure 1."},{name:"Anvil Guard",category:"React",type:"Physical",cost:0,power:2,reactEffect:{absorb:!0,fortifyResource:"structure",fortifyAmount:1},description:"The Warden rips a plate of hot iron from the anvil surface and interposes it. The metal deforms on impact, absorbing force. It'll be reshaped and used again before the round is over. Contest Power 2. Fortify structure 1 regardless."},{name:"Molten Splash",category:"React",type:"Environmental",cost:0,power:1,reactEffect:{reflect:!0},description:"The blow connects and the Warden's body ruptures at the impact point  but what sprays out is liquid iron. The attacker recoils, slag burning through gloves. Contest Power 1. On Devastating defense, reflect damage."},{name:"Forge Eruption",category:"Trap",type:"Environmental",cost:1,trapTrigger:"strike_played",trapEffect:[{damage:{resource:"vitality",amount:2}}],description:"The forge is pressurized. Strike the wrong surface and a geyser of sparks and molten droplets erupts from a seam in the stone. When visitor Strikes, vitality -2."},{name:"Self-Repair",category:"Reshape",type:"Physical",cost:2,reshapeEffect:{heal:[{resource:"structure",amount:2}],fortify:[{resource:"presence",amount:1}]},description:"The Warden pauses, pulls a white-hot ingot from the crucible, and presses it against its own damaged torso. Metal flows like water, filling cracks and sealing joints. It straightens. It is whole again. Heal 2 structure. Fortify presence 1."}]},mp={name:"The Broodmother's Web",description:"A cavern strung with webs thick as rope. Hundreds of pale spiders the size of dogs click and shift across the ceiling. At the center, the Broodmother hangs  ancient, intelligent, territorial. She communicates through vibration and pheromone. The webs are her nervous system. She feels every footstep, every heartbeat.",initiative:"dungeon",autoEffects:[{resource:"vitality",amount:-1,target:"visitor",frequency:"other"},{resource:"nerve",amount:-1,target:"visitor",frequency:"other"},{resource:"structure",amount:-1,target:"dungeon",frequency:"other"}],tags:["Physical","Natural","Creature"],contributions:{structure:6,veil:3,presence:5},modifierContributions:{dominion:1,resonance:0,presence_attr:1,memory:0},resourceContext:{structure:{name:"The Web Network",attackVerb:"cutting through anchor strands",lowDesc:"Sections of web-ceiling sag. Broodlings tumble from their perches, skittering in confusion.",criticalDesc:"The web architecture is collapsing. Tunnels are exposed overhead. Escape routes open."},veil:{name:"Pheromone Cloud",attackVerb:"burning away the chemical fog",lowDesc:"Broodlings stumble into each other, suddenly uncoordinated. The swarm is just individual spiders now.",criticalDesc:"The air is clear. Without the pheromone network, the brood scatters into crevices, purposeless."},presence:{name:"The Broodmother",attackVerb:"driving her back",lowDesc:"She retreats up her central line, favoring a wounded leg. The clicking softens.",criticalDesc:"She abandons the chamber, dragging egg sacs into the dark tunnels behind her."}},aiContributions:{baseWeights:{Strike:1,Empower:.6,Disrupt:.4,Counter:.6,Trap:1,Offer:0,Reshape:.3,React:.4,Test:0,Energy:.5},preferredTargets:["vitality","nerve"],comboAwareness:.3,energyEagerness:.25,bondAffinity:0,betrayalAffinity:0},deck:[{name:"Brood Frenzy",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"The Broodmother floods the web with pheromone. The swarm chittering intensifies  hundreds of legs scraping silk in unison."},{name:"Web Tension",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"She tightens the anchor lines. The whole network vibrates, storing potential energy like a drawn bowstring."},{name:"Silk Attunement",category:"Energy",type:"Environmental",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Environmental",discount:1},description:"The Broodmother presses a forelimb to the central strand and listens. The web tells her everything. Next Environmental card costs 1 less."},{name:"Hunting Surge",category:"Energy",type:"Environmental",cost:0,energyType:"surge",energyGain:0,surgeGain:2,description:"Her eyes lock on wounded prey. Every spider in the room orients at once  a single unified predatory focus that lasts only seconds."},{name:"Venom Siphon",category:"Energy",type:"Environmental",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",resource:"vitality",pct:.5},target:"opponent"},description:"The brood tastes blood on the web. Weakened prey feeds the colony's hunger. +1 permanent if visitor vitality below half, else +1 temp."},{name:"Cold Embrace",category:"Strike",type:"Physical",cost:1,power:2,target:"vitality",keywords:["Entangle"],description:"A dozen broodlings descend on silk lines and wrap the target in layers of webbing. Each strand is thin but there are so many. The silk tightens. Movement stops. Deal 2 vitality. Entangle."},{name:"Swarming Bite",category:"Strike",type:"Physical",cost:1,power:2,target:"nerve",keywords:["Erode"],description:"They pour over the frontline in a pale chittering wave  not large enough to wound deeply but everywhere at once. In hair. Under armor. Between fingers. Deal 2 nerve. Erode 1."},{name:"Venom Fang",category:"Strike",type:"Physical",cost:2,power:3,target:"vitality",keywords:["Drain"],drain:{resource:"presence"},trigger:{condition:{type:"has_condition",condition:"entangled"},bonus:1,description:"If Entangled, +1 Power (can't dodge the queen)"},description:"The Broodmother descends on her own silk  fast, surgical, one massive fang piercing armor at the joint. She feeds, and her presence in the room grows. Deal 3 vitality. If Entangled, deal 4. Drain: damage heals presence."},{name:"Skittering Swarm",category:"Strike",type:"Physical",cost:2,power:3,target:"nerve",keywords:["Overwhelm"],overwhelmTarget:"vitality",description:"The ceiling moves. All of it. Every broodling drops at once in a living rain of legs and fangs. The sheer horror is the primary weapon  but the bites add up. Deal 3 nerve. Overwhelm: excess spills to vitality."},{name:"Broodmother's Command",category:"Empower",type:"Environmental",cost:2,empowerEffect:{advantage:!0},description:"She vibrates the entire web at a frequency that means hunt. Every spider in the room stops, turns, and orients on a single target. The party can see the setup happening  all those eyes turning in unison. Next Strike gains Advantage."},{name:"Thorned Broodlings",category:"Disrupt",type:"Physical",cost:1,disruptEffect:{onStrike:{selfDamage:{resource:"vitality",amount:1}}},description:"Broodlings crawl over the party's weapons and arms. To swing a sword means crushing them  and their dying reflex is to bite. Thorns: opponent takes 1 vitality when next striking."},{name:"Web Catch",category:"Counter",type:"Environmental",cost:1,counterDamage:{resource:"vitality",amount:1},counterEffect:{applyEntangle:!0},description:"The attack lands  but the web absorbs the impact, stretching like a net. And now the blade is tangled in silk, and more silk is wrapping the arm that holds it. Remove condition. Chip 1 vitality. Entangle."},{name:"Cocooning Reflex",category:"Counter",type:"Environmental",cost:1,counterDamage:{resource:"nerve",amount:1},counterEffect:{applyFortify:1,fortifyResource:"structure"},description:"Silk erupts from every anchor point near the impact, wrapping the damaged section in fresh webbing before the blow fully lands. The web heals itself. Remove condition. Chip 1 nerve. Fortify structure 1."},{name:"Silk Curtain",category:"React",type:"Environmental",cost:0,power:2,reactEffect:{absorb:!0,fortifyResource:"structure",fortifyAmount:1},description:"Layers of web drop between the attacker and the Broodmother like a theater curtain  each layer slowing the blow, absorbing force, buying time. Contest Power 2. Fortify structure 1 regardless."},{name:"Sacrificial Drone",category:"React",type:"Physical",cost:0,power:1,reactEffect:{reflect:!0},description:"A broodling hurls itself into the path of the attack, exploding on impact. Its venom sac ruptures outward. Contest Power 1. On Devastating defense, reflect damage  the venom hits the attacker."},{name:"Webline Snare",category:"Trap",type:"Environmental",cost:1,trapTrigger:"strike_played",trapEffect:[{applyEntangle:!0},{damage:{resource:"vitality",amount:1}}],description:"Nearly invisible silk tripwires strung across the approach. Lunge to attack and your legs tangle, momentum carries you forward into a faceful of web. When visitor Strikes, Entangle + 1 vitality."},{name:"Web Reconstruction",category:"Reshape",type:"Environmental",cost:2,reshapeEffect:{heal:[{resource:"structure",amount:2}],fortify:[{resource:"structure",amount:1}]},description:"The Broodmother works through the night shift  spinnerets blazing, anchor lines replaced, damaged sections rebuilt stronger than before. Heal 2 structure. Fortify structure 1."}]},vp={name:"Knight",role:"tank",vitality:10,resolveContribution:7,nerveContribution:5,modifierContributions:{strength:1,cunning:0,perception:0,resilience:0},aiContributions:{baseWeights:{Strike:.8,Empower:.6,Disrupt:.5,Counter:.4,React:.5,Trap:.3,Offer:.1,Reshape:.3,Test:.1,Energy:.5},preferredTargets:["structure"],comboAwareness:.2,bondAffinity:0,cooperationSensitivity:.2},deck:[{name:"Steadfast Resolve",category:"Energy",type:"Physical",cost:0,energyType:"standard",energyGain:1,member:"knight",description:"Discipline forged in a hundred battles. Reliable energy, turn after turn."},{name:"Battle Cry",category:"Energy",type:"Physical",cost:0,energyType:"surge",energyGain:0,surgeGain:2,member:"knight",description:"A shout that rallies the blood. Burst of energy that fades with the echo."},{name:"Shield Bash",category:"Strike",type:"Physical",cost:1,power:2,target:"structure",keywords:["Entangle"],member:"knight",description:"Slam the shield edge-first into stone. Deal 2 structure. Entangle: pin the dungeon's defenses."},{name:"Righteous Blow",category:"Strike",type:"Physical",cost:2,power:3,target:"structure",keywords:["Overwhelm"],overwhelmTarget:"presence",member:"knight",description:"A two-handed overhead strike with conviction behind it. Deal 3 structure. Overwhelm: excess crashes into presence."},{name:"Challenging Roar",category:"Strike",type:"Social",cost:1,power:2,target:"presence",keywords:["Resonate"],member:"knight",description:"Assert dominance over the dungeon's will. Deal 2 presence. Resonate: +1P if Social played last round."},{name:"Defensive Stance",category:"Empower",type:"Physical",cost:1,empowerEffect:{advantage:!0,addKeyword:"Ward"},member:"knight",description:"Plant feet and raise shield. Next Strike gains Advantage and Ward (+1 structure defense, 1 round)."},{name:"Shield Wall",category:"Disrupt",type:"Physical",cost:1,disruptEffect:{disadvantage:!0},member:"knight",description:"Interpose the shield between dungeon and party. Opponent's next Strike has Disadvantage."},{name:"Parry and Riposte",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"structure",amount:1},member:"knight",description:"Deflect the blow and punish the opening. Remove condition. Chip 1 structure."},{name:"Raise Shield",category:"React",type:"Physical",cost:0,power:2,member:"knight",description:"Iron-bound oak absorbs the impact. Contest with Power 2."},{name:"Second Wind",category:"Reshape",type:"Physical",cost:1,reshapeEffect:{heal:[{resource:"vitality",amount:2,target:"self_member"}]},member:"knight",description:"Grit teeth and push through the pain. Restore 2 vitality to self."}]},wp={name:"Battlemage",role:"dps",vitality:7,resolveContribution:5,nerveContribution:5,modifierContributions:{strength:0,cunning:0,perception:1,resilience:0},aiContributions:{baseWeights:{Strike:.9,Empower:.7,Disrupt:.4,Counter:.3,React:.3,Trap:.3,Offer:.1,Reshape:.2,Test:.1,Energy:.6},preferredTargets:["veil"],comboAwareness:.25,bondAffinity:0,cooperationSensitivity:.2},deck:[{name:"Arcane Focus",category:"Energy",type:"Mystical",cost:0,energyType:"standard",energyGain:1,member:"battlemage",description:"Center the mind and draw from the ley lines. Steady arcane power."},{name:"Mana Surge",category:"Energy",type:"Mystical",cost:0,energyType:"surge",energyGain:0,surgeGain:2,member:"battlemage",description:"Crack open the reserves for a single devastating volley. Burns bright, burns fast."},{name:"Elemental Attunement",category:"Energy",type:"Mystical",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Mystical",discount:1},member:"battlemage",description:"Align with the Veil's frequency. +1 energy. Next Mystical card costs 1 less."},{name:"Arcane Bolt",category:"Strike",type:"Mystical",cost:1,power:2,target:"veil",keywords:["Erode"],member:"battlemage",description:"A focused lance of raw magic that frays the Veil. Deal 2 veil. Erode: 1 persistent bleed next round."},{name:"Chain Lightning",category:"Strike",type:"Mystical",cost:2,power:3,target:"veil",member:"battlemage",trigger:{condition:{type:"has_condition",condition:"entangled"},bonus:2,description:"Conductor: +2P if opponent is Entangled"},description:"Arcing electricity seeks grounded targets. Deal 3 veil. Conductor: +2P if opponent is Entangled."},{name:"Shatter Point",category:"Strike",type:"Mystical",cost:2,power:2,target:"structure",member:"battlemage",trigger:{condition:{type:"resource_below",target:"opponent",resource:"structure",pct:.5},bonus:2,description:"Finishing Blow: +2P if dungeon structure below half"},description:"Identify the fracture line and strike with precision. Deal 2 structure. Finishing Blow: +2P if structure below half."},{name:"Spell Amplification",category:"Empower",type:"Mystical",cost:1,empowerEffect:{powerBonus:2,addKeyword:"Overwhelm"},member:"battlemage",description:"Layer enchantments for maximum devastation. Next Strike gains +2 Power and Overwhelm."},{name:"Counterspell",category:"Disrupt",type:"Mystical",cost:1,disruptEffect:{stripKeywords:!0},member:"battlemage",description:"Unravel the enchantment before it lands. Strip all keywords from opponent's next Strike."},{name:"Hex",category:"Disrupt",type:"Mystical",cost:1,disruptEffect:{disadvantage:!1,onStrike:{selfDamage:{resource:"veil",amount:1}}},member:"battlemage",description:"Curse the dungeon  every act of violence drains its magic. Opponent takes 1 veil when next striking."},{name:"Arcane Shield",category:"React",type:"Mystical",cost:0,power:1,member:"battlemage",reactEffect:{conditionalPower:{condition:"self_resource_above_half",resource:"nerve",power:3}},description:"A shimmering barrier fueled by steady nerves. Power 1. If party nerve above half, Power 3."}]},kp={name:"Cleric",role:"support",vitality:7,resolveContribution:6,nerveContribution:5,modifierContributions:{strength:0,cunning:0,perception:0,resilience:0},aiContributions:{baseWeights:{Strike:.3,Empower:.3,Disrupt:.4,Counter:.4,React:.4,Trap:.3,Offer:.4,Reshape:.8,Test:.3,Energy:.5},preferredTargets:["presence"],comboAwareness:.18,bondAffinity:.3,cooperationSensitivity:.6},deck:[{name:"Prayer of Devotion",category:"Energy",type:"Social",cost:0,energyType:"standard",energyGain:1,member:"cleric",description:"Quiet words to a distant god. Steady faith, steady power."},{name:"Sacred Rites",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},member:"cleric",description:"Ritual invocation channels divine favor. +1 energy. Next Social card costs 1 less."},{name:"Faith's Wellspring",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_above",resource:"rapport",threshold:3},target:"opponent"},member:"cleric",description:"Draw strength from growing mutual understanding. +1 permanent if rapport > 3, else +1 temp."},{name:"Holy Light",category:"Strike",type:"Social",cost:1,power:2,target:"presence",member:"cleric",trigger:{condition:{type:"resource_above",target:"self",resource:"trust",threshold:4},bonus:0,description:"Merciful: if trust > 4, gain Ward after striking",onTrigger:{addKeyword:"Ward"}},description:"Divine radiance tests the dungeon's will. Deal 2 presence. Merciful: gain Ward if trust > 4."},{name:"Healing Word",category:"Reshape",type:"Social",cost:3,reshapeEffect:{restoreMember:!0,heal:[{resource:"vitality",amount:4,target:"select_member"}]},member:"cleric",description:"Speak life back into fallen flesh. Restore a downed ally at 4 vitality, or heal an active ally by 4. Expensive but irreplaceable."},{name:"Fortify Spirit",category:"Reshape",type:"Social",cost:1,reshapeEffect:{fortify:{resource:"resolve",reduction:1,duration:2}},member:"cleric",description:"Steel the party's will against despair. Fortify resolve: reduce Break damage by 1 for 2 rounds."},{name:"Peaceful Parley",category:"Offer",type:"Social",cost:1,target:"trust",offerPayload:[{resource:"trust",amount:1,target:"opponent"},{resource:"rapport",amount:1,target:"self"},{resource:"nerve",amount:1,target:"opponent"}],member:"cleric",description:"Extend an open hand and speak without guile. Accept: build mutual trust and soothe the dungeon's fear."},{name:"Leap of Faith",category:"Test",type:"Social",cost:1,target:"trust",testReward:{trust:2,rapport:2},defectPenalty:{trustCrash:.5,powerGain:2},exposureCost:{resource:"resolve",amount:1},member:"cleric",description:"Lower all defenses and trust the darkness. Cooperate: +2 trust, +2 rapport, lose 1 resolve. Defect: trust crashes, defector empowered."},{name:"Purifying Light",category:"Counter",type:"Social",cost:1,counterDamage:{resource:"presence",amount:0},counterEffect:{healLowest:1},member:"cleric",description:"Cleanse the corruption and mend what it touched. Remove condition. Restore 1 to party's lowest reducer. No chip damage."},{name:"Divine Ward",category:"React",type:"Social",cost:0,power:1,member:"cleric",reactEffect:{absorb:!0,fortifyAmount:1},description:"A prayer answered in the nick of time. Contest Power 1. Gain Fortify 1 regardless of outcome."}]},Sp={name:"Rogue",role:"flex",vitality:6,resolveContribution:4,nerveContribution:5,modifierContributions:{strength:0,cunning:1,perception:0,resilience:0},aiContributions:{baseWeights:{Strike:.5,Empower:.4,Disrupt:.5,Counter:.4,React:.3,Trap:.6,Offer:.2,Reshape:.2,Test:.3,Energy:.5},preferredTargets:["veil","presence"],comboAwareness:.22,bondAffinity:0,cooperationSensitivity:.3},deck:[{name:"Quick Fingers",category:"Energy",type:"Physical",cost:0,energyType:"standard",energyGain:1,member:"rogue",description:"Nimble hands find purchase where others see smooth stone."},{name:"Shadow Sense",category:"Energy",type:"Environmental",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",target:"opponent",resource:"veil",pct:.5},target:"opponent"},member:"rogue",description:"Thinning magic reveals hidden passages. +1 permanent if dungeon veil below half, else +1 temp."},{name:"Backstab",category:"Strike",type:"Physical",cost:1,power:2,target:"veil",member:"rogue",trigger:{condition:{type:"resource_below",target:"opponent",resource:"presence",pct:.75},bonus:2,description:"Exploit Weakness: +2P if dungeon presence below 75%"},description:"Strike where pride has already been shaken. Deal 2 veil. Exploit Weakness: +2P if presence below 75%."},{name:"Poisoned Blade",category:"Strike",type:"Environmental",cost:1,power:1,target:"veil",keywords:["Erode"],member:"rogue",description:"A nick that festers. Deal 1 veil. Erode: persistent magical decay next round."},{name:"Tripwire",category:"Trap",type:"Environmental",cost:1,trapTrigger:"strike_played",member:"rogue",trapEffect:{damage:{resource:"presence",amount:1},applyCondition:{type:"entangled"}},description:"Set a cunning snare. When dungeon plays a Strike: deal 1 presence and Entangle. Sets up the party's combo line."},{name:"Flash Bomb",category:"Trap",type:"Environmental",cost:1,trapTrigger:"offer_accepted",member:"rogue",trapEffect:{damage:{resource:"nerve",amount:2}},description:"A blinding burst rigged to a suspicious gift. When an Offer is accepted: deal 2 nerve. Punishes deceptive dungeons at their own game."},{name:"Sleight of Hand",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"presence",amount:0},counterEffect:{stealEmpower:!0},member:"rogue",description:"Pluck the enchantment from the air and claim it. Remove Empower from dungeon  gain it for the party."},{name:"Disarm Trap",category:"Counter",type:"Environmental",cost:1,counterDamage:{resource:"structure",amount:0},counterEffect:{trapBonus:{resource:"trust",amount:2}},member:"rogue",description:"Spot the trap and defuse it with care. Remove condition. If a Trap was removed: +2 trust (the party sees through the deception)."},{name:"Smoke Screen",category:"Disrupt",type:"Environmental",cost:1,disruptEffect:{randomTarget:!0},member:"rogue",description:"Fill the room with blinding smoke. Opponent's next Strike targets a random resource instead of chosen."},{name:"Evasion",category:"React",type:"Physical",cost:0,power:1,member:"rogue",reactEffect:{conditionalPower:{condition:"self_resource_above_half",resource:"nerve",power:3}},description:"Dodge into shadow when the blow comes. Power 1. If party nerve above half, Power 3."}]},xp={name:"Warden",role:"tank",vitality:11,resolveContribution:6,nerveContribution:4,modifierContributions:{strength:1,cunning:0,perception:0,resilience:0},aiContributions:{baseWeights:{Strike:.6,Empower:.5,Disrupt:.5,Counter:.5,React:.5,Trap:.3,Offer:.1,Reshape:.4,Test:.1,Energy:.5},preferredTargets:["structure"],comboAwareness:.18,bondAffinity:.1,cooperationSensitivity:.3},deck:[{name:"Steadfast Will",category:"Energy",type:"Physical",cost:0,energyType:"standard",energyGain:1,member:"warden",description:"Disciplined resolve fuels the party. Reliable energy."},{name:"Iron Bark",category:"Energy",type:"Physical",cost:0,energyType:"surge",surgeGain:2,member:"warden",description:"The Warden channels the forest's strength in a burst of power."},{name:"Shield of Thorns",category:"Strike",type:"Physical",cost:1,power:2,target:"structure",keywords:["Entangle"],member:"warden",description:"A shield bash that pins the enemy in thorny vines. Deal 2 structure. Entangle."},{name:"Root Strike",category:"Strike",type:"Environmental",cost:2,power:3,target:"structure",member:"warden",description:"Command the roots to crush the dungeon's foundation. Deal 3 structure."},{name:"Stalwart Guard",category:"Empower",type:"Physical",cost:1,empowerEffect:{advantage:!0,addKeyword:"Ward"},member:"warden",description:"Set a defensive stance. Next Strike gains Advantage and Ward."},{name:"Stone Wall",category:"Disrupt",type:"Environmental",cost:1,disruptEffect:{onStrike:{selfDamage:{resource:"structure",amount:1}}},member:"warden",description:"Raise a wall of living stone. Opponent's next Strike deals 1 structure to themselves."},{name:"Guardian Stance",category:"Disrupt",type:"Physical",cost:2,disruptEffect:{guard:{target:"lowest_vitality_ally",powerReduction:2,duration:2},selfFortify:{resource:"vitality",reduction:1,duration:1}},member:"warden",description:"The Warden plants herself between danger and her allies. Weakest ally gains Guarded (Strikes targeting them have -2 Power) for 2 rounds. Warden gains Fortify 1."},{name:"Bark Skin",category:"React",type:"Environmental",cost:0,power:2,member:"warden",description:"Skin hardens to bark, absorbing the blow. Contest with Power 2."},{name:"Earthen Recovery",category:"Reshape",type:"Physical",cost:2,reshapeEffect:{heal:[{resource:"vitality",amount:3,target:"weakest_member"}],fortify:[{resource:"vitality",reduction:1,duration:1}]},member:"warden",description:"Draw strength from the earth. Heal weakest member 3 vitality. Fortify structure 1."},{name:"Nature's Renewal",category:"Reshape",type:"Environmental",cost:3,reshapeEffect:{restore:{target:"knocked_out",amount:.4}},member:"warden",description:"The forest reclaims what was lost. Restore a downed ally at 40% vitality."}]},Ep={name:"Sorcerer",role:"dps",vitality:5,resolveContribution:4,nerveContribution:6,modifierContributions:{strength:0,cunning:0,perception:1,resilience:0},aiContributions:{baseWeights:{Strike:1,Empower:.7,Disrupt:.3,Counter:.2,React:.2,Trap:.2,Offer:.1,Reshape:.2,Test:.1,Energy:.7},preferredTargets:["veil"],comboAwareness:.25,bondAffinity:0,cooperationSensitivity:.15},deck:[{name:"Arcane Focus",category:"Energy",type:"Mystical",cost:0,energyType:"standard",energyGain:1,member:"sorcerer",description:"Channel arcane energy through a crystalline focus."},{name:"Mana Surge",category:"Energy",type:"Mystical",cost:0,energyType:"surge",surgeGain:2,member:"sorcerer",description:"A burst of raw mana floods the party's reserves."},{name:"Arcane Bolt",category:"Strike",type:"Mystical",cost:1,power:2,target:"veil",member:"sorcerer",description:"A focused beam of arcane energy tears at the Veil. Deal 2 veil."},{name:"Chain Lightning",category:"Strike",type:"Environmental",cost:2,power:2,target:"veil",member:"sorcerer",trigger:{description:"If entangled: +2 Power",condition:{type:"has_condition",condition:"entangled"},bonus:2},description:"Lightning arcs through grounded targets. Deal 2 veil. +2 Power if entangled."},{name:"Eldritch Burst",category:"Strike",type:"Mystical",cost:3,power:4,target:"veil",keywords:["Overwhelm"],overwhelmTarget:"resolve",member:"sorcerer",description:"Devastating arcane detonation. Deal 4 veil. Overwhelm: excess  resolve."},{name:"Hex",category:"Disrupt",type:"Mystical",cost:1,disruptEffect:{onStrike:{selfDamage:{resource:"veil",amount:1}}},member:"sorcerer",description:"A curse that punishes aggression. Opponent's next Strike costs 1 veil."},{name:"Counterspell",category:"Counter",type:"Mystical",cost:1,counterDamage:{resource:"veil",amount:1},member:"sorcerer",description:"Unravel the opponent's preparation. Remove condition. Chip 1 veil."},{name:"Mana Shield",category:"Counter",type:"Mystical",cost:1,counterDamage:{resource:"veil",amount:1},counterEffect:{spreadFortify:{condition:"self_has_fortify",target:"lowest_vitality_ally",resource:"vitality",reduction:1,duration:1}},member:"sorcerer",description:"Raw magical energy deflects hostile intent. Remove condition. Chip 1 veil. If Sorcerer has Fortify, also grant Fortify 1 to weakest ally."},{name:"Arcane Barrier",category:"React",type:"Mystical",cost:0,power:2,reactEffect:{onSuccess:{selfFortify:{resource:"vitality",reduction:1,duration:1}}},member:"sorcerer",description:"A shimmering barrier of arcane energy. Contest with Power 2. On success: Fortify 1 to self for 1 round."},{name:"Arcane Ward",category:"Reshape",type:"Mystical",cost:2,reshapeEffect:{fortify:[{resource:"vitality",reduction:2,duration:2}],heal:[{resource:"vitality",amount:1,target:"self_member"}]},member:"sorcerer",description:"Shimmering arcane energy absorbs incoming blows. Fortify 2 to self for 2 rounds. Heal 1 vitality."}]},bp={name:"Druid",role:"support",vitality:6,resolveContribution:5,nerveContribution:6,modifierContributions:{strength:0,cunning:0,perception:1,resilience:0},aiContributions:{baseWeights:{Strike:.3,Empower:.3,Disrupt:.2,Counter:.2,React:.3,Trap:.2,Offer:.5,Reshape:.8,Test:.4,Energy:.5},preferredTargets:["veil"],comboAwareness:.2,bondAffinity:.5,cooperationSensitivity:.8},deck:[{name:"Natural Harmony",category:"Energy",type:"Environmental",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Environmental",discount:1},member:"druid",description:"Attune to the natural world. +1 permanent. Next Environmental card costs 1 less."},{name:"Spiritual Attunement",category:"Energy",type:"Mystical",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Mystical",discount:1},member:"druid",description:"Open the mind to mystical currents. +1 permanent. Next Mystical card costs 1 less."},{name:"Grounding Roots",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,member:"druid",description:"Draw steady energy from the earth beneath."},{name:"Thorn Whip",category:"Strike",type:"Environmental",cost:1,power:1,target:"vitality",keywords:["Entangle"],member:"druid",description:"Thorny vines lash out and bind. Deal 1 vitality. Entangle. Setup for combos."},{name:"Peaceful Offering",category:"Offer",type:"Social",cost:1,target:"trust",offerPayload:[{resource:"trust",amount:1,target:"self"},{resource:"rapport",amount:1,target:"opponent"},{resource:"nerve",amount:2,target:"self"}],member:"druid",description:"Extend an olive branch. Accept: +1 trust, +1 rapport, heal 2 nerve."},{name:"Commune with Nature",category:"Test",type:"Social",cost:1,target:"rapport",testAmount:2,member:"druid",description:"Open a channel between dungeon and party. Build rapport through shared understanding."},{name:"Healing Touch",category:"Reshape",type:"Social",cost:2,reshapeEffect:{heal:[{resource:"vitality",amount:3,target:"weakest_member"},{resource:"resolve",amount:1,target:"self"}],extendFortify:{target:"healed_member",rounds:1}},member:"druid",description:"Warm hands mend wounds and sustain wards. Heal weakest member 3 vit, +1 resolve. If target has Fortify, extend duration by 1 round."},{name:"Barkskin Blessing",category:"Reshape",type:"Environmental",cost:1,reshapeEffect:{fortify:[{resource:"vitality",reduction:1,duration:1}],heal:[{resource:"vitality",amount:1,target:"weakest_member"}]},member:"druid",description:"Gift bark-like protection and minor healing. Fortify structure 1. Heal 1 vitality."},{name:"Restoration",category:"Reshape",type:"Environmental",cost:3,reshapeEffect:{restore:{target:"knocked_out",amount:.4}},member:"druid",description:"Nature reclaims the fallen. Restore a downed ally at 40% vitality."},{name:"Wild Growth",category:"React",type:"Environmental",cost:0,power:1,reactEffect:{reflect:{amount:1,resource:"resolve"}},member:"druid",description:"Vines surge to deflect. Contest Power 1. On Devastating defense, reflect 1 resolve."}]},Tp={name:"Ranger",role:"dps",vitality:7,resolveContribution:5,nerveContribution:5,modifierContributions:{strength:0,cunning:1,perception:0,resilience:0},aiContributions:{baseWeights:{Strike:.7,Empower:.5,Disrupt:.4,Counter:.3,React:.3,Trap:.4,Offer:.2,Reshape:.3,Test:.2,Energy:.5},preferredTargets:["structure","presence"],comboAwareness:.22,bondAffinity:.1,cooperationSensitivity:.35},deck:[{name:"Focused Aim",category:"Energy",type:"Physical",cost:0,energyType:"standard",energyGain:1,member:"ranger",description:"Patient precision generates steady energy."},{name:"Siphon Shot",category:"Energy",type:"Environmental",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",resource:"veil",pct:.5},target:"opponent"},member:"ranger",description:"Draw energy from the thinning Veil. Permanent if veil < 50%, temp otherwise."},{name:"Hunter's Draw",category:"Energy",type:"Physical",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"has_condition",condition:"entangled"},target:"opponent"},member:"ranger",description:"Exploit a pinned target. Permanent if opponent entangled, temp otherwise."},{name:"Precise Shot",category:"Strike",type:"Physical",cost:1,power:2,target:"structure",member:"ranger",description:"A carefully placed arrow finds a structural weakness. Deal 2 structure."},{name:"Piercing Arrow",category:"Strike",type:"Physical",cost:2,power:3,target:"structure",keywords:["Erode"],member:"ranger",description:"An arrow that bores deep and keeps working. Deal 3 structure. Erode 1."},{name:"Poisoned Arrow",category:"Strike",type:"Environmental",cost:1,power:1,target:"veil",keywords:["Erode"],member:"ranger",description:"A toxin-laced arrow that corrodes magical barriers. Deal 1 veil. Erode 1."},{name:"Ensnaring Shot",category:"Disrupt",type:"Physical",cost:1,disruptEffect:{onStrike:{applyEntangle:!0}},member:"ranger",description:"A bola-tipped arrow. Opponent's next Strike triggers Entangle on themselves."},{name:"Nature's Snare",category:"Trap",type:"Environmental",cost:1,trapTrigger:"strike_played",trapEffect:[{resource:"structure",amount:-2,target:"triggerer"}],member:"ranger",description:"Hidden snare springs when the dungeon attacks. Deal 2 structure on Strike."},{name:"Evasive Counter",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"structure",amount:1},counterEffect:{applyEntangle:!0},member:"ranger",description:"Dodge and counterattack. Remove condition. Chip 1 structure. Apply Entangle."},{name:"Quick Dodge",category:"React",type:"Physical",cost:0,power:1,member:"ranger",description:"A nimble sidestep. Contest with Power 1."}]},Cp={name:"Thornback Boar",type:"creature",vitality:28,resolve:14,nerve:14,trust:0,modifiers:{strength:2,cunning:0,perception:1,resilience:1},motivation:"territorial",aiProfile:"feral_aggressive",deck:[{name:"Primal Stamina",category:"Energy",type:"Physical",cost:0,energyType:"standard",energyGain:1,description:"Raw animal endurance fuels the fight."},{name:"Stubborn Will",category:"Energy",type:"Physical",cost:0,energyType:"standard",energyGain:1,description:"Too stubborn to stop, too angry to die."},{name:"Territorial Fury",category:"Energy",type:"Physical",cost:0,energyType:"surge",energyGain:0,surgeGain:2,description:"Rage at trespass  a burst that won't last."},{name:"Thick Hide",category:"Energy",type:"Physical",cost:0,energyType:"surge",energyGain:0,surgeGain:2,description:"Absorb a blow, channel it into the next charge."},{name:"Bloodscent",category:"Energy",type:"Physical",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_below",target:"opponent",resource:"structure",pct:.5},target:"opponent"},description:"Crumbling walls mean the prey is weakening. +1 permanent if structure below half, else +1 temp."},{name:"Gore",category:"Strike",type:"Physical",cost:2,power:2,target:"structure",trigger:{condition:{type:"resource_below",target:"self",resource:"vitality",pct:.5},bonus:2,description:"Desperate: +2P if vitality  50%"},description:"Tusks driven by desperation. Deal 2 structure. Desperate: +2P if vitality below half."},{name:"Rampaging Charge",category:"Strike",type:"Physical",cost:3,power:3,target:"structure",keywords:["Overwhelm"],overwhelmTarget:"presence",description:"Full-speed collision. Deal 3 structure. Overwhelm: excess spills to presence."},{name:"Territorial Stomp",category:"Strike",type:"Physical",cost:1,power:2,target:"presence",keywords:["Resonate"],description:"Stake a claim with thundering hooves. Deal 2 presence. Resonate: +1P if same type last round."},{name:"Tusk Slash",category:"Strike",type:"Physical",cost:1,power:1,target:"veil",keywords:["Erode"],description:"A slashing graze that won't stop bleeding. Deal 1 veil. Erode 1."},{name:"Boar's Rage",category:"Empower",type:"Physical",cost:1,empowerEffect:{advantage:!0},description:"See red. Next Strike gains Advantage."},{name:"Dig In",category:"Empower",type:"Physical",cost:1,empowerEffect:{powerBonus:1,addKeyword:"Erode"},description:"Lower the head and prepare to grind. Next Strike gains +1 Power and Erode."},{name:"Thrashing",category:"Disrupt",type:"Physical",cost:1,disruptEffect:{disadvantage:!0},description:"Wild flailing disrupts aim. Opponent's next Strike has Disadvantage."},{name:"Bellowing Roar",category:"Disrupt",type:"Social",cost:1,disruptEffect:{disadvantage:!1,onStrike:{selfDamage:{resource:"presence",amount:1}}},description:"A roar that shakes the walls. Opponent takes 1 presence damage when next striking."},{name:"Shake Free",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"structure",amount:1},description:"Thrash loose from the trap. Remove condition. Chip 1 structure."},{name:"Thick Bristles",category:"React",type:"Physical",cost:0,power:2,description:"Bristled hide deflects the worst. Contest with Power 2."},{name:"Instinctive Dodge",category:"React",type:"Physical",cost:0,power:1,reactEffect:{conditionalPower:{condition:"self_resource_below_half",resource:"vitality",power:3}},description:"Survival instincts sharpen when wounded. Power 1. If vitality below half, Power 3."}]},_p={name:"Veil Moth",type:"creature",vitality:18,resolve:16,nerve:20,trust:2,modifiers:{strength:0,cunning:2,perception:2,resilience:1},motivation:"curiosity",aiProfile:"cautious_explorer",deck:[{name:"Flickering Wing",category:"Energy",type:"Mystical",cost:0,energyType:"standard",energyGain:1,description:"Wings beat between planes, shedding sparks of power."},{name:"Dust Shimmer",category:"Energy",type:"Mystical",cost:0,energyType:"standard",energyGain:1,description:"Iridescent scales catch dimensional light."},{name:"Faint Pulse",category:"Energy",type:"Mystical",cost:0,energyType:"surge",surgeGain:2,description:"A sudden heartbeat surge synchronized to dimensional rifts."},{name:"Sensory Bloom",category:"Energy",type:"Mystical",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Mystical",discount:1},description:"Antennae attune to the veil's frequency. Next Mystical card costs 1 less."},{name:"Veil Tap",category:"Energy",type:"Mystical",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"has_condition",condition:"erode"},target:"opponent"},description:"Sip energy from decaying boundaries. +1 permanent if opponent has Erode, else +1 temp."},{name:"Veil Siphon",category:"Strike",type:"Mystical",cost:3,power:2,target:"veil",keywords:["Drain"],drainTarget:"vitality",description:"Drink the boundary between worlds. Deal 2 veil. Drain to vitality (max 2). Cost 3: premium sustain."},{name:"Luminous Burst",category:"Strike",type:"Mystical",cost:2,power:3,target:"veil",keywords:["Overwhelm"],overwhelmTarget:"presence",description:"Blinding flash tears the veil apart. Deal 3 veil. Overwhelm: excess spills to presence."},{name:"Dissonant Flutter",category:"Strike",type:"Social",cost:1,power:2,target:"presence",keywords:["Erode"],description:"Wings beat at frequencies that unravel identity. Deal 2 presence. Erode 1."},{name:"Probing Antennae",category:"Strike",type:"Mystical",cost:1,power:1,target:"structure",keywords:["Resonate"],description:"Feelers test physical integrity. Deal 1 structure. Resonate: +1P if same type last round."},{name:"Ethereal Focus",category:"Empower",type:"Mystical",cost:1,empowerEffect:{advantage:!0,addKeyword:"Drain"},description:"Phase partially through the veil. Advantage and Drain on next Strike."},{name:"Confusing Dust",category:"Disrupt",type:"Environmental",cost:1,disruptEffect:{disadvantage:!1,stripKeywords:!0},description:"Hallucinogenic scales cloud the senses. Opponent's next Strike loses all keywords."},{name:"Dazzling Scales",category:"Disrupt",type:"Mystical",cost:1,disruptEffect:{disadvantage:!0},description:"Blinding iridescence disrupts focus. Opponent's next Strike has Disadvantage."},{name:"Phase Shift",category:"Counter",type:"Mystical",cost:1,counterDamage:{resource:"veil",amount:1},counterEffect:{applyFortify:1,fortifyResource:"vitality"},description:"Shift between planes to sidestep. Remove condition. Chip 1 veil. Fortify vitality 1."},{name:"Dust Veil",category:"React",type:"Mystical",cost:0,power:2,description:"Cloud of shimmering dust absorbs the impact. Contest with Power 2."},{name:"Evasive Flutter",category:"React",type:"Physical",cost:0,power:1,reactEffect:{alwaysFortify:1},description:"Quick wingbeat sidestep. Contest Power 1. Gain Fortify 1 regardless."},{name:"Spectral Dodge",category:"React",type:"Mystical",cost:0,power:1,reactEffect:{conditionalPower:{condition:"self_resource_below_half",resource:"vitality",power:3}},description:"Phase out when desperate. Power 1. If vitality below half, Power 3."}]},Rp={name:"Drift Symbiote",type:"creature",vitality:18,resolve:18,nerve:18,trust:0,modifiers:{strength:0,cunning:1,perception:1,resilience:2},motivation:"shelter",aiProfile:"cooperative",deck:[{name:"Symbiotic Pulse",category:"Energy",type:"Social",cost:0,energyType:"standard",energyGain:1,description:"Life-force shared between organisms."},{name:"Adaptive Core",category:"Energy",type:"Environmental",cost:0,energyType:"standard",energyGain:1,description:"The symbiote reshapes itself to gather energy."},{name:"Trust Filament",category:"Energy",type:"Social",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},description:"Thin threads of trust crystallize into power. Next Social card costs 1 less."},{name:"Root Anchor",category:"Energy",type:"Environmental",cost:0,energyType:"attune",energyGain:1,attune:{cardType:"Social",discount:1},description:"Tendrils grip the earth to channel cooperative warmth. Next Social card costs 1 less."},{name:"Resonant Thread",category:"Energy",type:"Social",cost:0,energyType:"siphon",energyGain:1,siphonFallback:1,siphon:{condition:{type:"resource_above",resource:"rapport",threshold:3},target:"opponent"},description:"Draw power from mutual rapport. +1 permanent if dungeon rapport > 3, else +1 temp."},{name:"Tendril Lash",category:"Strike",type:"Physical",cost:1,power:1,target:"structure",keywords:["Erode"],description:"A reluctant swipe that lingers. Deal 1 structure. Erode 1."},{name:"Psychic Prod",category:"Strike",type:"Social",cost:1,power:1,target:"presence",trigger:{condition:{type:"resource_above",target:"self",resource:"trust"},bonus:1,description:"If trust > 3, +1P (knows your weaknesses)"},description:"A gentle mental nudge. Deal 1 presence. If trust > 3, deal 2 (familiar insight)."},{name:"Symbiotic Probe",category:"Test",type:"Social",cost:1,target:"trust",testReward:{trust:2,rapport:2},defectPenalty:{trustCrash:.5,powerGain:2},exposureCost:{resource:"vitality",amount:1},description:"Extend a vulnerable tendril. Cooperate: +2 trust, +2 rapport, lose 1 vitality. Defect: trust crashes."},{name:"Symbiotic Bond",category:"Empower",type:"Social",cost:1,empowerEffect:{advantage:!0},description:"Deepen the connection. Next action gains Advantage."},{name:"Harmonize",category:"Empower",type:"Social",cost:1,empowerEffect:{powerBonus:1,addKeyword:"Ward"},description:"Attune to the dungeon's rhythm. Next action gains +1 Power and Ward."},{name:"Mutual Nourishment",category:"Offer",type:"Social",cost:1,offer:{benefit:{resource:"presence",amount:2},cost:{type:"flat",resource:"veil",amount:1},investment:{trust:1}},description:"The symbiote extends nourishing tendrils. Accept the gift  presence strengthens, though the mystical barrier thins slightly. Presence +2. Cost: veil -1."},{name:"Shared Warmth",category:"Offer",type:"Environmental",cost:2,offer:{benefit:{resource:"structure",amount:3},cost:{type:"extraction",effect:"visitor_knowledge_1"},investment:{trust:2}},description:"Tendrils weave into damaged walls, mending from within. The symbiote learns the dungeon's architecture as it heals. Structure +3. Cost: symbiote learns about dungeon construction."},{name:"Absorb Impact",category:"Counter",type:"Physical",cost:1,counterDamage:{resource:"structure",amount:0},counterEffect:{applyFortify:1,fortifyResource:"vitality"},description:"Absorb the disruption into elastic tissue. Remove condition. Fortify vitality 1. No chip."},{name:"Elastic Membrane",category:"React",type:"Physical",cost:0,power:2,description:"Stretchy membrane distributes force. Contest with Power 2."},{name:"Adaptive Shell",category:"React",type:"Environmental",cost:0,power:1,reactEffect:{alwaysFortify:1},description:"Harden on impact, soften after. Contest Power 1. Gain Fortify 1 regardless."}]},Pp={"root-hollow":cp,"whispering-gallery":dp,"veil-breach":fp,"honeyed-hollow":pp,"living-root-sanctuary":gp,"hollow-sirens-grotto":hp,"constructs-forge":yp,"broodmothers-web":mp},Dp={knight:vp,battlemage:wp,cleric:kp,rogue:Sp,warden:xp,sorcerer:Ep,druid:bp,ranger:Tp},$p={"thornback-boar":Cp,"veil-moth":_p,"drift-symbiote":Rp},Wc=["root-hollow","whispering-gallery","veil-breach","honeyed-hollow","living-root-sanctuary","hollow-sirens-grotto","constructs-forge","broodmothers-web"],Vc=["knight","battlemage","cleric","rogue","warden","sorcerer","druid","ranger"],jp=["thornback-boar","veil-moth","drift-symbiote"];function Wn(o){const a=Pp[o];if(!a)throw new Error(`Unknown encounter: "${o}". Valid: ${Wc.join(", ")}`);return a}function Mp(){return[...Wc]}function eo(o){const a=Dp[o];if(!a)throw new Error(`Unknown member: "${o}". Valid: ${Vc.join(", ")}`);return a}function Hc(o){return eo(o).deck}function Ap(){return[...Vc]}function Op(o){const a=$p[o];if(!a)throw new Error(`Unknown creature: "${o}". Valid: ${jp.join(", ")}`);return a}const to=Object.fromEntries(Mp().map(o=>[o,{key:o,...Wn(o)}])),no=Object.fromEntries(Ap().map(o=>[o,{key:o,...eo(o)}])),ua={trust:0,killThreshold:2,knockoutMorale:[{resolveHit:3,nerveHit:3},{resolveHit:5,nerveHit:5}]};function Gc(o){if(!Array.isArray(o)||o.length!==3)throw new Error(`buildDungeonTemplate requires exactly 3 encounters, got ${(o==null?void 0:o.length)||0}`);if(new Set(o).size!==o.length)throw new Error(`Duplicate encounters not permitted: ${o.join(", ")}`);let i=0,c=0,d=0;const u={dominion:0,resonance:0,presence_attr:0,memory:0};for(const h of o){const m=Wn(h),k=m.contributions,w=m.modifierContributions;if(!k)throw new Error(`Encounter '${h}' has no contributions field. Run migration first.`);if(i+=k.structure||0,c+=k.veil||0,d+=k.presence||0,w)for(const[v,T]of Object.entries(w))u[v]=(u[v]||0)+T}return{name:`Dungeon (${o.map(h=>Wn(h).name).join(" + ")})`,structure:i,veil:c,presence:d,rapport:0,modifiers:u}}function Uc(o){if(!Array.isArray(o)||o.length!==4)throw new Error(`buildPartyTemplate requires exactly 4 members, got ${(o==null?void 0:o.length)||0}`);let a=0,i=0;const c={strength:0,cunning:0,perception:0,resilience:0},d={};for(const g of o){const h=eo(g);if(d[g]={name:h.name,role:h.role,vitality:h.vitality,resolveContribution:h.resolveContribution,nerveContribution:h.nerveContribution},a+=h.resolveContribution,i+=h.nerveContribution,h.modifierContributions)for(const[m,k]of Object.entries(h.modifierContributions))c[m]=(c[m]||0)+k}return{name:`Party (${o.map(g=>eo(g).name).join(", ")})`,type:"party",partySize:o.length,resolve:a,nerve:i,trust:ua.trust,members:d,killThreshold:ua.killThreshold,knockoutMorale:ua.knockoutMorale,modifiers:c}}function zp(o){const a=[];for(const i of o){const c=Hc(i);a.push(...c)}return a}function Np(o,a,i){const c=(o.Strike||0)+(o.Empower||0),d=(o.Counter||0)+(o.Disrupt||0)+(o.Trap||0),u=(o.Offer||0)+(o.Test||0)+(o.Reshape||0),f=c+d+u;if(f===0)return{name:"Dormant",desc:"No clear tactical identity."};if(a>=2)return{name:"Guardian",desc:"Seeks understanding and mutual benefit. Prefers Bond outcomes."};if(a>=1)return{name:"Shepherd",desc:"Guides visitors with care, but maintains boundaries."};if(i>=1.5)return{name:"Deceiver",desc:"Builds trust to exploit it. Honeyed words hide sharp teeth."};const g=c/f,h=d/f;return g>.45?{name:"Predator",desc:"Aggressive and direct. Prefers overwhelming force."}:h>.4?{name:"Architect",desc:"Controls the flow. Disrupts, counters, and traps."}:{name:"Warden",desc:"Balanced approach. Adapts tactics to the situation."}}function Bp(o,a){const i=(o.Strike||0)+(o.Empower||0),c=(o.Counter||0)+(o.React||0),d=(o.Offer||0)+(o.Reshape||0)+(o.Test||0),u=i+c+d;return u===0?{name:"Lost",desc:"No clear tactical identity."}:a>=1.5?{name:"Diplomats",desc:"Seek connection over conquest. Open to cooperation."}:d/u>.35?{name:"Seekers",desc:"Explorers who sustain and investigate. Cautious but curious."}:i>c*1.3?{name:"War Party",desc:"Aggressive and focused. Here to destroy the dungeon."}:c>i?{name:"Shieldwall",desc:"Defensive formation. Hard to break, slow to advance."}:{name:"Adventurers",desc:"Balanced party. Adapts to the situation at hand."}}function Ip(o){const a={};let i=0,c=0,d=0,u=0;for(const h of o){const k=Wn(h).aiContributions;if(!(!k||!k.baseWeights)){for(const[w,v]of Object.entries(k.baseWeights))a[w]=(a[w]||0)+v;i+=k.comboAwareness||0,c+=k.energyEagerness||0,d+=k.bondAffinity||0,u+=k.betrayalAffinity||0}}const f=d>=2?"nurturing":u>=2?"deceptive":d>0||u>0?"mixed":null,g=Np(a,d,u);return{weights:a,comboAwareness:i,energyEagerness:c,bondAffinity:d,betrayalAffinity:u,strategy:f,archetype:g}}function Fp(o){const a={};let i=0,c=0,d=0;for(const m of o){const w=eo(m).aiContributions;if(!(!w||!w.baseWeights)){for(const[v,T]of Object.entries(w.baseWeights))a[v]=(a[v]||0)+T;i+=w.comboAwareness||0,c+=w.bondAffinity||0,d+=w.cooperationSensitivity||0}}const u=Bp(a,c),f=o.length>0?d/o.length:0,g=Math.max(2,Math.round(5-f*4)),h=Math.max(g+1,Math.round(7-f*5));return{weights:a,comboAwareness:i,bondAffinity:c,cooperationSensitivity:d,archetype:u,cooperationThresholds:{cautious:g,cooperative:h}}}function Jr({label:o,value:a,max:i,color:c}){const d=i>0?Math.min(100,a/i*100):0;return y.jsxs("div",{style:{marginBottom:"8px"},children:[y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[y.jsx("span",{style:{color:q.muted,textTransform:"uppercase",letterSpacing:"1px",fontSize:"12px",fontWeight:600},children:o}),y.jsx("span",{style:{color:q.text,fontFamily:"monospace",fontWeight:700,fontSize:"14px"},children:a})]}),y.jsx("div",{style:{height:"8px",background:q.stone,borderRadius:"4px",overflow:"hidden"},children:y.jsx("div",{style:{height:"100%",width:`${d}%`,background:c,borderRadius:"4px",transition:"width 0.4s ease"}})})]})}function Lp({archetype:o,side:a}){if(!o)return null;const i=a==="dungeon";return y.jsxs("div",{style:{padding:"16px 20px",background:`${q.stone}88`,border:`1px solid ${q.border}`,borderRadius:i?"12px":"4px"},children:[y.jsx("div",{style:{color:q.text,fontSize:"17px",fontWeight:700,textTransform:"uppercase",letterSpacing:"1px",marginBottom:"6px"},children:o.name}),y.jsx("div",{style:{color:q.muted,fontSize:"14px",lineHeight:1.5,fontStyle:"italic"},children:o.desc})]})}function Wp(o,a,i){return Math.max(a,Math.min(i,o))}function Vp({side:o,onConfirm:a,onBack:i}){const c=o==="dungeon",d=Object.keys(c?to:no),u=c?3:4,[f,g]=pe.useState([]),h=v=>{g(T=>T.includes(v)?T.filter(j=>j!==v):T.length>=u?T:[...T,v])},m=pe.useMemo(()=>c&&f.length===3?Gc(f):!c&&f.length===4?Uc(f):null,[f,c]),k=pe.useMemo(()=>c&&f.length===3?Ip(f):!c&&f.length===4?Fp(f):null,[f,c]),w=f.length===u;return y.jsxs("div",{style:{minHeight:"100vh",background:q.void,padding:"32px",display:"flex",flexDirection:"column",alignItems:"center"},children:[y.jsx("div",{style:{color:q.dim,fontSize:"14px",textTransform:"uppercase",letterSpacing:"4px",marginBottom:"10px"},children:c?"Build Your Dungeon":"Assemble Your Party"}),y.jsxs("div",{style:{color:q.muted,fontSize:"16px",marginBottom:"28px"},children:["Select ",u," ",c?"encounter rooms":"party members","  ",f.length,"/",u," chosen"]}),y.jsxs("div",{style:{display:"flex",gap:"28px",maxWidth:"1200px",width:"100%",flexWrap:"wrap",justifyContent:"center"},children:[y.jsx("div",{style:{flex:"1 1 650px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"14px"},children:d.map(v=>{const T=f.includes(v),j=c?to[v]:no[v],$=c?xa[v]:Ea[v],D=($==null?void 0:$.primary)||"#888";return y.jsxs("button",{onClick:()=>h(v),style:{background:T?`linear-gradient(135deg, ${D}20, ${q.deep})`:q.deep,border:`1px solid ${T?D:q.border}`,borderRadius:c?"12px":"4px",padding:"18px",cursor:"pointer",textAlign:"left",transition:"all 0.3s",boxShadow:T?`0 0 20px ${D}20`:"none",opacity:!T&&f.length>=u?.4:1},children:[y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[y.jsx("span",{style:{color:T?($==null?void 0:$.glow)||D:q.text,fontWeight:700,fontSize:"17px"},children:j.name}),c&&y.jsx("span",{style:{color:D,fontSize:"12px",fontWeight:600,padding:"3px 8px",background:`${D}20`,borderRadius:"3px"},children:$==null?void 0:$.winCon}),!c&&y.jsx("span",{style:{color:q.muted,fontSize:"13px",textTransform:"uppercase"},children:j.role})]}),c&&y.jsx("div",{style:{display:"flex",gap:"5px",marginBottom:"8px",flexWrap:"wrap"},children:j.tags.map(B=>y.jsx("span",{style:{fontSize:"11px",color:q.dim,background:`${q.surface}80`,padding:"2px 7px",borderRadius:"3px"},children:B},B))}),!c&&y.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"8px",fontSize:"14px"},children:[y.jsxs("span",{style:{color:et.Strike},children:["",j.vitality]}),y.jsxs("span",{style:{color:et.Test},children:["",j.resolveContribution]}),y.jsxs("span",{style:{color:et.React},children:["",j.nerveContribution]})]}),y.jsx("div",{style:{color:q.muted,fontSize:"13px",lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:c?j.description:`${j.party}  ${j.deck.length} cards`}),c&&y.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"10px",fontSize:"13px"},children:[y.jsxs("span",{style:{color:et.Counter},children:["STR +",j.contributions.structure]}),y.jsxs("span",{style:{color:et.Disrupt},children:["VEI +",j.contributions.veil]}),y.jsxs("span",{style:{color:et.React},children:["PRE +",j.contributions.presence]})]})]},v)})}),y.jsxs("div",{style:{flex:"0 0 320px",display:"flex",flexDirection:"column",gap:"18px"},children:[m&&c&&y.jsxs("div",{style:{background:q.deep,border:`1px solid ${q.border}`,borderRadius:"12px",padding:"20px"},children:[y.jsx("div",{style:{color:q.dim,fontSize:"12px",textTransform:"uppercase",letterSpacing:"2px",marginBottom:"14px"},children:"Dungeon Stats"}),y.jsx(Jr,{label:"Structure",value:m.structure,max:20,color:et.Counter}),y.jsx("div",{style:{height:8}}),y.jsx(Jr,{label:"Veil",value:m.veil,max:16,color:et.Disrupt}),y.jsx("div",{style:{height:8}}),y.jsx(Jr,{label:"Presence",value:m.presence,max:16,color:et.React})]}),m&&!c&&y.jsxs("div",{style:{background:q.deep,border:`1px solid ${q.border}`,borderRadius:"4px",padding:"20px"},children:[y.jsx("div",{style:{color:q.dim,fontSize:"12px",textTransform:"uppercase",letterSpacing:"2px",marginBottom:"14px"},children:"Party Stats"}),y.jsx(Jr,{label:"Resolve",value:m.resolve,max:28,color:et.Test}),y.jsx("div",{style:{height:8}}),y.jsx(Jr,{label:"Nerve",value:m.nerve,max:28,color:et.React}),y.jsx("div",{style:{height:10}}),y.jsx("div",{style:{fontSize:"14px",color:q.muted},children:Object.values(m.members).map(v=>y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"3px 0"},children:[y.jsx("span",{children:v.name}),y.jsxs("span",{style:{color:et.Strike},children:["",v.vitality]})]},v.name))})]}),k&&y.jsx(Lp,{archetype:k.archetype,side:o}),k&&y.jsxs("div",{style:{background:q.deep,border:`1px solid ${q.border}`,borderRadius:c?"12px":"4px",padding:"20px"},children:[y.jsx("div",{style:{color:q.dim,fontSize:"12px",textTransform:"uppercase",letterSpacing:"2px",marginBottom:"14px"},children:"Weight Profile"}),Object.entries(k.weights).filter(([,v])=>v>0).sort((v,T)=>T[1]-v[1]).map(([v,T])=>y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px"},children:[y.jsx("span",{style:{color:et[v]||q.muted,fontSize:"12px",width:"60px",textTransform:"uppercase",fontWeight:600},children:v}),y.jsx("div",{style:{flex:1,height:"6px",background:q.surface,borderRadius:"3px",overflow:"hidden"},children:y.jsx("div",{style:{width:`${Wp(T/4*100,0,100)}%`,height:"100%",background:et[v]||q.muted,borderRadius:"3px"}})}),y.jsx("span",{style:{color:q.dim,fontSize:"12px",width:"28px",textAlign:"right",fontFamily:"monospace"},children:T.toFixed(1)})]},v))]}),y.jsxs("div",{style:{display:"flex",gap:"10px"},children:[y.jsx("button",{onClick:i,style:{flex:1,padding:"12px",background:"transparent",border:`1px solid ${q.border}`,color:q.muted,borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:" Back"}),y.jsx("button",{onClick:()=>w&&a(f),disabled:!w,style:{flex:2,padding:"12px",background:w?c?"#4a7c3f":"#8a9bb0":q.surface,border:"none",color:w?"#fff":q.dim,borderRadius:c?"8px":"4px",cursor:w?"pointer":"default",fontSize:"15px",fontWeight:600,transition:"all 0.3s",opacity:w?1:.5},children:"Review Deck "})]})]})]})]})}function Hp({card:o,roomKey:a,memberKey:i,small:c}){var m,k;const d=et[o.category]||q.muted,u=a?(m=xa[a])==null?void 0:m.primary:i?(k=Ea[i])==null?void 0:k.primary:d,f={card:{background:q.deep,border:`1px solid ${d}`,borderRadius:a?"10px":"4px",padding:c?"10px 12px":"14px 16px",minWidth:c?"180px":"230px",maxWidth:c?"210px":"280px",transition:"transform 0.2s, box-shadow 0.2s",cursor:"default",position:"relative"},name:{color:q.text,fontSize:c?"14px":"16px",fontWeight:600,marginBottom:"5px",paddingRight:o.cost!==void 0?"28px":"0"},category:{color:d,fontSize:"12px",fontWeight:700,textTransform:"uppercase",letterSpacing:"0.5px"},type:{color:q.dim,fontSize:"12px",marginLeft:"6px"},desc:{color:q.muted,fontSize:c?"12px":"13px",lineHeight:1.5,marginTop:"8px"},cost:{position:"absolute",top:"8px",right:"8px",background:u,color:q.void,fontSize:"12px",fontWeight:700,width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},stats:{display:"flex",gap:"10px",marginTop:"8px",fontSize:"13px",fontFamily:"monospace"}},[g,h]=Lc.useState(!1);return y.jsxs("div",{style:{...f.card,transform:g?"translateY(-2px)":"none",boxShadow:g?`0 4px 12px ${d}33`:"none"},onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[o.cost!==void 0&&y.jsx("div",{style:f.cost,children:o.cost}),y.jsx("div",{style:f.name,children:o.name}),y.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[y.jsx("span",{style:f.category,children:o.category}),y.jsx("span",{style:f.type,children:o.type})]}),(o.power||o.target)&&!c&&y.jsxs("div",{style:f.stats,children:[o.power&&y.jsxs("span",{style:{color:d},children:[" ",o.power]}),o.target&&y.jsxs("span",{style:{color:q.muted},children:[" ",o.target]})]}),!c&&y.jsx("div",{style:f.desc,children:o.description})]})}function Gp({side:o,selected:a,onBack:i,onReady:c}){const d=o==="dungeon",[u,f]=pe.useState(0),g=pe.useMemo(()=>d?a.map(k=>({key:k,label:to[k].name,cards:to[k].deck})):a.map(k=>({key:k,label:no[k].name,cards:no[k].deck})),[a,d]),h=g[u],m=pe.useMemo(()=>{const k={};for(const w of h.cards)k[w.category]||(k[w.category]=[]),k[w.category].push(w);return k},[h]);return y.jsxs("div",{style:{minHeight:"100vh",background:q.void,padding:"32px",display:"flex",flexDirection:"column",alignItems:"center"},children:[y.jsxs("div",{style:{color:q.dim,fontSize:"14px",textTransform:"uppercase",letterSpacing:"4px",marginBottom:"20px"},children:["Deck Review  ",d?"Dungeon Rooms":"Party Members"]}),y.jsx("div",{style:{display:"flex",gap:"6px",marginBottom:"28px",flexWrap:"wrap",justifyContent:"center"},children:g.map((k,w)=>{const v=d?xa[k.key]:Ea[k.key],T=w===u;return y.jsxs("button",{onClick:()=>f(w),style:{padding:"10px 24px",background:T?`${v==null?void 0:v.primary}30`:"transparent",border:`1px solid ${T?v==null?void 0:v.primary:q.border}`,borderRadius:d?"8px":"3px",cursor:"pointer",color:T?(v==null?void 0:v.glow)||q.text:q.muted,fontSize:"14px",fontWeight:T?600:400,transition:"all 0.3s"},children:[k.label," ",y.jsxs("span",{style:{fontSize:"12px",opacity:.7},children:["(",k.cards.length,")"]})]},k.key)})}),y.jsx("div",{style:{maxWidth:"1200px",width:"100%"},children:Object.entries(m).map(([k,w])=>y.jsxs("div",{style:{marginBottom:"24px"},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[y.jsx("div",{style:{width:"14px",height:"14px",borderRadius:"3px",background:et[k]}}),y.jsx("span",{style:{color:et[k],fontSize:"15px",fontWeight:600,textTransform:"uppercase",letterSpacing:"1px"},children:k}),y.jsxs("span",{style:{color:q.dim,fontSize:"14px"},children:["(",w.length,")"]})]}),y.jsx("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:w.map((v,T)=>y.jsx(Hp,{card:v,roomKey:d?h.key:null,memberKey:d?null:h.key},T))})]},k))}),y.jsxs("div",{style:{display:"flex",gap:"14px",marginTop:"28px",padding:"18px 24px",background:q.deep,borderRadius:"8px",alignItems:"center",flexWrap:"wrap",justifyContent:"center"},children:[y.jsx("button",{onClick:i,style:{padding:"12px 24px",background:"transparent",border:`1px solid ${q.border}`,color:q.muted,borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:" Composition"}),y.jsxs("div",{style:{flex:1,textAlign:"center",color:q.dim,fontSize:"14px",minWidth:"140px"},children:[g.reduce((k,w)=>k+w.cards.length,0)," total cards across ",g.length," ",d?"rooms":"members"]}),y.jsx("button",{onClick:c,style:{padding:"12px 36px",background:"#3d998a",border:"1px solid #55c4b0",color:"#0a0a0f",borderRadius:d?"8px":"4px",cursor:"pointer",fontSize:"15px",fontWeight:600,transition:"all 0.2s"},children:d?"Defend Your Realm ":"Enter the Dungeon "})]})]})}function Rn(){return Math.floor(Math.random()*6)+1}function pa(o=0){if(o>0){const i=[Rn(),Rn(),Rn()].sort((c,d)=>d-c);return{dice:i,kept:[i[0],i[1]],total:i[0]+i[1]}}else if(o<0){const i=[Rn(),Rn(),Rn()].sort((c,d)=>c-d);return{dice:i,kept:[i[0],i[1]],total:i[0]+i[1]}}const a=[Rn(),Rn()];return{dice:a,kept:a,total:a[0]+a[1]}}function Up(o,a){const i=o-a;return i>=5?{tier:"Devastating",atkMult:1.5,defMult:0}:i>=2?{tier:"Strong",atkMult:1,defMult:0}:i>=-2?{tier:"Partial",atkMult:.5,defMult:.5}:i>=-4?{tier:"Stalemate",atkMult:0,defMult:1}:{tier:"Reversal",atkMult:0,defMult:1.5}}function Qp(o){return{vitality:o.vitality,resolve:o.resolve,nerve:o.nerve,trust:o.trust||0,modifiers:{...o.modifiers||{}},side:"visitor",emotionalState:"neutral",conditions:[],startingValues:{vitality:o.vitality,resolve:o.resolve,nerve:o.nerve,trust:o.trust||0}}}function Kp(o){const a={};for(const[c,d]of Object.entries(o.members))a[c]={vitality:d.vitality,maxVitality:d.vitality,status:"active",name:d.name,role:d.role,resolveContribution:d.resolveContribution||0,nerveContribution:d.nerveContribution||0};const i=Object.values(a).reduce((c,d)=>c+d.vitality,0);return{vitality:i,resolve:o.resolve,nerve:o.nerve,trust:o.trust||0,isParty:!0,members:a,knockoutCount:0,killThreshold:o.killThreshold||2,knockoutMorale:o.knockoutMorale||[{resolveHit:3,nerveHit:3},{resolveHit:6,nerveHit:6}],partySize:o.partySize||Object.keys(o.members).length,modifiers:{...o.modifiers||{}},side:"visitor",emotionalState:"neutral",conditions:[],startingValues:{vitality:i,resolve:o.resolve,nerve:o.nerve,trust:o.trust||0}}}function qp(o){return{structure:o.structure,veil:o.veil,presence:o.presence,rapport:o.rapport||0,modifiers:{...o.modifiers||{}},side:"dungeon",conditions:[],startingValues:{structure:o.structure,veil:o.veil,presence:o.presence,rapport:o.rapport||0}}}function ca(o,a,i={}){if(i.bondThreshold,o.isParty){if(o.knockoutCount>=o.killThreshold)return{winner:"dungeon",condition:"Kill",desc:`${o.knockoutCount} party members eliminated`}}else if(o.vitality<=0)return{winner:"dungeon",condition:"Kill",desc:"Vitality depleted"};return o.resolve<=0?{winner:"dungeon",condition:"Break",desc:"Resolve shattered"}:o.nerve<=0?{winner:"dungeon",condition:"Panic",desc:"Nerve broken"}:a.structure<=0?{winner:"visitor",condition:"Overcome",desc:"Structure breached"}:a.veil<=0?{winner:"visitor",condition:"Inert",desc:"Veil depleted"}:a.presence<=0?{winner:"visitor",condition:"Dominate",desc:"Presence overwhelmed"}:null}function kc(o=2){return{base:o,spent:0,tempBonus:0,get available(){return this.base+this.tempBonus-this.spent},canAfford(a){return this.available>=a},spend(a){return this.canAfford(a)?(this.spent+=a,!0):!1},addPermanent(a){this.base+=a},addTemp(a){this.tempBonus+=a},refresh(){this.spent=0,this.tempBonus=0}}}function Oe(o,a,i,c){let d=Math.floor(i*c);return c>0&&i>0&&d<1&&(d=1),d<=0?0:(o[a]!==void 0&&(o[a]=Math.max(0,o[a]-d)),d)}function Dt(o,a,i){if(o[a]===void 0)return 0;const c=o[a];return o[a]+=i,o.startingValues&&o.startingValues[a]!==void 0&&a!=="trust"&&a!=="rapport"&&(o[a]=Math.min(o[a],o.startingValues[a])),o[a]-c}function ga(o,a,i){const c=o.members[a];if(!c||c.status!=="active")return{damaged:0,knockout:!1};const d=c.vitality;c.vitality=Math.max(0,c.vitality-i);const u=d-c.vitality;o.vitality=Object.values(o.members).filter(g=>g.status==="active").reduce((g,h)=>g+h.vitality,0);const f={damaged:u,knockout:!1,memberKey:a};if(c.vitality<=0&&d>0){c.status="knocked_out",o.knockoutCount++,f.knockout=!0;const g=Math.min(o.knockoutCount-1,o.knockoutMorale.length-1),h=o.knockoutMorale[g];if(h){const m=Math.min(h.resolveHit,o.resolve),k=Math.min(h.nerveHit,o.nerve);o.resolve=Math.max(0,o.resolve-h.resolveHit),o.nerve=Math.max(0,o.nerve-h.nerveHit),f.moraleCascade={resolveHit:m,nerveHit:k}}}return f}function Yp(o,a,i){const c=o.members[a];return!c||c.status!=="knocked_out"?{restored:!1}:(c.status="active",c.vitality=Math.min(i,c.maxVitality),o.knockoutCount=Math.max(0,o.knockoutCount-1),o.vitality=Object.values(o.members).filter(d=>d.status==="active").reduce((d,u)=>d+u.vitality,0),{restored:!0,memberKey:a,vitality:c.vitality})}function Qc(o,a,i,c){const d={removed:[],from:{hand:0,draw:0,discard:0}},u=(m,k)=>{const w=[];for(const v of m)v.member===o?(d.removed.push(v.name),d.from[k]++):w.push(v);return w},f=u(a,"hand"),g=u(i,"draw");i.length=0,i.push(...g);const h=u(c,"discard");return c.length=0,c.push(...h),{newHand:f,...d}}function Xp(o,a,i){const c=a.filter(d=>d.member===o);return i.push(...c),c.map(d=>d.name)}function ha(o,a="lowest_vitality"){var c;const i=Object.entries(o.members).filter(([d,u])=>u.status==="active").map(([d,u])=>({key:d,...u}));if(i.length===0)return null;if(i.length===1)return i[0].key;switch(a){case"lowest_vitality":return i.sort((d,u)=>d.vitality-u.vitality)[0].key;case"highest_vitality":return i.sort((d,u)=>u.vitality-d.vitality)[0].key;case"random":return i[Math.floor(Math.random()*i.length)].key;default:return((c=o.members[a])==null?void 0:c.status)==="active"?a:i.sort((d,u)=>d.vitality-u.vitality)[0].key}}const Zp={Physical:"dominion",Environmental:"resonance",Social:"presence_attr",Mystical:"memory"},Jp={Physical:"strength",Environmental:"resilience",Social:"cunning",Mystical:"perception"},eg={Physical:["vitality","structure"],Environmental:["vitality","structure","nerve"],Social:["resolve","trust","presence","rapport"],Mystical:["veil","nerve","resolve"]};function ya(o,a){if(!o||!o.type)return 0;const c=(a.side==="dungeon"?Zp:Jp)[o.type],d=(a.modifiers||{})[c]||0;return(eg[o.type]||[]).includes(o.target)?d:Math.floor(d/2)}function gr(o,a){return o.conditions.some(i=>i.type===a)}function yi(o,a,i){const c=o.conditions.findIndex(d=>d.type===a&&d.placedBy===i);return c<0?null:o.conditions.splice(c,1)[0]}function Sc(o,a,i){const c=[];for(const d of o.conditions)if(d.type==="erode")if(d.resource!==a){const u=Oe(o,d.resource,d.amount,1);i(`    [Erode] ${d.resource} -${u}`)}else i(`    [Erode] ${d.resource} SUPPRESSED (auto-effect match)`);else c.push(d);o.conditions=c}function Kc(o,a,i,c){const d=o.keywords||[],u=c.log||(()=>{}),f=c.activeSide;for(const g of d)switch(g){case"Entangle":gr(a,"entangled")||(a.conditions.push({type:"entangled",placedBy:f}),u("    [KW] Entangle applied"));break;case"Erode":c.autoResource!==o.target?(a.conditions.push({type:"erode",resource:o.target,amount:1,placedBy:f}),u(`    [KW] Erode: ${o.target} -1 next round`)):u("    [KW] Erode SUPPRESSED (matches auto-effect)");break;case"Drain":u("    [KW] Drain: resource conversion");break;case"Insight":u("    [KW] Insight: info revealed");break;case"Ward":a.conditions.push({type:"ward",duration:1,placedBy:f}),u("    [KW] Ward applied");break}}function tg(o,a={}){const i=a.escalationStart||8,c=a.escalationRate||1;return o<i?null:{damage:c+Math.floor((o-i)/2)}}function ma(o){const a=[...o];for(let i=a.length-1;i>0;i--){const c=Math.floor(Math.random()*(i+1));[a[i],a[c]]=[a[c],a[i]]}return a}function xc(o,a=7,i=3){for(let d=0;d<=i;d++){const u=ma(o),f=u.slice(0,a),g=u.slice(a);if(f.filter(h=>h.category==="Energy").length>=2&&f.filter(h=>h.category!=="Energy").length>=3)return{hand:f,drawPile:g,mulligans:d}}const c=ma(o);return{hand:c.slice(0,a),drawPile:c.slice(a),mulligans:i}}function Ec(o,a,i){const c=[];for(let d=0;d<i;d++){if(o.length===0){if(a.length===0)break;o.push(...ma(a.splice(0)))}c.push(o.shift())}return c}function ki(o,a,i){if(!o||!o.condition)return!1;const c=o.condition,d=o.target==="opponent"?i:a;switch(c.type){case"has_condition":return gr(d,c.condition);case"resource_below":{const u=d[c.resource]||0,f=(d.startingValues||{})[c.resource]||20;return u/f<(c.pct||.5)}case"resource_above":{const u=d[c.resource]||0,f=c.threshold||0;return u>f}default:return!1}}function ng(o,a,i,c){var u,f,g;const d=o.energyType||"standard";switch(d){case"standard":{const h=o.energyGain||1;return a.addPermanent(h),{type:"standard",poolAfter:a.base,description:`+${h} permanent  pool ${a.base}`}}case"surge":{const h=o.surgeGain||2;return a.addTemp(h),{type:"surge",poolAfter:a.base,tempGain:h,description:`+${h} temp  available ${a.available} (pool ${a.base})`}}case"attune":{const h=o.energyGain||1;return a.addPermanent(h),o.attune&&((i.conditions||[]).find(k=>k.type==="attune"&&k.cardType===o.attune.cardType)||(i.conditions=i.conditions||[],i.conditions.push({type:"attune",cardType:o.attune.cardType,discount:o.attune.discount||1,source:o.name,duration:99}))),{type:"attune",poolAfter:a.base,attuneType:(u=o.attune)==null?void 0:u.cardType,description:`+${h} permanent  pool ${a.base}. Next ${((f=o.attune)==null?void 0:f.cardType)||"?"} card costs ${((g=o.attune)==null?void 0:g.discount)||1} less.`}}case"siphon":if(ki(o.siphon,i,c)){const m=o.energyGain||1;return a.addPermanent(m),{type:"siphon",conditionMet:!0,poolAfter:a.base,description:`Siphon condition met! +${m} permanent  pool ${a.base}`}}else{const m=o.siphonFallback||1;return a.addTemp(m),{type:"siphon",conditionMet:!1,poolAfter:a.base,tempGain:m,description:`Siphon condition not met. +${m} temp  available ${a.available}`}}default:return a.addPermanent(1),{type:"unknown",poolAfter:a.base,description:`Unknown energy type "${d}", defaulted to +1 permanent`}}}function rg(o,a){if(!o.type||!a.conditions)return 0;const i=a.conditions.findIndex(d=>d.type==="attune"&&d.cardType===o.type);if(i===-1)return 0;const c=a.conditions[i];return a.conditions.splice(i,1),c.discount||1}function ba(o){return o>=7?3:o>=5?2:o>=3?1:0}function og(o){return["Strangers","Familiar","Entrusted","Covenant"][o]||"Unknown"}function ig(o,a,i,c,d){var F,ie,ge;const u=d.log,f=a==="dungeon"?c:i,g=a==="dungeon"?i:c,h=f.trust||0,m=ba(h);if((F=c.conditions)==null?void 0:F.find(oe=>oe.type==="betrayed"))return u(`  [${a}] Offer: ${o.name}  AUTO-REFUSED (Betrayed condition active)`),mi(f,u),{accepted:!1,bond:!1};if(!o.offer)return vg(o,a,i,c,d);const w=o.offer,v=o.subtype==="Covenant"||o.bondTrigger;if(v&&m<3)return u(`  [${a}] Covenant: ${o.name}  INELIGIBLE (trust ${h}, need 9+)`),{accepted:!1,bond:!1};let T,j;if(m>=2&&!v?(T=!0,j=1,u(`  [${a}] Offer: ${o.name}  BINDING (trust:${h}, tier:${m} ${og(m)})`)):v?(j=lg(h,f,g,d),T=Math.random()<j,u(`  [${a}] Covenant: ${o.name}  ${T?"ACCEPTED":"REFUSED"} (trust:${h}, chance:${(j*100).toFixed(0)}%)`)):m===1?(j=ag(w.benefit,h,f),T=Math.random()<j,u(`  [${a}] Offer: ${o.name}  ${T?"ACCEPTED":"REFUSED"} (trust:${h}, tier:1 Veiled, chance:${(j*100).toFixed(0)}%)`)):(j=sg(w,h,f),T=Math.random()<j,u(`  [${a}] Offer: ${o.name}  ${T?"ACCEPTED":"REFUSED"} (trust:${h}, tier:0 Transparent, chance:${(j*100).toFixed(0)}%)`)),!T){if(mi(f,u),v){const oe=Math.ceil(h*.5);f.trust=Math.max(0,f.trust-oe),u(`    [Covenant Refused] trust crashes -${oe}`)}return{accepted:!1,bond:!1}}const $=a==="dungeon"?c:i;cg(w.benefit,$,d);const D=a==="dungeon"?c:i;if(w.cost&&dg(w.cost,D,d),(ie=w.investment)!=null&&ie.trust){const oe=va(f,w.investment.trust,d);u(`    Investment: trust +${oe}`)}const B=((ge=i.conditions)==null?void 0:ge.filter(oe=>oe.type==="trap"&&oe.trigger==="offer_accepted"))||[];for(const oe of B)if(u(`    TRAP SPRINGS: ${oe.card.name}`),i.conditions=i.conditions.filter(K=>K!==oe),oe.card.trapEffect){const K=Array.isArray(oe.card.trapEffect)?oe.card.trapEffect:[oe.card.trapEffect];for(const Z of K){if(Z.applyEntangle&&(c.conditions.push({type:"entangled",placedBy:a,source:oe.card.name}),u("       Entangle applied")),Z.damage){const he=Oe(c,Z.damage.resource,Z.damage.amount,1);u(`       ${Z.damage.resource} -${he}`)}if(Z.resource){const he=Z.target==="triggerer"?c:i,De=Oe(he,Z.resource,Math.abs(Z.amount),1);u(`       ${Z.resource} -${De}`)}}}return v&&T?(u("     COVENANT ACCEPTED  Bond triggered!"),{accepted:!0,bond:!0}):{accepted:!0,bond:!1}}function sg(o,a,i){const c=qc(o.benefit,i),d=o.cost?ug(o.cost):0,u=c-d,f=Ta(i),g=Math.max(0,2-3*f),h=u>g?.5+u*.1+a*.05:.15+a*.05;return Math.min(.9,Math.max(.1,h))}function ag(o,a,i){const c=qc(o,i),d=.3+a*.08,u=Ta(i),f=Math.max(.8,1.5-u*2),g=c*d>f?.4+a*.06+u*.2:.2+a*.04;return Math.min(.85,Math.max(.15,g))}function lg(o,a,i,c){var m;const d=.5+o*.06,f=1+.3*Ta(a),h=(((m=c.stats)==null?void 0:m.dStrikesPlayed)||0)>0?.7:1;return Math.min(.95,Math.max(.3,d*f*h))}function qc(o,a){var g;if(!o)return 0;if(o.type==="full_restore")return 6;const i=o.amount||0,c=a[o.resource]||0,d=((g=a.startingValues)==null?void 0:g[o.resource])||16,u=c/d,f=u<.2?3:u<.4?2:u<.6?1.3:1;return i*f}function ug(o){if(!o)return 0;switch(o.type){case"flat":return o.amount||0;case"binding":return(o.amount||1)*(o.duration||1)*1.2;case"exposure":return(o.amount||2)*.6;case"extraction":return 2;case"dependency":return(o.amount||2)*.8;default:return o.amount||1}}function Ta(o){const a=["vitality","resolve","nerve"],i=o.startingValues||{};let c=0,d=0;for(const u of a)o[u]!==void 0&&i[u]&&(d++,o[u]/i[u]<.4&&c++);if(o.isParty&&o.members){let u=0,f=0;for(const g of Object.values(o.members))g.status==="active"&&(u+=g.vitality,f+=g.maxVitality||g.vitality);f>0&&u/f<.4&&c++,d++}return d>0?c/d:0}function cg(o,a,i){const c=i.log;if(o)if(o.type==="full_restore"){const d=a.isParty?["resolve","nerve"]:["vitality","resolve","nerve"],u=a.startingValues||{};let f=null,g=1;for(const h of d)if(a[h]!==void 0&&u[h]){const m=a[h]/u[h];m<g&&(g=m,f=h)}if(f){const h=u[f]-a[f];Dt(a,f,h),c(`    Benefit: ${f} fully restored (+${h})`)}}else o.resource&&o.amount&&(Dt(a,o.resource,o.amount),c(`    Benefit: ${o.resource} +${o.amount}`))}function dg(o,a,i){const c=i.log;if(o)switch(o.type){case"flat":{const d=Oe(a,o.resource,o.amount,1);c(`    Cost: ${o.resource} -${d} (flat)`);break}case"binding":{a.conditions=a.conditions||[],a.conditions.push({type:"binding",resource:o.resource,amount:o.amount||1,duration:o.duration||2,source:"Offer cost",placedBy:"dungeon"}),c(`    Cost: Binding ${o.resource} -${o.amount||1}/round for ${o.duration||2} rounds`);break}case"exposure":{a.conditions=a.conditions||[],a.conditions.push({type:"exposure",strikeType:o.strikeType||null,bonusDamage:o.amount||2,duration:o.duration||1,source:"Offer cost",placedBy:"dungeon"}),c(`    Cost: Exposure  next ${o.strikeType||"any"} Strike deals +${o.amount||2}`);break}case"extraction":{c(`    Cost: Extraction  ${o.effect||"dungeon gains permanent benefit"}`),i.extractions=i.extractions||[],i.extractions.push(o.effect);break}case"dependency":{a.conditions=a.conditions||[];const d=a.trust||0;a.conditions.push({type:"dependency",resource:o.resource,reversalAmount:o.amount||0,trustFloor:d,source:"Offer cost",placedBy:"dungeon"}),c(`    Cost: Dependency  lose ${o.amount} ${o.resource} if trust drops below ${d}`);break}default:if(o.resource&&o.amount){const d=Oe(a,o.resource,o.amount,1);c(`    Cost: ${o.resource} -${d}`)}}}function va(o,a,i){const c=i.promoterGainCap||2,d=i.roundStartTrust||0,f=(o.trust||0)-d,g=Math.max(0,c-f),h=Math.min(a,g);return h>0&&(o.trust=(o.trust||0)+h),h}function mi(o,a){o._fractionalTrust=(o._fractionalTrust||0)+.5,o._fractionalTrust>=1?(o._fractionalTrust-=1,o.trust=(o.trust||0)+1,a("    [Refusal] trust +1 (accumulated from refused Offers)")):a("    [Refusal] trust +0.5 (pending)")}function fg(o,a,i,c){if(o!=="dungeon")return;const d=c.log,u=i,f=u.trust||0;if(f<=0)return;const g=f>=6?2:1,h=Math.max(0,f-g),m=f-h;u.trust=h,d(`    [Trust Decay] trust -${m} (dungeon Strike while trust ${f})`)}function pg(o,a,i,c){const d=c.log,u=o==="dungeon"?i:a,f=o==="dungeon"?a:i,g=u.trust||0;if(o==="dungeon"&&g<4)return{betrayed:!1,damage:0};if(o!=="dungeon"&&g<=0)return{betrayed:!1,damage:0};if(o==="dungeon"){const h=g,m=u.startingValues||{},k=u.isParty?[{name:"resolve",val:u.resolve,start:m.resolve||14},{name:"nerve",val:u.nerve,start:m.nerve||16}]:[{name:"vitality",val:u.vitality,start:m.vitality||20},{name:"resolve",val:u.resolve,start:m.resolve||16},{name:"nerve",val:u.nerve,start:m.nerve||16}];k.sort((T,j)=>T.val/T.start-j.val/j.start);const w=k[0],v=Oe(u,w.name,h,1);return d(`     BETRAYAL! Trust ${g} converts to ${v} ${w.name} damage`),u.trust=0,u._fractionalTrust=0,d("    [Betrayal] trust reset to 0"),u.conditions=u.conditions||[],u.conditions.push({type:"betrayed",powerBonus:2,duration:3,source:"Betrayal",placedBy:o}),d("    [Betrayed] visitor gains +2 Strike power for 3 rounds, auto-refuses all Offers"),{betrayed:!0,damage:v}}else{const h=g>=7?3:g>=4?2:1,m=Math.max(0,g-h),k=g-m;return u.trust=m,d(`    [Visitor Strike] trust -${k} (was ${g}, now ${m})`),g>=6&&(f.conditions=f.conditions||[],f.conditions.push({type:"scorned",rollBonus:1,duration:3,source:"Visitor Betrayal",placedBy:o}),d("    [Scorned] dungeon gains +1 contested rolls for 3 rounds")),{betrayed:k>0,damage:0}}}function bc(o,a){const i=a.log,c=(o.conditions||[]).filter(d=>d.type==="binding");for(const d of c){const u=Oe(o,d.resource,d.amount,1);i(`    [Binding] ${d.resource} -${u} (${d.duration-1} rounds remaining)`),d.duration--}o.conditions=(o.conditions||[]).filter(d=>d.type!=="binding"||d.duration>0)}function gg(o,a){const i=a.log,c=o.trust||0,d=(o.conditions||[]).filter(u=>u.type==="dependency");for(const u of d)if(c<u.trustFloor){const f=Oe(o,u.resource,u.reversalAmount,1);i(`    [Dependency] trust dropped below ${u.trustFloor}! ${u.resource} -${f}`),o.conditions=o.conditions.filter(g=>g!==u)}}function hg(o){const a=(o.conditions||[]).find(i=>i.type==="betrayed");return a&&a.powerBonus||0}function yg(o){const a=(o.conditions||[]).find(i=>i.type==="scorned");return a&&a.rollBonus||0}function Tc(o){if(o.conditions){for(const a of o.conditions)(a.type==="betrayed"||a.type==="scorned")&&a.duration--;o.conditions=o.conditions.filter(a=>!((a.type==="betrayed"||a.type==="scorned")&&a.duration<=0))}}function mg(o,a){if(!o.conditions)return 0;const i=o.conditions.find(c=>c.type==="exposure"&&(!c.strikeType||c.strikeType===a.type));return i?(o.conditions=o.conditions.filter(c=>c!==i),i.bonusDamage||0):0}function vg(o,a,i,c,d){var j,$;const u=d.log,f=a==="dungeon"?c:i,g=f.trust||0,h=ba(g);let m;if(h>=2?m=1:h===1?m=Math.min(.8,.35+g*.08):m=Math.min(.9,.3+g*.1),(j=c.conditions)==null?void 0:j.find(D=>D.type==="betrayed"))return u(`  [${a}] Offer: ${o.name}  AUTO-REFUSED (Betrayed)`),mi(f,u),{accepted:!1,bond:!1};const w=Math.random()<m,v=h>=2?"Binding":h===1?"Veiled":"Transparent";if(u(`  [${a}] Offer: ${o.name}  ${w?"ACCEPTED":"REFUSED"} (trust:${g}, tier:${h} ${v}, chance:${(m*100).toFixed(0)}%)`),!w)return mi(f,u),{accepted:!1,bond:!1};if(o.offerPayload){const D=Array.isArray(o.offerPayload)?o.offerPayload:[o.offerPayload];for(const B of D)if(B.heal)Dt(c,B.heal.resource,B.heal.amount),u(`    Payload: ${B.heal.resource} +${B.heal.amount}`);else if(B.resource){const F=B.target==="opponent"?c:i;if(B.amount>0)if(B.resource==="trust"||B.resource==="rapport"){const ie=va(F,B.amount,d);u(`    Payload: ${B.resource} +${ie}${ie<B.amount?" (capped)":""}`)}else Dt(F,B.resource,B.amount),u(`    Payload: ${B.resource} +${B.amount}`);else Oe(F,B.resource,Math.abs(B.amount),1),u(`    Payload: ${B.resource} ${B.amount}`)}}if(o.offerTrustGain){const D=va(f,o.offerTrustGain,d);u(`     trust +${D}`)}if(o.offerRapportGain){const D=a==="dungeon"?i:c;D.rapport=(D.rapport||0)+o.offerRapportGain,u(`     rapport +${o.offerRapportGain} (legacy)`)}const T=(($=i.conditions)==null?void 0:$.filter(D=>D.type==="trap"&&D.trigger==="offer_accepted"))||[];for(const D of T)if(u(`    TRAP SPRINGS: ${D.card.name}`),i.conditions=i.conditions.filter(B=>B!==D),D.card.trapEffect){const B=Array.isArray(D.card.trapEffect)?D.card.trapEffect:[D.card.trapEffect];for(const F of B){if(F.applyEntangle&&(c.conditions.push({type:"entangled",placedBy:a,source:D.card.name}),u("       Entangle applied")),F.damage){const ie=Oe(c,F.damage.resource,F.damage.amount,1);u(`       ${F.damage.resource} -${ie}`)}if(F.resource){const ie=F.target==="triggerer"?c:i;Oe(ie,F.resource,Math.abs(F.amount),1),u(`       ${F.resource} -${Math.abs(F.amount)}`)}}}return{accepted:!0,bond:!1}}function vi(o,a,i,c){if(a!=="trust"&&a!=="rapport")return Dt(o,a,i),i;const d=c.promoterGainCap||2,u=a==="trust"?c.roundStartTrust||0:c.roundStartRapport||0,g=(o[a]||0)-u,h=Math.max(0,d-g),m=Math.min(i,h);return m>0&&Dt(o,a,m),m}function wg(o,a,i){const c=gr(o,"entangled");o.conditions=o.conditions.filter(d=>d.type!=="entangled"),c&&i(`  [${a}] Entangle expires`)}function kg(o,a,i,c,d){var h;const u=d.log,f=o.disruptEffect.guard;u(`  [${a}] Disrupt: ${o.name} (Guardian Stance)`);let g=null;if(f.target==="lowest_vitality_ally"&&i.isParty){const m=Object.entries(i.members).filter(([k,w])=>w.status==="active"&&k!==o.member).sort(([k,w],[v,T])=>w.vitality-T.vitality);m.length>0&&(g=m[0][0])}else f.target==="specific"&&f.memberKey&&(g=f.memberKey);if(g&&i.isParty){const m=i.members[g];i.conditions=i.conditions.filter(k=>k.type!=="guarded"),i.conditions.push({type:"guarded",memberKey:g,powerReduction:f.powerReduction||2,duration:f.duration||2,source:o.name,placedBy:a,fresh:!0}),u(`    [Guard] ${m.name} is now Guarded (-${f.powerReduction||2}P to Strikes targeting them) for ${f.duration||2} rounds`)}else u("    [Guard] No valid target for Guardian Stance");if(o.disruptEffect.selfFortify){const m=o.disruptEffect.selfFortify;i.conditions.push({type:"fortify",resource:"vitality",reduction:m.reduction||1,duration:m.duration||1,source:o.name,placedBy:a,fresh:!0}),u(`    [Guard] ${o.member&&((h=i.members[o.member])==null?void 0:h.name)||a} gains Fortify ${m.reduction||1}`)}}function Cc(o,a,i,c,d){const u=d.log,f=o.counterEffect.spreadFortify;let g=!1;if(f.condition==="self_has_fortify"?g=i.conditions.some(h=>h.type==="fortify"):g=!0,g&&i.isParty){let h="ally";if(f.target==="lowest_vitality_ally"){const m=Object.entries(i.members).filter(([k,w])=>w.status==="active"&&k!==o.member).sort(([k,w],[v,T])=>w.vitality-T.vitality);m.length>0&&(h=m[0][1].name)}i.conditions.push({type:"fortify",resource:f.resource||"vitality",reduction:f.reduction||1,duration:f.duration||1,source:`${o.name} (spread)`,placedBy:a,fresh:!0}),u(`    [Spread] Fortify ${f.reduction||1} spreads to ${h} (${o.name})`)}else g&&!i.isParty&&(i.conditions.push({type:"fortify",resource:f.resource||"vitality",reduction:f.reduction||1,duration:f.duration||1,source:`${o.name} (spread)`,placedBy:a,fresh:!0}),u(`    [Spread] Fortify ${f.reduction||1} applied (${o.name})`))}function Sg(o,a,i,c,d,u,f){var we,ze,Be,A,V,H,Q;const g=u.log,h=a==="dungeon"?"visitor":"dungeon";let m=0,k=0,w=[];const v=yi(i,"empower",a);if(v){if(v.effect.advantage&&(m+=1),v.effect.powerBonus&&(k+=v.effect.powerBonus),v.effect.addKeyword){const z=Array.isArray(v.effect.addKeyword)?v.effect.addKeyword:[v.effect.addKeyword];w.push(...z)}if(v.effect.retarget&&o.target&&(g(`    Empower redirect: ${o.target}  ${v.effect.retarget}`),o={...o,target:v.effect.retarget}),v.effect.conditionalAdvantage){const z=v.effect.conditionalAdvantage;z.hasCondition&&gr(c,z.hasCondition)&&(m+=1,g(`    Empower conditional: +Advantage (opponent ${z.hasCondition})`))}}k+=hg(i);const T=yi(i,"disrupt",h);if(T){if(T.effect.disadvantage&&(m-=1),T.effect.onStrike){const z=T.effect.onStrike;if(z.selfDamage){const b=Oe(i,z.selfDamage.resource,z.selfDamage.amount,1);g(`    Disrupt penalty: ${a} ${z.selfDamage.resource} -${b} (${T.source})`)}}if(T.effect.stripKeywords&&(w=[],o={...o,keywords:[]},g(`    Disrupt strips all keywords (${T.source})`)),T.effect.randomizeTarget&&o.target){const z=a==="dungeon"?["vitality","resolve","nerve"]:["structure","veil","presence"],b=z[Math.floor(Math.random()*z.length)];g(`    Disrupt randomize: ${o.target}  ${b} (${T.source})`),o={...o,target:b}}}const j=a==="dungeon"?u.stats.dLastType:u.stats.vLastType,$=[...o.keywords||[],...w];let D=0;$.includes("Resonate")&&j===o.type&&(D=1,g(`    Resonate: +1P (matching ${o.type} type)`));let B=0;o.trigger&&Cg(o.trigger,i,c,u)&&(B=_g(o.trigger,i,c,u),g(`    Trigger: ${o.trigger.description}  +${B}P`));const F=pa(m),ie=ya(o,i),ge=F.total+ie+D,oe=m>0?`3d6kh2[${F.dice}][${F.kept}]`:m<0?`3d6kl2[${F.dice}][${F.kept}]`:`2d6[${F.kept}]`,K=pa(0),Z=ya(o,c),he=yg(c),De=K.total+Z+he,ve=Up(ge,De),Se=(o.power||0)+k+B;g(`  [${a}] Strike: ${o.name} (P:${o.power}${k?`+${k}e`:""}${B?`+${B}t`:""} = ${Se} dmg) | Roll: ${oe}+${ie}mod = ${ge} vs 2d6[${K.kept}]+${Z}mod${he?`+${he}scorned`:""} = ${De}  ${ve.tier}`);let Te=0;if(ve.atkMult>0&&u.opponentReactHand){const z=xg(h,u.opponentReactHand,c,i,o,ve,u);if(z){Te=z.mitigation;const b=u.opponentReactHand.indexOf(z.card);b>=0&&u.opponentReactHand.splice(b,1),h==="dungeon"?u.stats.dCardsPlayed++:u.stats.vCardsPlayed++,u.stats.decisions++}}if(ve.atkMult>0&&o.target){let z=Math.floor(Se*ve.atkMult);Se>0&&z<1&&(z=1);const b=mg(c,o);b>0&&(z+=b,g(`    [Exposure] +${b} bonus damage`));let M=0;const P=c.conditions.filter(de=>de.type==="fortify"&&de.resource===o.target);for(const de of P)M+=de.reduction;let O=0;if(o.selfCost){const de=Oe(i,o.selfCost.resource,o.selfCost.amount,1);g(`    Self-cost: ${o.selfCost.resource} -${de}`)}let ue;if(c.isParty&&o.target==="vitality"){const de=u.memberTargetStrategy||"lowest_vitality",G=ha(c,de);if(G){const te=c.conditions.find(Qe=>Qe.type==="guarded"&&Qe.memberKey===G);te&&(O=te.powerReduction||0,(we=c.members[G])!=null&&we.name);const se=Math.max(0,z-Te-M-O),ye=ga(c,G,se);ue=ye.damaged;const Ce=c.members[G].name,it=[];Te>0&&it.push(`${Te} React`),M>0&&it.push(`${M} Fortify`),O>0&&it.push(`${O} Guard`);const Vt=it.length>0?` (${z} raw - ${it.join(" - ")})`:"";if(g(`     ${Ce} vitality -${ue}${Vt} [${ve.tier}: ${Se}${ve.atkMult}=${z}]`),ye.knockout){ye.moraleCascade,g(`    >>> ${Ce} KNOCKED OUT!`),ye.moraleCascade&&g(`    [Morale] Resolve -${ye.moraleCascade.resolveHit}, Nerve -${ye.moraleCascade.nerveHit}`);const Qe=Qc(G,u.sides.visitor.hand,u.vPile,u.vDiscard);u.sides.visitor.hand=Qe.newHand,g(`    [Deck] Removed ${Qe.removed.length} cards (hand:${Qe.from.hand} draw:${Qe.from.draw} discard:${Qe.from.discard})`),Qe.removed.length>0&&g(`    [Deck] Removed: ${Qe.removed.join(", ")}`),g(`    [Party] ${c.knockoutCount}/${c.killThreshold} knockouts toward Kill`),c.conditions=c.conditions.filter($t=>$t.type==="guarded"&&$t.memberKey===G?(g(`    [Guard] ${$t.source} expires (${Ce} knocked out)`),!1):!0)}}else ue=0}else{const de=Math.max(0,z-Te-M);ue=Oe(c,o.target,de,1);const G=[];Te>0&&G.push(`${Te} React`),M>0&&G.push(`${M} Fortify`);const te=G.length>0?` (${z} raw - ${G.join(" - ")})`:"";g(`     ${o.target} -${ue}${te} [${ve.tier}: ${Se}${ve.atkMult}=${z}]`)}const ce=a==="dungeon"?u.stats.dDamageDealt:u.stats.vDamageDealt;if(ce[o.target]=(ce[o.target]||0)+ue,ue>0){const de={...o,keywords:$};if(Kc(de,c,i,{autoResource:u.autoResource,log:g,activeSide:a}),$.includes("Drain")){const G=o.drainTarget||(a==="dungeon"?"presence":"vitality"),te=Math.min(ue,2);Dt(i,G,te),g(`    [KW] Drain: ${a} ${G} +${te}`)}if($.includes("Overwhelm")&&c[o.target]<=0){const G=o.overwhelmTarget||(o.target==="vitality"||o.target==="nerve"?"resolve":"nerve"),te=Math.abs(c[o.target]);if(te>0){const se=Oe(c,G,te,1);g(`    [KW] Overwhelm: excess spills  ${G} -${se}`)}}if(ve.atkMult>=1){const te=(a==="dungeon"?[{name:"structure",val:i.structure,start:((ze=i.startingValues)==null?void 0:ze.structure)||20},{name:"veil",val:i.veil,start:((Be=i.startingValues)==null?void 0:Be.veil)||16},{name:"presence",val:i.presence,start:((A=i.startingValues)==null?void 0:A.presence)||14}]:[{name:"vitality",val:i.vitality,start:((V=i.startingValues)==null?void 0:V.vitality)||20},{name:"resolve",val:i.resolve,start:((H=i.startingValues)==null?void 0:H.resolve)||16},{name:"nerve",val:i.nerve,start:((Q=i.startingValues)==null?void 0:Q.nerve)||16}]).filter(se=>se.val<se.start).sort((se,ye)=>se.val/se.start-ye.val/ye.start);if(te.length>0){const se=i[te[0].name];Dt(i,te[0].name,1);const ye=i[te[0].name];ye>se&&g(`    [Rally] ${a} ${te[0].name} +1 (${se}${ye})`)}}}}else ve.atkMult===0&&g(`     No damage (${ve.tier})`);if(ve.defMult>0){const z=i.side==="dungeon"?"structure":"vitality",b=Oe(i,z,1,ve.defMult);b>0&&g(`     Reversal: ${a} ${z} -${b}`)}a==="dungeon"?u.stats.dLastType=o.type:u.stats.vLastType=o.type,o.exhaust&&(g(`    [Exhaust] ${o.name} removed from game`),o._exhausted=!0)}function xg(o,a,i,c,d,u,f){var D,B,F,ie,ge,oe;const g=f.log,h=a.filter(K=>K.category==="React");if(h.length===0||u.tier!=="Strong"&&u.tier!=="Devastating")return null;const m=h.sort((K,Z)=>(Z.power||0)-(K.power||0))[0];let k=m.power||1;if((D=m.reactEffect)!=null&&D.conditionalPower){const K=m.reactEffect.conditionalPower;if(K.condition==="self_resource_below_half"){const Z=i[K.resource]||0,he=((B=i.startingValues)==null?void 0:B[K.resource])||20;Z<=he*.5&&(k=K.power)}}const w=pa(0),v=ya(m,i),T=w.total+v+k,j=7,$=T>=j;if((F=m.reactEffect)!=null&&F.absorb){const K=m.reactEffect.fortifyResource||d.target,Z=m.reactEffect.fortifyAmount||1;i.conditions.push({type:"fortify",resource:K,reduction:Z,duration:1,source:m.name,fresh:!0}),g(`    [${o}] React: ${m.name}  Fortify ${Z} (${K})`)}if($){let K=k;if(g(`    [${o}] React: ${m.name}  SUCCESS (2d6[${w.kept}]+${v}mod+${k}pwr = ${T} vs ${j}) mitigates ${K}`),(ie=m.reactEffect)!=null&&ie.reflect&&u.tier==="Devastating"){const he=c.side==="dungeon"?"structure":"vitality",De=Oe(c,he,1,1);g(`    [Reflect] Attacker ${he} -${De}`)}if((oe=(ge=m.reactEffect)==null?void 0:ge.onSuccess)!=null&&oe.selfFortify){const Z=m.reactEffect.onSuccess.selfFortify;i.conditions.push({type:"fortify",resource:Z.resource||"vitality",reduction:Z.reduction||1,duration:Z.duration||1,source:m.name,placedBy:o,fresh:!0}),g(`    [${o}] React Fortify: ${m.name}  Fortify ${Z.reduction||1} (${Z.resource||"vitality"}) for ${Z.duration||1} round`)}return{card:m,mitigation:K}}else return g(`    [${o}] React: ${m.name}  FAILED (2d6[${w.kept}]+${v}mod+${k}pwr = ${T} vs ${j})`),{card:m,mitigation:0}}function Eg(o,a,i,c,d){var g,h;const u=d.log;if(u(`  [${a}] Reshape: ${o.name}`),!o.reshapeEffect)return;const f=o.reshapeEffect;if((f.restoreMember||f.restore)&&i.isParty){const m=Object.entries(i.members).filter(([k,w])=>w.status==="knocked_out");if(m.length>0){const[k,w]=m[0];let v;f.restore&&f.restore.amount?v=Math.max(1,Math.floor(w.maxVitality*f.restore.amount)):v=(Array.isArray(f.heal)?(g=f.heal[0])==null?void 0:g.amount:(h=f.heal)==null?void 0:h.amount)||4;const T=Yp(i,k,v);if(T.restored){const j=Xp(k,d.fullVisitorDeck,d.vDiscard);u(`    [Restore] ${w.name} returns at ${T.vitality} vitality!`),u(`    [Deck] ${j.length} cards returned to discard${j.length>0?": "+j.join(", "):""}`)}return}u("    [Restore] No knocked-out members to restore  applying standard effects")}if(f.heal&&i.isParty){const m=Array.isArray(f.heal)?f.heal:[f.heal];for(const k of m){if(k.target==="self_member"&&o.member){const j=i.members[o.member];if(j&&j.status==="active"){const $=Math.min(k.amount,j.maxVitality-j.vitality);j.vitality+=$,i.vitality=Object.values(i.members).filter(D=>D.status==="active").reduce((D,B)=>D+B.vitality,0),u(`     ${j.name} vitality +${$} (${j.vitality-$}${j.vitality})`),o.member}continue}if((k.target==="select_member"||k.target==="weakest_member")&&i.isParty){const j=Object.entries(i.members).filter(([$,D])=>D.status==="active").sort(([$,D],[B,F])=>D.vitality-F.vitality);if(j.length>0){const[$,D]=j[0],B=Math.min(k.amount,D.maxVitality-D.vitality);D.vitality+=B,i.vitality=Object.values(i.members).filter(F=>F.status==="active").reduce((F,ie)=>F+ie.vitality,0),u(`     ${D.name} vitality +${B} (now ${D.vitality}/${D.maxVitality})`)}continue}const w=i[k.resource];Dt(i,k.resource,k.amount);const v=i[k.resource],T=v-w;T>0&&u(`     ${k.resource} +${T} (${w}${v})`)}}else if(f.heal){const m=Array.isArray(f.heal)?f.heal:[f.heal];for(const k of m){const w=i[k.resource];Dt(i,k.resource,k.amount);const v=i[k.resource],T=v-w;T>0&&u(`     ${k.resource} +${T} (${w}${v})`)}}if(f.shift){const m=i[f.shift.from],k=Math.min(f.shift.amount,m);k>0&&(Oe(i,f.shift.from,k,1),Dt(i,f.shift.to,k),u(`     ${f.shift.from} -${k}, ${f.shift.to} +${k}`))}if(f.fortify){const m=Array.isArray(f.fortify)?f.fortify:[f.fortify];for(const k of m)i.conditions.push({type:"fortify",resource:k.resource||"vitality",reduction:k.reduction||k.amount||1,duration:k.duration||2,source:o.name,placedBy:a,fresh:!0}),u(`     Fortified: ${k.resource||"vitality"} -${k.reduction||k.amount||1} incoming for ${k.duration||2} rounds`)}if(f.extendFortify){const m=f.extendFortify.rounds||1,k=i.conditions.filter(v=>v.type==="fortify");if(k.length>0){let v=0;for(const T of k)T.duration+=m,v++;v>0&&u(`    [Extend] Fortify extended by ${m} round${m>1?"s":""} (${v} effect${v>1?"s":""})`)}const w=i.conditions.filter(v=>v.type==="guarded");if(w.length>0){for(const v of w)v.duration+=m;u(`    [Extend] Guard extended by ${m} round${m>1?"s":""}`)}}}function da(o,a,i,c,d){var h;const u=d.log,f=a==="dungeon"?"visitor":"dungeon",g=c.conditions.filter(m=>m.type==="trap"&&m.trigger===o);for(const m of g){if(u(`    TRAP SPRINGS: ${m.card.name} (triggered by ${o})`),c.conditions=c.conditions.filter(k=>k!==m),m.card.trapEffect){const k=Array.isArray(m.card.trapEffect)?m.card.trapEffect:[m.card.trapEffect];for(const w of k){if(w.applyEntangle&&(i.conditions.push({type:"entangled",placedBy:f,source:m.card.name}),u("       Entangle applied")),w.damage){const T=Oe(i,w.damage.resource,w.damage.amount,1);u(`       ${w.damage.resource} -${T}`)}if(w.resource){const v=w.target==="triggerer"?i:c,T=Oe(v,w.resource,Math.abs(w.amount),1);u(`       ${w.resource} -${T}`)}}}(h=m.card.keywords)!=null&&h.length&&Kc(m.card,i,c,{autoResource:d.autoResource,log:u,activeSide:f})}}function bg(o,a,i,c,d){const u=d.log,f=a==="dungeon"?c.trust:i.trust,g=a==="dungeon"?i.rapport:c.rapport,h=Math.min(.85,.4+f*.05+g*.03),m=Math.random()<h,k=o.testReward||{trust:2,rapport:2},w=o.defectPenalty||{trustCrash:.5,powerGain:2},v=a==="dungeon"?c:i,T=a==="dungeon"?i:c;if(m){u(`  [${a}] Test: ${o.name}  COOPERATE (trust:${f}, chance:${(h*100).toFixed(0)}%)`);const j=vi(v,"trust",k.trust,d),$=vi(T,"rapport",k.rapport,d);if(u(`     trust +${j}, rapport +${$}`),o.exposureCost){const D=Oe(i,o.exposureCost.resource,o.exposureCost.amount,1);u(`     Exposure: ${o.exposureCost.resource} -${D}`)}}else{u(`  [${a}] Test: ${o.name}  DEFECT (trust:${f}, chance:${(h*100).toFixed(0)}%)`);const j=a==="dungeon"?"visitor":"dungeon";if(c.conditions.push({type:"empower",effect:{advantage:!1,powerBonus:w.powerGain},source:`${o.name} (defection)`,placedBy:j}),u(`     Defector gains +${w.powerGain} power on next strike`),v.trust>0){const $=Math.ceil(v.trust*w.trustCrash);v.trust=Math.max(0,v.trust-$),u(`     trust crashes -${$}`)}if(T.rapport>0){const $=Math.ceil(T.rapport*w.trustCrash);T.rapport=Math.max(0,T.rapport-$),u(`     rapport crashes -${$}`)}}}function Tg(o,a,i,c,d){const u=ig(o,a,i,c,d);return u.bond&&(d.bondTriggered=!0),u}function Cg(o,a,i,c){var f;if(!(o!=null&&o.condition))return!1;const d=o.condition,u=d.target==="self"?a:i;switch(d.type){case"resource_below":{const g=u[d.resource],h=d.value!==void 0?d.value:Math.floor((((f=u.startingValues)==null?void 0:f[d.resource])||20)*(d.pct||.5));return g<=h}case"resource_above":return(u[d.resource]||0)>=d.value;case"has_condition":return gr(u,d.condition);case"no_condition":return!gr(u,d.condition);case"discard_count":return((c==null?void 0:c.discard)||[]).filter(m=>m.category===d.category).length>=(d.min||1);case"discard_count_value":return((c==null?void 0:c.discard)||[]).filter(h=>h.category===d.category).length>0;case"round_threshold":return((c==null?void 0:c.round)||1)>=(d.value||1);default:return!1}}function _g(o,a,i,c){if(!o)return 0;const d=o.condition;if((d==null?void 0:d.type)==="discard_count_value"){const f=((c==null?void 0:c.discard)||[]).filter(g=>g.category===d.category).length;return Math.min(f*(o.bonusPerCount||1),o.maxBonus||4)}return o.bonus||0}let _c=0;function Rg(o,a,i,c){_c++;const d={_eventId:_c,dungeon:{structure:o.structure,veil:o.veil,presence:o.presence,rapport:o.rapport,conditions:o.conditions.map(u=>({...u}))},visitor:{vitality:a.vitality,resolve:a.resolve,nerve:a.nerve,trust:a.trust,conditions:a.conditions.map(u=>({...u}))},dEnergy:{base:i.base,available:i.available,temp:i.tempBonus,spent:i.spent},vEnergy:{base:c.base,available:c.available,temp:c.tempBonus,spent:c.spent}};if(a.isParty){d.members={};for(const[u,f]of Object.entries(a.members))d.members[u]={vitality:f.vitality,maxVitality:f.maxVitality,status:f.status,name:f.name,role:f.role};d.knockoutCount=a.knockoutCount}return d}function fa(o,a){const i={};for(const c of["structure","veil","presence","rapport"])o.dungeon[c]!==a.dungeon[c]&&(i[`dungeon.${c}`]={before:o.dungeon[c],after:a.dungeon[c],delta:a.dungeon[c]-o.dungeon[c]});for(const c of["vitality","resolve","nerve","trust"])o.visitor[c]!==a.visitor[c]&&(i[`visitor.${c}`]={before:o.visitor[c],after:a.visitor[c],delta:a.visitor[c]-o.visitor[c]});if(o.dEnergy.available!==a.dEnergy.available&&(i["dungeon.energy"]={before:o.dEnergy.available,after:a.dEnergy.available,delta:a.dEnergy.available-o.dEnergy.available,base:a.dEnergy.base}),o.vEnergy.available!==a.vEnergy.available&&(i["visitor.energy"]={before:o.vEnergy.available,after:a.vEnergy.available,delta:a.vEnergy.available-o.vEnergy.available,base:a.vEnergy.base}),o.members&&a.members)for(const c of Object.keys(o.members)){const d=o.members[c],u=a.members[c];(d.vitality!==u.vitality||d.status!==u.status)&&(i[`member.${c}`]={before:{vitality:d.vitality,status:d.status},after:{vitality:u.vitality,status:u.status},delta:u.vitality-d.vitality,knockout:d.status==="active"&&u.status==="knocked_out",restored:d.status==="knocked_out"&&u.status==="active",name:u.name})}return i}function pi(){const o=[];return{log:a=>o.push(a),getLines:()=>[...o],clear:()=>{o.length=0}}}class Pg{constructor(a,i,c={}){this.scenario=a,this.playerSide=i,this.aiSide=i==="dungeon"?"visitor":"dungeon",this.config={maxRounds:15,handSize:7,drawPerRound:2,minHandSize:3,bondThreshold:12,dungeonBaseEnergy:2,visitorBaseEnergy:2,promoterGainCap:2,...c},this._phase="idle",this._encounterIndex=-1,this._eventQueue=[],this._cardQueue=[],this._cardQueueIndex=0,this._currentTurnSide=null,this._firstSide=null,this._secondSide=null,this._turnNumber=0,this._outcome=null,this._carryover=null,this._dungeon=null,this._visitor=null,this._dEnergy=null,this._vEnergy=null,this._dHand=null,this._vHand=null,this._dPile=null,this._vPile=null,this._dDiscard=null,this._vDiscard=null,this._fullVisitorDeck=null,this._round=0,this._stats=null,this._cardTracker=null,this._encounter=null,this._autoEffects=null,this._autoResource=null,this._dungeonAI=null,this._visitorAI=null,this._roundStartTrust=0,this._roundStartRapport=0,this._roundStartDungeonStrikes=0,this._memberTargetStrategy=null,this._storedDungeonAI=null,this._storedVisitorAI=null}startEncounter(a,i,c){var h,m,k,w,v;this._encounterIndex=a,i&&(this._storedDungeonAI=i),c&&(this._storedVisitorAI=c),this._dungeonAI=this._storedDungeonAI,this._visitorAI=this._storedVisitorAI;const d=this.scenario.encounters[a];this._encounter=d.encounter,this._visitor=((h=this._carryover)==null?void 0:h.visitor)||(this.scenario.visitorTemplate.type==="party"?Kp(this.scenario.visitorTemplate):Qp(this.scenario.visitorTemplate)),this._dungeon=((m=this._carryover)==null?void 0:m.dungeon)||qp(this.scenario.dungeonTemplate),this._dEnergy=kc(this.config.dungeonBaseEnergy),this._vEnergy=kc(this.config.visitorBaseEnergy);const u=xc(d.dungeonDeck,this.config.handSize),f=xc(d.visitorDeck,this.config.handSize);this._dHand=u.hand,this._dPile=u.drawPile,this._dDiscard=((k=this._carryover)==null?void 0:k.dungeonDiscard)||[],this._vHand=f.hand,this._vPile=f.drawPile,this._vDiscard=((w=this._carryover)==null?void 0:w.visitorDiscard)||[],this._fullVisitorDeck=[...d.visitorDeck],typeof this._dungeonAI.initDeck=="function"&&this._dungeonAI.initDeck(d.dungeonDeck),typeof this._visitorAI.initDeck=="function"&&this._visitorAI.initDeck(d.visitorDeck),this._autoEffects=this._encounter.autoEffects||(this._encounter.autoEffect?[this._encounter.autoEffect]:[]),this._autoResource=((v=this._autoEffects.find(T=>T.target==="visitor"))==null?void 0:v.resource)||null,this._round=0,this._stats={rounds:0,dCardsPlayed:0,vCardsPlayed:0,decisions:0,dDamageDealt:{},vDamageDealt:{},dLastType:null,vLastType:null,dStrikesPlayed:0,roundsSinceDungeonStrike:0},this._cardTracker={dungeon:{Strike:0,Empower:0,Disrupt:0,Counter:0,React:0,Trap:0,Offer:0,Reshape:0,Test:0},visitor:{Strike:0,Empower:0,Disrupt:0,Counter:0,React:0,Trap:0,Offer:0,Reshape:0,Test:0}},this._outcome=null;const g=this._encounter.initiative==="dungeon";this._firstSide=g?"dungeon":"visitor",this._secondSide=g?"visitor":"dungeon",this._phase="encounter_start",this._eventQueue=[{type:"encounter_start",phase:"encounter_start",data:{encounterIndex:a,name:this._encounter.name,description:this._encounter.description,initiative:this._encounter.initiative},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:[` ${this._encounter.name} `,`  Initiative: ${this._encounter.initiative}`],awaitingInput:!1}]}advanceToNextEncounter(){if(this._encounterIndex>=this.scenario.encounters.length-1)return!1;const a={visitor:this._visitor,dungeon:this._dungeon,dungeonDiscard:[],visitorDiscard:[]},i=a.dungeon,c=i.startingValues||{};for(const u of["structure","veil","presence"]){const f=c[u]||0;if(f<=0)continue;i[u]=Math.max(i[u],Math.max(1,Math.round(f*.85)));const g=f-i[u];g>0&&(i[u]+=Math.round(g*.5),i[u]=Math.min(i[u],f))}i.conditions=[];const d=a.visitor;if(d.isParty){const u=d.startingValues||{};for(const[,f]of Object.entries(d.members))f.status==="knocked_out"&&(f.status="active",f.vitality=Math.max(1,Math.round(f.maxVitality*.25)),d.knockoutCount=Math.max(0,d.knockoutCount-1));for(const[,f]of Object.entries(d.members))f.status==="active"&&f.vitality<f.maxVitality&&(f.vitality+=Math.round((f.maxVitality-f.vitality)*.15),f.vitality=Math.min(f.vitality,f.maxVitality));d.vitality=Object.values(d.members).reduce((f,g)=>f+g.vitality,0),u.resolve>0&&(d.resolve=Math.min(u.resolve,d.resolve+Math.round(u.resolve*.15))),u.nerve>0&&(d.nerve=Math.min(u.nerve,d.nerve+Math.round(u.nerve*.15)))}return d.conditions=[],this._carryover=a,this.startEncounter(this._encounterIndex+1),!0}nextStep(){if(this._eventQueue.length>0)return this._eventQueue.shift();switch(this._phase){case"encounter_start":return this._advanceToRoundStart();case"round_start":return this._processRoundStart();case"auto_effects":return this._processAutoEffects();case"post_auto_win_check":return this._checkWinAfterAuto();case"first_turn_start":return this._startTurn(this._firstSide,1);case"awaiting_player_cards":return{type:"awaiting_input",phase:"awaiting_player_cards",data:{side:this.playerSide,hand:[...this._getPlayerHand()],energy:this._energySnap()},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:[],awaitingInput:!0,inputType:"card_selection"};case"resolving_cards":return this._resolveNextCard();case"post_first_turn":return this._postTurnWinCheck(1);case"second_turn_start":return this._startTurn(this._secondSide,2);case"post_second_turn":return this._postTurnWinCheck(2);case"round_end":return this._processRoundEnd();case"encounter_over":return null;default:return null}}submitCardSelections(a){if(this._phase!=="awaiting_player_cards")throw new Error(`Cannot submit in phase: ${this._phase}`);this._cardQueue=a,this._cardQueueIndex=0,this._currentTurnSide=this.playerSide,this._phase="resolving_cards"}getPhase(){return this._phase}getOutcome(){return this._outcome}getEncounterIndex(){return this._encounterIndex}getTotalEncounters(){return this.scenario.encounters.length}getState(){return this._fullSnapshot()}getPlayerHandCopy(){return[...this._getPlayerHand()]}getPlayableCards(a=[]){const i=this._getPlayerHand(),c=this.playerSide==="dungeon"?this._dEnergy:this._vEnergy,d=this.playerSide==="dungeon"?this._dungeon:this._visitor;let u=0,f=0;for(const h of a){if(h.action==="play"){const m=h.card.cost||0,k=this._peekAttune(h.card,d);u+=Math.max(0,m-k)}(h.action==="energy"||h.action==="activate")&&(f+=1)}const g=c.available+f-u;return i.map(h=>{const m=h.cost||0,k=this._peekAttune(h,d),w=Math.max(0,m-k),v=a.some(T=>T.card===h);return{card:h,effectiveCost:w,attuneDiscount:k,isReact:h.category==="React",isQueued:v,canPlay:!v&&(h.category==="Energy"||h.category==="React"||w<=g),canActivate:!v&&h.category!=="React"}})}getCarryover(){return{visitor:this._visitor,dungeon:this._dungeon,dungeonDiscard:this._dDiscard,visitorDiscard:this._vDiscard}}_advanceToRoundStart(){return this._phase="round_start",this.nextStep()}_processRoundStart(){return this._round++,this._stats.rounds=this._round,this._roundStartTrust=this._visitor.trust||0,this._roundStartRapport=this._dungeon.rapport||0,this._roundStartDungeonStrikes=this._stats.dStrikesPlayed||0,this._visitor.isParty&&(this._memberTargetStrategy=typeof this._dungeonAI.selectMemberTarget=="function"?this._dungeonAI.selectMemberTarget(this._visitor,this._dungeon):"lowest_vitality"),this._phase="auto_effects",{type:"round_start",phase:"round_start",data:{round:this._round},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:[`
 Round ${this._round} `],awaitingInput:!1}}_processAutoEffects(){const a=this._fullSnapshot(),i=pi();for(const u of this._autoEffects)if((u.frequency==="every"||u.frequency==="other"&&this._round%2===1)&&u.resource&&u.amount!==0){const g=u.target==="visitor"?this._visitor:this._dungeon;if(u.amount<0)if(g.isParty&&u.resource==="vitality"){const h=ha(g,"random");if(h){const m=ga(g,h,Math.abs(u.amount));if(i.log(`   Auto: ${g.members[h].name} vitality ${u.amount}`),m.knockout){i.log(`     ${g.members[h].name} KNOCKED OUT!`);const k=Qc(h,this._vHand,this._vPile,this._vDiscard);this._vHand=k.newHand}}}else Oe(g,u.resource,Math.abs(u.amount),1),i.log(`   Auto: ${u.target} ${u.resource} ${u.amount}`);else Dt(g,u.resource,u.amount),i.log(`   Auto: ${u.target} ${u.resource} +${u.amount}`)}Sc(this._visitor,this._autoResource,i.log),Sc(this._dungeon,this._autoResource,i.log);const c=tg(this._round,this.config);if(c){if(this._visitor.isParty){const u=ha(this._visitor,"random");u&&ga(this._visitor,u,c.damage)}else Oe(this._visitor,"vitality",c.damage,1);Oe(this._dungeon,"structure",c.damage,1),i.log(`   Escalation: Both sides take ${c.damage}`)}const d=this._fullSnapshot();return this._phase="post_auto_win_check",{type:"auto_effects",phase:"auto_effects",data:{round:this._round},stateSnapshot:d,resourceChanges:fa(a,d),logLines:i.getLines(),awaitingInput:!1}}_checkWinAfterAuto(){const a=ca(this._visitor,this._dungeon,this.config);return a?(this._outcome=a,this._phase="encounter_over",this._endEvent(a)):(this._phase="first_turn_start",this.nextStep())}_startTurn(a,i){this._currentTurnSide=a,this._turnNumber=i;const c=a===this.playerSide,d=pi();if(wg(a==="dungeon"?this._dungeon:this._visitor,a,d.log),c)return this._phase="awaiting_player_cards",{type:"turn_start",phase:"awaiting_player_cards",data:{side:a,isHuman:!0,turnNumber:i,hand:[...this._getPlayerHand()],energy:this._energySnap()},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:d.getLines(),awaitingInput:!0,inputType:"card_selection"};const u=this._sd(a),f=this._ctx(a),g=u.ai.pickCards([...u.hand],u.energy,u.self,u.opp,f);return this._cardQueue=g,this._cardQueueIndex=0,this._currentTurnSide=a,this._phase="resolving_cards",{type:"turn_start",phase:"resolving_cards",data:{side:a,isHuman:!1,turnNumber:i,cardCount:g.filter(h=>h.card.category!=="React").length},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:d.getLines(),awaitingInput:!1}}_resolveNextCard(){var d,u,f,g,h,m,k;const a=this._currentTurnSide,i=this._sd(a),c=i.hand;for(;this._cardQueueIndex<this._cardQueue.length;){const w=this._cardQueue[this._cardQueueIndex];this._cardQueueIndex++;const v=w.card,T=c.indexOf(v);if(T===-1||v.category==="React")continue;const j=this._fullSnapshot(),$=pi(),D=this._ctx(a,$.log);let B={side:a,card:this._csum(v),action:w.action};if(v.category==="Energy"){const K=ng(v,i.energy,i.self,i.opp);return c.splice(T,1),i.discard.push(v),$.log(`   [${a}] Energy: ${v.name}  ${K.description||K.type}`),this._stats.decisions++,B.action="energy",B.energyResult=K,this._cardEvt(B,j,this._fullSnapshot(),$.getLines())}if(w.action==="activate")return c.splice(T,1),i.energy.addTemp(1),i.discard.push(v),$.log(`   [${a}] Activate: ${v.name}  +1 temp Energy`),this._stats.decisions++,this._cardEvt(B,j,this._fullSnapshot(),$.getLines());if(w.action==="restrain"){if(c.splice(T,1),i.discard.push(v),a==="dungeon"){const K=vi(i.self,"rapport",1,D);$.log(`   [${a}] Restrain: ${v.name}  rapport +${K}`)}else{const K=vi(i.self,"trust",1,D);$.log(`   [${a}] Restrain: ${v.name}  trust +${K}`)}return this._stats.decisions++,this._cardEvt(B,j,this._fullSnapshot(),$.getLines())}const F=v.cost||0,ie=rg(v,i.self),ge=Math.max(0,F-ie);if(!i.energy.canAfford(ge))continue;switch(i.energy.spend(ge),ie>0&&$.log(`   [${a}] Attune: ${v.name} cost ${F}  ${ge}`),c.splice(T,1),this._stats.decisions++,v.category){case"Strike":Sg(v,a,i.self,i.opp,i.energy,D),da("strike_played",a,i.self,i.opp,D),fg(a,i.self,i.opp,D),pg(a,i.self,i.opp,D),a==="dungeon"&&(this._stats.dStrikesPlayed=(this._stats.dStrikesPlayed||0)+1,this._stats.roundsSinceDungeonStrike=0);break;case"Test":bg(v,a,i.self,i.opp,D);break;case"Empower":i.self.conditions.push({type:"empower",effect:v.empowerEffect||{},source:v.name,placedBy:a}),$.log(`   [${a}] Empower: ${v.name}`),da("empower_played",a,i.self,i.opp,D);break;case"Disrupt":(d=v.disruptEffect)!=null&&d.guard?kg(v,a,i.self,i.opp,D):(i.opp.conditions.push({type:"disrupt",effect:v.disruptEffect||{},source:v.name,placedBy:a}),$.log(`   [${a}] Disrupt: ${v.name}`));break;case"Counter":{const K=a==="dungeon"?"visitor":"dungeon";let Z=yi(i.opp,"empower",K);if(Z||(Z=yi(i.self,"disrupt",K)),Z){if($.log(`   [${a}] Counter: ${v.name} removes ${Z.source}`),v.counterDamage){const he=(u=v.counterEffect)!=null&&u.empowerBonus&&Z.type==="empower"&&v.counterEffect.empowerBonus.chipDamage||v.counterDamage.amount;Oe(i.opp,v.counterDamage.resource,he,1)}(f=v.counterEffect)!=null&&f.steal&&Z.type==="empower"&&i.self.conditions.push({...Z,placedBy:a}),(g=v.counterEffect)!=null&&g.applyEntangle&&i.opp.conditions.push({type:"entangled",placedBy:a,source:v.name}),(h=v.counterEffect)!=null&&h.applyFortify&&i.self.conditions.push({type:"fortify",resource:v.counterEffect.fortifyResource||"structure",reduction:v.counterEffect.applyFortify,duration:1,source:v.name,fresh:!0}),(m=v.counterEffect)!=null&&m.spreadFortify&&Cc(v,a,i.self,i.opp,D)}else $.log(`   [${a}] Counter: ${v.name}  nothing to remove`),(k=v.counterEffect)!=null&&k.spreadFortify&&Cc(v,a,i.self,i.opp,D);da("counter_played",a,i.self,i.opp,D);break}case"Trap":i.self.conditions.push({type:"trap",card:v,trigger:v.trapTrigger,placedBy:a}),$.log(`   [${a}] Trap set: ${v.name}`);break;case"Offer":Tg(v,a,i.self,i.opp,D);break;case"Reshape":Eg(v,a,i.self,i.opp,D);break;default:$.log(`  [${a}] Play: ${v.name}`)}if(v._exhausted||i.discard.push(v),v.category&&this._cardTracker[a]&&(this._cardTracker[a][v.category]=(this._cardTracker[a][v.category]||0)+1),a==="dungeon"?this._stats.dCardsPlayed++:this._stats.vCardsPlayed++,D.bondTriggered){this._outcome={winner:"both",condition:"Bond",desc:"Covenant accepted"},this._phase="encounter_over";const K=this._cardEvt(B,j,this._fullSnapshot(),$.getLines());return K.data.outcome=this._outcome,K}const oe=ca(this._visitor,this._dungeon,this.config);if(oe){this._outcome=oe,this._phase="encounter_over";const K=this._cardEvt(B,j,this._fullSnapshot(),$.getLines());return K.data.winCondition=oe,K}return this._cardEvt(B,j,this._fullSnapshot(),$.getLines())}return this._phase=this._turnNumber===1?"post_first_turn":"post_second_turn",{type:"turn_end",phase:this._phase,data:{side:a,turnNumber:this._turnNumber},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:[],awaitingInput:!1}}_postTurnWinCheck(a){const i=ca(this._visitor,this._dungeon,this.config);return i?(this._outcome=i,this._phase="encounter_over",this._endEvent(i)):(this._phase=a===1?"second_turn_start":"round_end",this.nextStep())}_processRoundEnd(){const a=this._fullSnapshot(),i=pi(),c=Math.max(this.config.drawPerRound,this.config.minHandSize-this._dHand.length),d=Math.max(this.config.drawPerRound,this.config.minHandSize-this._vHand.length);c>0&&this._dHand.push(...Ec(this._dPile,this._dDiscard,c)),d>0&&this._vHand.push(...Ec(this._vPile,this._vDiscard,d)),this._dEnergy.refresh(),this._vEnergy.refresh();for(const f of[this._dungeon,this._visitor])f.conditions=f.conditions.filter(g=>{if(g.type==="fortify"){if(g.fresh)return g.fresh=!1,!0;if(g.duration--,g.duration<=0)return i.log(`  [Fortify] ${g.source} expires`),!1}if(g.type==="guarded"){if(g.fresh)return g.fresh=!1,!0;if(g.duration--,g.duration<=0)return i.log(`  [Guard] ${g.source} expires`),!1}return!0});bc(this._visitor,{log:i.log}),bc(this._dungeon,{log:i.log}),gg(this._visitor,{log:i.log}),Tc(this._visitor),Tc(this._dungeon),this._stats.dStrikesPlayed===this._roundStartDungeonStrikes&&(this._stats.roundsSinceDungeonStrike=(this._stats.roundsSinceDungeonStrike||0)+1),this._round>=this.config.maxRounds?(this._outcome={winner:"visitor",condition:"Survive",desc:"Round limit reached"},this._phase="encounter_over"):this._phase="round_start";const u=this._fullSnapshot();return{type:"round_end",phase:this._phase,data:{round:this._round,dungeonDrew:c,visitorDrew:d,playerHand:[...this._getPlayerHand()],encounterOver:this._phase==="encounter_over",outcome:this._outcome},stateSnapshot:u,resourceChanges:fa(a,u),logLines:i.getLines(),awaitingInput:!1}}_sd(a){return a==="dungeon"?{hand:this._dHand,energy:this._dEnergy,self:this._dungeon,opp:this._visitor,ai:this._dungeonAI,discard:this._dDiscard}:{hand:this._vHand,energy:this._vEnergy,self:this._visitor,opp:this._dungeon,ai:this._visitorAI,discard:this._vDiscard}}_ctx(a,i){const c=a==="dungeon"?"visitor":"dungeon",d=this._sd(c),u=this._sd(a);return{encounter:this._encounter,round:this._round,stats:this._stats,autoResource:this._autoResource,log:i||(()=>{}),activeSide:a,opponentReactHand:d.hand,opponentSide:c,cardTracker:this._cardTracker,bondThreshold:this.config.bondThreshold,roundStartTrust:this._roundStartTrust,roundStartRapport:this._roundStartRapport,promoterGainCap:this.config.promoterGainCap,memberTargetStrategy:a==="dungeon"?this._memberTargetStrategy:null,fullVisitorDeck:this._fullVisitorDeck,vPile:this._vPile,vDiscard:this._vDiscard,sides:{dungeon:this._sd("dungeon"),visitor:this._sd("visitor")},bondTriggered:!1,discard:u.discard}}_getPlayerHand(){return this.playerSide==="dungeon"?this._dHand:this._vHand}_energySnap(){const a=this.playerSide==="dungeon"?this._dEnergy:this._vEnergy;return{base:a.base,available:a.available,temp:a.tempBonus,spent:a.spent}}_peekAttune(a,i){if(!a.type)return 0;const c=i.conditions.find(d=>d.type==="attune"&&d.cardType===a.type);return c?c.discount||1:0}_fullSnapshot(){return Rg(this._dungeon,this._visitor,this._dEnergy,this._vEnergy)}_csum(a){return{name:a.name,category:a.category,type:a.type,cost:a.cost,power:a.power,target:a.target,keywords:a.keywords,description:a.description,member:a.member}}_cardEvt(a,i,c,d){return{type:"card_played",phase:this._phase,data:a,stateSnapshot:c,resourceChanges:fa(i,c),logLines:d,awaitingInput:!1}}_endEvent(a){return{type:"encounter_end",phase:"encounter_over",data:{outcome:a,stats:{...this._stats},round:this._round},stateSnapshot:this._fullSnapshot(),resourceChanges:{},logLines:[`  >>> ${a.condition}: ${a.desc}`],awaitingInput:!1}}}function Rc(o,a,i){if(o==="dungeon"){const c=[...a],d=[];for(let u=0;u<3;u++){const f=Math.floor(Math.random()*c.length);d.push(c.splice(f,1)[0])}return{encounters:d}}else{const c=[...i],d=[];for(let u=0;u<4;u++){const f=Math.floor(Math.random()*c.length);d.push(c.splice(f,1)[0])}return{members:d}}}function Dg(o,a){const i=o.cost||0;if(i===0)return 0;if(!o.type||!a||!a.conditions)return i;const c=a.conditions.find(d=>d.type==="attune"&&d.cardType===o.type);return c?Math.max(0,i-(c.discount||1)):i}function Yc(o,a,i,c,d,u){const f=d.round||1,g=o.filter(T=>T.category==="Energy"),h=o.filter(T=>T.category!=="Energy"&&T.category!=="React");if(g.length===0)return Og(h,a.available,i,c,d,u);if(h.length===0)return zg(g,a,i,c);const m=d.scoreFunction||(T=>Jc(T,i,c,d,u)),k=h.map(T=>({card:T,score:m(T)}));Xc(k,i,c,d,u);const w=$g(g,k,a,i,c,d,f,u),v=[];for(const T of w.energySequence)v.push({card:T,action:"energy"});for(const T of w.actionSequence)v.push({card:T.card,action:"play"});return ed(v,o,i,c,d,u),v}function $g(o,a,i,c,d,u,f,g){const h=Mg(o);let m=null,k=-1/0;for(const w of h){const v=jg(w,i,c,d),T=hi(a,v.available,v.self,g),j=T.reduce((K,Z)=>K+Z.score,0),$=i.base||2,D=w.reduce((K,Z,he)=>{const De=$+he;return K+1+De*.5},0),F=hi(a,i.available,c,g).reduce((K,Z)=>K+Z.score,0),ie=j-F,ge=v.permanentGained*(f<=3?1:f<=6?.3:0),oe=j-D+Math.max(ie,0)+ge;oe>k&&(k=oe,m={energySequence:Ag(w,T,c,d),actionSequence:wa(T),totalValue:oe,simState:v})}if(!m){const w=hi(a,i.available,c,g);m={energySequence:[],actionSequence:wa(w),totalValue:w.reduce((v,T)=>v+T.score,0)}}return m}function jg(o,a,i,c,d){let u=a.available,f=0;const g={...i,conditions:[...i.conditions||[]]};for(const h of o)switch(h.energyType||"standard"){case"standard":{const k=h.energyGain||1;u+=k,f+=k;break}case"surge":{const k=h.surgeGain||2;u+=k;break}case"attune":{const k=h.energyGain||1;u+=k,f+=k,h.attune&&(g.conditions.find(v=>v.type==="attune"&&v.cardType===h.attune.cardType)||g.conditions.push({type:"attune",cardType:h.attune.cardType,discount:h.attune.discount||1,source:h.name,duration:99}));break}case"siphon":{if(ki(h.siphon,i,c)){const w=h.energyGain||1;u+=w,f+=w}else{const w=h.siphonFallback||1;u+=w}break}default:u+=1,f+=1}return{available:u,permanentGained:f,self:g}}function Mg(o){const a=[],i=o.length;for(let c=0;c<1<<i;c++){const d=[];for(let u=0;u<i;u++)c&1<<u&&d.push(o[u]);a.push(d)}return a}function hi(o,a,i,c){const d=[...o].filter(g=>g.score>(c.scoreThreshold||0)).sort((g,h)=>h.score-g.score),u=[];let f=a;for(const g of d){const h=Dg(g.card,i);h<=f&&(u.push(g),f-=h)}return u}function Ag(o,a,i,c,d){if(o.length<=1)return[...o];const u=new Set(a.map(f=>f.card.type).filter(Boolean));return[...o].sort((f,g)=>{const h=Pc(f,u,i,c),m=Pc(g,u,i,c);return h-m})}function Pc(o,a,i,c){switch(o.energyType||"standard"){case"attune":return o.attune&&a.has(o.attune.cardType)?0:2;case"siphon":return ki(o.siphon,i,c)?1:5;case"standard":return 2;case"surge":return 4;default:return 3}}function wa(o,a,i,c,d){if(o.length<=1)return[...o];const u=[...o],f=u.findIndex(T=>T.card.category==="Counter"&&T.score>5);if(f>0){const[T]=u.splice(f,1);u.unshift(T)}const g=u.findIndex(T=>T.card.category==="Trap"&&T.card.trapTrigger==="offer_accepted"),h=u.findIndex(T=>T.card.category==="Offer");if(g>=0&&h>=0&&g>h){const[T]=u.splice(g,1);u.splice(h,0,T)}const m=u.findIndex(T=>T.card.category==="Empower"),k=u.findIndex(T=>T.card.category==="Strike");if(m>=0&&k>=0&&m>k){const[T]=u.splice(m,1);u.splice(k,0,T)}const w=u.findIndex(T=>T.card.category==="Disrupt"),v=u.findIndex(T=>T.card.category==="Strike");if(w>=0&&v>=0&&w>v){const[T]=u.splice(w,1);u.splice(v,0,T)}return u}function Xc(o,a,i,c,d){var v,T;if((v=d.preferredTargets)!=null&&v.includes("trust")||(T=d.preferredTargets)!=null&&T.includes("rapport"))return;const u=Zc(i);if(u.length===0)return;const f=[...u].sort((j,$)=>j.ratio-$.ratio),g=f[0],m=f[f.length-1].ratio-g.ratio;if(m<.05)return;const k=Math.min(m*12,6),w=u.reduce((j,$)=>j+(1-$.ratio),0)/u.length;for(const j of o){if(j.score<=0)continue;const $=u.find(B=>B.name===j.card.target);if(!$)continue;const D=1-$.ratio;D<w?j.score+=k:D>w+.15&&j.score>3&&(j.score-=k*.3)}}function Zc(o){var a,i,c,d,u,f;return o.vitality!==void 0?[{name:"vitality",val:o.vitality,start:((a=o.startingValues)==null?void 0:a.vitality)||20},{name:"resolve",val:o.resolve,start:((i=o.startingValues)==null?void 0:i.resolve)||16},{name:"nerve",val:o.nerve,start:((c=o.startingValues)==null?void 0:c.nerve)||16}].map(g=>({...g,ratio:g.val/g.start})):o.structure!==void 0?[{name:"structure",val:o.structure,start:((d=o.startingValues)==null?void 0:d.structure)||16},{name:"veil",val:o.veil,start:((u=o.startingValues)==null?void 0:u.veil)||14},{name:"presence",val:o.presence,start:((f=o.startingValues)==null?void 0:f.presence)||12}].map(g=>({...g,ratio:g.val/g.start})):[]}function Jc(o,a,i,c,d){var g,h,m,k,w,v,T,j,$;let f=(((g=d.baseWeights)==null?void 0:g[o.category])||1)*2;if(f+=(o.power||0)*1.5,o.trigger&&(f+=1),f-=(o.cost||0)*.2,o.target&&d.preferredTargets&&d.preferredTargets.includes(o.target)&&(f+=3),o.category==="Strike"){const D=o.keywords||[];if(D.includes("Entangle")&&!((h=i.conditions)!=null&&h.some(B=>B.type==="entangled"))&&(f+=2),D.includes("Erode")&&(f+=1.5),D.includes("Drain")&&(f+=1.5),D.includes("Overwhelm")){const B=Zc(i).find(F=>F.name===o.target);B&&B.ratio<.3&&(f+=3)}((k=(m=o.trigger)==null?void 0:m.condition)==null?void 0:k.type)==="has_condition"&&((w=i.conditions)!=null&&w.some(F=>F.type===o.trigger.condition.condition))&&(f+=(o.trigger.bonus||2)*1.5)}if(o.category==="Empower"&&(c._handHasStrike===void 0||c._handHasStrike||(f*=.1)),o.category==="Counter"){const D=(v=i.conditions)==null?void 0:v.some(F=>F.type==="empower"),B=(T=a.conditions)==null?void 0:T.some(F=>F.type==="disrupt");!D&&!B&&(f=0)}return o.category==="Strike"&&((j=d.preferredTargets)!=null&&j.includes("rapport")&&(a.rapport||0)>2&&(f=0),($=d.preferredTargets)!=null&&$.includes("trust")&&(a.trust||0)>2&&(f=0)),f}function Og(o,a,i,c,d,u){const f=d.scoreFunction||(w=>Jc(w,i,c,d,u)),g=o.map(w=>({card:w,score:f(w)}));Xc(g,i,c,d,u);const h=hi(g,a,i,u),m=wa(h),k=[];for(const w of m)k.push({card:w.card,action:"play"});return ed(k,o,i,c,d,u),k}function zg(o,a,i,c,d,u){return[{card:[...o].sort((g,h)=>Dc(g,i,c)-Dc(h,i,c))[0],action:"energy"}]}function Dc(o,a,i){switch(o.energyType||"standard"){case"siphon":return ki(o.siphon,a,i)?0:4;case"standard":return 1;case"attune":return 2;case"surge":return 5;default:return 3}}function ed(o,a,i,c,d,u){var m,k;if(!(u.bondStrategy==="nurturing"||u.bondStrategy==="deceptive"&&(c.trust||0)<(u.betrayalThreshold||6)||((m=u.preferredTargets)==null?void 0:m.includes("rapport"))&&(i.rapport||0)>2||((k=u.preferredTargets)==null?void 0:k.includes("trust"))&&(i.trust||0)>2))return;const g=new Set(o.map(w=>w.card));if(!a.some(w=>(w.category==="Offer"||w.category==="Test")&&!g.has(w))){const w=a.filter(v=>v.category==="Strike"&&!g.has(v));if(w.length>0){const v=w.reduce((T,j)=>(T.power||1)<=(j.power||1)?T:j);o.push({card:v,action:"restrain"})}}}function Ng(o,a,i,c,d,u,f){const g=c.trust||0,h=ba(g),m=u.bondStrategy,k=f.round;if(m==="deceptive"){const w=g>=(u.betrayalThreshold||8),v=f.round>=10&&g>=3;if(w||v)return Wg(o,i,c,g,f)}if(m==="nurturing"&&k>=5){const w=g<3,v=i.startingValues&&Math.min(i.structure/(i.startingValues.structure||16),i.veil/(i.startingValues.veil||14),i.presence/(i.startingValues.presence||12))<.5;if(w&&v)return Vg(o,a,i,c,g,f)}return Bg(o,a,i,c,d,h,g,k,m)}function Bg(o,a,i,c,d,u,f,g,h){switch(o.category){case"Strike":return f>0?-20:Math.min(a*.15,1.5);case"Offer":return Ig(o,u,f,h);case"Test":return Fg(u,f);case"Reshape":return Lg(a,i,g);case"Empower":return f>0?-5:Math.min(a,2);case"Disrupt":return Math.min(a,2);case"Counter":return a;case"Trap":return h==="nurturing"?-5:f>3?-3:1;case"Energy":return a+1;default:return a}}function Ig(o,a,i,c){var u,f;if(o.subtype==="Covenant")return a>=3?40:-10;let d=10;switch(a){case 0:d+=2;break;case 1:d+=5;break;case 2:d+=8;break;case 3:d+=6;break}if(c==="deceptive"&&a>=1){const g=(f=(u=o.offer)==null?void 0:u.cost)==null?void 0:f.type;g==="exposure"&&(d+=4),g==="binding"&&(d+=3)}return d}function Fg(o,a){let i=8;return o===1&&(i+=3),o===2&&(i+=2),a===0&&(i-=2),i}function Lg(o,a,i){var f,g,h;let c=o+3;i>=6&&(c+=2),i>=10&&(c+=3);const d=[{val:a.structure,start:((f=a.startingValues)==null?void 0:f.structure)||16},{val:a.veil,start:((g=a.startingValues)==null?void 0:g.veil)||14},{val:a.presence,start:((h=a.startingValues)==null?void 0:h.presence)||12}],u=Math.min(...d.map(m=>m.val/m.start));return u<.4&&(c+=5),u<.2&&(c+=5),c}function Wg(o,a,i,c,d){var u,f,g;switch(o.category){case"Strike":{let h=30+(o.power||0)*5;const m=[{name:"vitality",val:i.vitality,start:((u=i.startingValues)==null?void 0:u.vitality)||20},{name:"resolve",val:i.resolve,start:((f=i.startingValues)==null?void 0:f.resolve)||16},{name:"nerve",val:i.nerve,start:((g=i.startingValues)==null?void 0:g.nerve)||16}].sort((w,v)=>w.val-v.val);o.target===m[0].name&&(h+=10);const k=o.keywords||[];return k.includes("Overwhelm")&&(h+=5),k.includes("Drain")&&(h+=3),h}case"Empower":return d.hasStrike?20:-5;case"Offer":case"Test":return-20;case"Reshape":return 2;case"Trap":return 5;case"Counter":case"Disrupt":return 0;default:return 0}}function Vg(o,a,i,c,d,u){switch(o.category){case"Strike":return a*1.5+5;case"Empower":return u.hasStrike?8:1;case"Reshape":return a+5;case"Offer":case"Test":return d>=3?a*.5:-5;case"Counter":case"Disrupt":return a+2;case"Trap":return a+1;default:return a}}const $c={aggressive:{description:"Maximize damage to reducers. Kill-focused.",baseWeights:{Strike:3,Empower:2,Disrupt:1.5,Counter:1.5,Trap:1.5,Offer:0,Reshape:.5,React:1},scoreThreshold:2,preferredTargets:["vitality","nerve"],energyEagerness:.6,comboAwareness:.7},nurturing:{description:"Build Trust toward Bond. Minimize harm. Bond v3.0 trust-tier strategy.",baseWeights:{Strike:.1,Empower:.5,Disrupt:.3,Counter:1,Trap:0,Offer:5,Reshape:3,React:1,Test:4},scoreThreshold:1,preferredTargets:["trust","rapport"],energyEagerness:.5,comboAwareness:.5,bondStrategy:"nurturing"},tactical:{description:"Balanced play. Reads board state. Pivots based on win probability.",baseWeights:{Strike:2,Empower:1.5,Disrupt:2,Counter:2.5,Trap:2,Offer:1,Reshape:2,React:1},scoreThreshold:2,preferredTargets:null,energyEagerness:.7,comboAwareness:.9},deceptive:{description:"Build Trust then betray. Mirrors Nurturing until threshold. Bond v3.0.",baseWeights:{Strike:.1,Empower:.5,Disrupt:.3,Counter:1,Trap:0,Offer:5,Reshape:3,React:1,Test:4},scoreThreshold:1,preferredTargets:["trust","rapport"],energyEagerness:.5,comboAwareness:.8,bondStrategy:"deceptive",betrayalThreshold:6}};function Hg(o){let a,i;if(typeof o=="object"&&o!==null)a=o,i=o._baseName||"custom";else if(i=o,a=$c[i],!a)throw new Error(`Unknown dungeon profile: ${i}. Options: ${Object.keys($c).join(", ")}`);const c={counterCount:0,loopDetected:!1};return{profile:a,history:c,pickCards(d,u,f,g,h){return Kg(d,u,f,g,h,a,c)},selectMemberTarget(d,u){return Gg(d,u,a)}}}function Gg(o,a,i){if(!o.isParty)return null;const c=Object.entries(o.members).filter(([f,g])=>g.status==="active").map(([f,g])=>({key:f,...g}));if(c.length===0)return null;if(c.length===1)return c[0].key;const d=i.targetingWeights||{rolePriority:{support:4,flex:3,dps:2,tank:1},vitalityBias:-1,randomness:0},u=c.map(f=>{const g=d.rolePriority[f.role]||1,h=f.maxVitality?f.vitality/f.maxVitality:1,m=d.vitalityBias<0?(1-h)*Math.abs(d.vitalityBias)*3:h*d.vitalityBias*3;return{key:f.key,weight:g+m}});if(d.randomness>0&&Math.random()<d.randomness){const f=u.reduce((h,m)=>h+Math.max(m.weight,.1),0);let g=Math.random()*f;for(const h of u)if(g-=Math.max(h.weight,.1),g<=0)return h.key;return u[u.length-1].key}return u.sort((f,g)=>g.weight-f.weight),u[0].key}function Ug(o,a,i){var v,T,j,$,D,B;const c=[{val:o.structure,start:((v=o.startingValues)==null?void 0:v.structure)||16},{val:o.veil,start:((T=o.startingValues)==null?void 0:T.veil)||14},{val:o.presence,start:((j=o.startingValues)==null?void 0:j.presence)||12}],d=[{val:a.vitality,start:(($=a.startingValues)==null?void 0:$.vitality)||20},{val:a.resolve,start:((D=a.startingValues)==null?void 0:D.resolve)||16},{val:a.nerve,start:((B=a.startingValues)==null?void 0:B.nerve)||16}],u=Math.min(...c.map(F=>F.val/F.start)),f=Math.min(...d.map(F=>F.val/F.start)),g=c.reduce((F,ie)=>F+ie.val/ie.start,0)/3,h=d.reduce((F,ie)=>F+ie.val/ie.start,0)/3,m=1-f-(1-u),k=g-h,w=Math.min(i/15,1)*.1;return Math.max(0,Math.min(1,.5+m*.3+k*.2+w))}function Qg(o,a,i){const c=(a==null?void 0:a[i])||{};return{reactsPlayed:c.React||0,likelyOutOfReacts:(c.React||0)>=2,countersPlayed:c.Counter||0,likelyOutOfCounters:(c.Counter||0)>=1,strikesPlayed:c.Strike||0,hasActiveEmpower:o.conditions.some(d=>d.type==="empower"),hasActiveDisrupt:o.conditions.some(d=>d.type==="disrupt"),isEntangled:o.conditions.some(d=>d.type==="entangled")}}function Kg(o,a,i,c,d,u,f){var De,ve,Se,Te,we,ze,Be;const g=[...o];g.filter(A=>A.category==="Energy");const h=g.filter(A=>A.category!=="Energy"&&A.category!=="React"),m=h.filter(A=>A.category==="Strike"),k=m.length>0,w=k?Math.max(...m.map(A=>A.power||0)):0;h.some(A=>A.category==="Offer");const v=d.round||1,T=Ug(i,c,v),j=c.side||"visitor",$=Qg(c,d.cardTracker,j);let D="balanced";T>.65?D="conservative":T<.35?D="aggressive":T<.2&&(D="desperate"),((De=d.lastRoundEvents)==null?void 0:De.opponentCountered)||!1?f.counterCount++:f.counterCount=Math.max(0,f.counterCount-1),f.loopDetected=f.counterCount>=2;const F=d.autoResource,ie=[{name:"vitality",val:c.vitality,start:((ve=c.startingValues)==null?void 0:ve.vitality)||20},{name:"resolve",val:c.resolve,start:((Se=c.startingValues)==null?void 0:Se.resolve)||16},{name:"nerve",val:c.nerve,start:((Te=c.startingValues)==null?void 0:Te.nerve)||16}].map(A=>({...A,ratio:A.val/A.start})),ge=[{name:"structure",val:i.structure,start:((we=i.startingValues)==null?void 0:we.structure)||16},{name:"veil",val:i.veil,start:((ze=i.startingValues)==null?void 0:ze.veil)||14},{name:"presence",val:i.presence,start:((Be=i.startingValues)==null?void 0:Be.presence)||12}].map(A=>({...A,ratio:A.val/A.start}));Math.min(...ge.map(A=>A.ratio));let oe=u.preferredTargets;if(!oe){const A=[...ie].map(V=>({...V,depletionScore:V.val+V.start*.3+(V.name===F?5:0)})).sort((V,H)=>V.depletionScore-H.depletionScore);oe=[A[0].name,A[1].name]}u.betrayalThreshold&&c.trust>=u.betrayalThreshold&&(oe=["vitality","nerve"]);const K=ie.filter(A=>A.val>0&&A.val<=3);let Z=!1;return K.length>0&&(Z=!0,oe=[K.sort((A,V)=>A.val-V.val)[0].name,...oe]),Yc(o,a,i,c,{...d,scoreFunction:A=>{var z,b,M,P,O,ue,ce,de;let V=0;const H=u.baseWeights[A.category]||1;if(A.category==="Strike"&&((z=u.preferredTargets)!=null&&z.includes("rapport"))&&(i.rapport||0)>2&&!u.bondStrategy)return 0;let Q=1;if(D==="aggressive"||D==="desperate"?(A.category==="Strike"&&(Q=1.4),A.category==="Empower"&&(Q=1.3),A.category==="Reshape"&&(Q=.3),A.category==="Trap"&&(Q=.5)):D==="conservative"&&(A.category==="Reshape"&&(Q=1.5),A.category==="Counter"&&(Q=1.3),A.category==="Disrupt"&&(Q=1.3),A.category==="Strike"&&(Q=.8)),V+=H*2*Q,V+=(A.power||0)*1.5,A.trigger&&(V+=1),V-=(A.cost||0)*.2,A.category==="Strike"&&A.target){const G=ie.find(se=>se.name===A.target);oe.includes(A.target)&&(V+=3),G&&(G.ratio<.5&&(V+=3),G.ratio<.3&&(V+=2),G.ratio>.9&&oe.includes(A.target)&&(V+=1)),$.likelyOutOfReacts&&(V+=2),A.target===F&&!((b=oe[0])!=null&&b.includes(A.target))&&(V-=1);const te=A.keywords||[];if(te.includes("Entangle")&&!((M=c.conditions)!=null&&M.some(se=>se.type==="entangled"))&&(V+=2),te.includes("Erode")&&(V+=1.5),te.includes("Drain")){const se=A.drainTarget||"presence",ye=ge.find(Ce=>Ce.name===se);ye&&ye.ratio<.7&&(V+=2)}if(te.includes("Overwhelm")&&G&&G.ratio<.3&&(V+=3),(P=A.trigger)!=null&&P.condition&&(A.trigger.condition.type==="has_condition"&&((O=c.conditions)!=null&&O.some(ye=>ye.type===A.trigger.condition.condition))&&(V+=(A.trigger.bonus||2)*1.5),A.trigger.condition.type==="resource_below"&&A.trigger.condition.target==="self")){const se=A.trigger.condition.resource,ye=i[se]||0,Ce=((ue=i.startingValues)==null?void 0:ue[se])||20;ye<=Ce*(A.trigger.condition.pct||.5)&&(V+=(A.trigger.bonus||2)*1.5)}A.selfCost&&((i[A.selfCost.resource]||0)<=A.selfCost.amount*2?V-=3:V+=1),A.exhaust&&!Z&&(V-=1),A.exhaust&&Z&&(V+=2)}if(A.category==="Empower"&&(!k||w<2?V*=.1:V*=.5+w*.25,f.loopDetected&&(V*=.2),$.likelyOutOfCounters||(V*=.7),(ce=A.empowerEffect)!=null&&ce.addKeyword&&(V+=1.5,A.empowerEffect.addKeyword==="Erode"&&(V+=1),A.empowerEffect.addKeyword==="Drain"&&ge.some(G=>G.ratio<.7)&&(V+=1.5)),(de=A.empowerEffect)!=null&&de.retarget&&(V+=1)),A.category==="Disrupt"&&(k?V*=.7+w*.1:V*=.3),A.category==="Counter"){const G=c.conditions.some(se=>se.type==="empower"&&se.placedBy===j),te=i.conditions.some(se=>se.type==="disrupt"&&se.placedBy===j);G||te?(V+=4,G&&(V+=2)):V=0}if(A.category==="Trap"&&((A.trapTrigger==="empower_played"||A.trapTrigger==="strike_played")&&(V+=2),A.trapTrigger==="counter_played"&&(V+=1.5),i.conditions.find(te=>te.type==="trap"&&te.trigger===A.trapTrigger)&&(V=0)),A.category==="Offer"){const G=(c.trust||0)/(d.bondThreshold||12);G>.3&&G<.9&&(V*=1.3),G>=.9&&(V*=1.5),i.conditions.some(se=>se.type==="trap"&&se.trigger==="offer_accepted")&&(V+=3)}if(A.category==="Test"){const G=(i.rapport||0)/(d.bondThreshold||12);V+=3,G>.3&&G<.8&&(V*=1.4),G>=.8&&(V*=1.2),(c.trust||0)<2&&(V*=.7)}return Z&&(A.category==="Strike"&&oe.includes(A.target)&&(V*=1.5),["Empower","Reshape","Trap","Offer"].includes(A.category)&&(V*=.3)),u.bondStrategy&&(V=Ng(A,V,i,c,d,u,{hasStrike:k,round:v})),V},_handHasStrike:k},u)}const jc={feral_aggressive:{description:"Aggressive creature. Fights dungeon directly. Boar-like.",baseWeights:{Strike:3,Empower:2,Disrupt:2,Counter:1,Trap:0,Offer:0,Reshape:0,React:1},scoreThreshold:2,preferredTargets:["structure","presence"],energyEagerness:.8,comboAwareness:.5},cautious_explorer:{description:"Cautious creature. Prefers defense and disruption. Moth-like.",baseWeights:{Strike:1.5,Empower:1,Disrupt:2.5,Counter:2,Trap:1,Offer:1,Reshape:0,React:1},scoreThreshold:1,preferredTargets:["veil","presence"],energyEagerness:.6,comboAwareness:.7},cooperative:{description:"Cooperative creature. Seeks Bond. Symbiote-like.",baseWeights:{Strike:0,Empower:1,Disrupt:.5,Counter:1,Trap:0,Offer:3,Reshape:0,React:1,Test:2.5},scoreThreshold:1,preferredTargets:["trust"],energyEagerness:.5,comboAwareness:.5},party_balanced:{description:"Balanced party of adventurers. Survive-focused with Bond secondary.",baseWeights:{Strike:2.5,Empower:2,Disrupt:1.8,Counter:1.5,React:1.5,Trap:1.5,Offer:.8,Test:.8,Reshape:2,Energy:2},scoreThreshold:1,preferredTargets:["structure","veil","presence"],energyEagerness:.7,comboAwareness:.8}};function qg(o){let a;if(typeof o=="object"&&o!==null)a=o;else if(a=jc[o],!a)throw new Error(`Unknown visitor profile: ${o}. Options: ${Object.keys(jc).join(", ")}`);const i={counterCount:0,loopDetected:!1};return{profile:a,history:i,pickCards(c,d,u,f,g){return Zg(c,d,u,f,g,a,i)}}}function Yg(o,a,i){var v,T,j,$,D,B;const c=[{val:o.vitality,start:((v=o.startingValues)==null?void 0:v.vitality)||20},{val:o.resolve,start:((T=o.startingValues)==null?void 0:T.resolve)||16},{val:o.nerve,start:((j=o.startingValues)==null?void 0:j.nerve)||16}],d=[{val:a.structure,start:(($=a.startingValues)==null?void 0:$.structure)||16},{val:a.veil,start:((D=a.startingValues)==null?void 0:D.veil)||14},{val:a.presence,start:((B=a.startingValues)==null?void 0:B.presence)||12}],u=Math.min(...c.map(F=>F.val/F.start)),f=Math.min(...d.map(F=>F.val/F.start)),g=c.reduce((F,ie)=>F+ie.val/ie.start,0)/3,h=d.reduce((F,ie)=>F+ie.val/ie.start,0)/3,m=1-f-(1-u),k=g-h,w=-Math.min(i/15,1)*.1;return Math.max(0,Math.min(1,.5+m*.3+k*.2+w))}function Xg(o,a){const i=(a==null?void 0:a.dungeon)||{};return{reactsPlayed:i.React||0,likelyOutOfReacts:(i.React||0)>=2,countersPlayed:i.Counter||0,likelyOutOfCounters:(i.Counter||0)>=2,strikesPlayed:i.Strike||0,reshapesPlayed:i.Reshape||0,hasActiveEmpower:o.conditions.some(c=>c.type==="empower"),hasActiveDisrupt:o.conditions.some(c=>c.type==="disrupt"),hasTrapSet:o.conditions.some(c=>c.type==="trap"),hasFortify:o.conditions.some(c=>c.type==="fortify")}}function Zg(o,a,i,c,d,u,f){var Te,we,ze,Be,A,V,H,Q,z,b,M;const g=[...o];g.filter(P=>P.category==="Energy");const m=g.filter(P=>P.category!=="Energy"&&P.category!=="React").filter(P=>P.category==="Strike"),k=m.length>0,w=k?Math.max(...m.map(P=>P.power||0)):0,v=d.round||1,T=Yg(i,c,v),j=Xg(c,d.cardTracker);let $="balanced";T>.65?$="aggressive":T<.35?$="defensive":T<.2&&($="desperate"),(Te=d.stats)!=null&&Te.dStrikesPlayed;const D=((we=d.stats)==null?void 0:we.roundsSinceDungeonStrike)??v,B=i.trust||0;let F=0;D>=5&&B>=3?F=2:D>=3&&B>0&&(F=1),((ze=d.lastRoundEvents)==null?void 0:ze.opponentCountered)||!1?f.counterCount++:f.counterCount=Math.max(0,f.counterCount-1),f.loopDetected=f.counterCount>=2,d.autoResource;const ge=[{name:"structure",val:c.structure,start:((Be=c.startingValues)==null?void 0:Be.structure)||16},{name:"veil",val:c.veil,start:((A=c.startingValues)==null?void 0:A.veil)||14},{name:"presence",val:c.presence,start:((V=c.startingValues)==null?void 0:V.presence)||12}].map(P=>({...P,ratio:P.val/P.start})),oe=[{name:"vitality",val:i.vitality,start:((H=i.startingValues)==null?void 0:H.vitality)||20},{name:"resolve",val:i.resolve,start:((Q=i.startingValues)==null?void 0:Q.resolve)||16},{name:"nerve",val:i.nerve,start:((z=i.startingValues)==null?void 0:z.nerve)||16}].map(P=>({...P,ratio:P.val/P.start}));let K=u.preferredTargets;if(!K||!K[0]){const P=[...ge].sort((O,ue)=>O.ratio-ue.ratio);K=[P[0].name,P[1].name]}const he=(M=(((b=d.encounter)==null?void 0:b.autoEffects)||[]).find(P=>P.target==="dungeon"))==null?void 0:M.resource;if(he){const P=ge.find(O=>O.name===he);P&&P.ratio<.7&&(K.includes(he)||(K=[he,...K]))}const De=ge.filter(P=>P.val>0&&P.val<=3);let ve=!1;return De.length>0&&(ve=!0,K=[De.sort((P,O)=>P.val-O.val)[0].name,...K]),Yc(o,a,i,c,{...d,scoreFunction:P=>{var de,G,te,se,ye,Ce,it,Vt,Qe,$t,kt,jt,sn,gt,St,xt,an;let O=0;const ue=u.baseWeights[P.category]||1;P.category==="Strike"&&F>=2?O*=.1:P.category==="Strike"&&F>=1&&(O*=.4),(P.category==="Offer"||P.category==="Test")&&F>=1&&(O+=5+F*3);let ce=1;if($==="aggressive"?(P.category==="Strike"&&(ce=1.4),P.category==="Empower"&&(ce=1.3),P.category==="Disrupt"&&(ce=.8)):$==="defensive"?(P.category==="Disrupt"&&(ce=1.5),P.category==="Counter"&&(ce=1.3),P.category==="Strike"&&(ce=.7)):$==="desperate"&&(P.category==="Strike"&&(ce=1.6),["Disrupt","Counter","Trap"].includes(P.category)&&(ce=.3)),O+=ue*2*ce,O+=(P.power||0)*1.5,P.trigger&&(O+=1),O-=(P.cost||0)*.2,P.category==="Strike"&&P.target){const Ee=ge.find($e=>$e.name===P.target);K.includes(P.target)&&(O+=3),Ee&&(Ee.ratio<.5&&(O+=3),Ee.ratio<.3&&(O+=2),Ee.ratio>.9&&K.includes(P.target)&&(O+=1)),j.likelyOutOfReacts&&(O+=2),j.hasFortify&&c.conditions.some($e=>$e.type==="fortify"&&$e.resource===P.target)&&(O-=2);const Ke=P.keywords||[];if(Ke.includes("Entangle")&&!((de=c.conditions)!=null&&de.some($e=>$e.type==="entangled"))&&(O+=2),Ke.includes("Erode")&&(O+=1.5),Ke.includes("Drain")){const $e=P.drainTarget||"vitality",Mt=oe.find(At=>At.name===$e);Mt&&Mt.ratio<.7&&(O+=2)}if(Ke.includes("Overwhelm")&&Ee&&Ee.ratio<.3&&(O+=3),(G=P.trigger)!=null&&G.condition&&(P.trigger.condition.type==="has_condition"&&(te=c.conditions)!=null&&te.some($e=>$e.type===P.trigger.condition.condition)&&(O+=(P.trigger.bonus||2)*1.5),P.trigger.condition.type==="resource_below"&&P.trigger.condition.target==="self")){const $e=P.trigger.condition.resource,Mt=i[$e]||0,At=((se=i.startingValues)==null?void 0:se[$e])||20;Mt<=At*(P.trigger.condition.pct||.5)&&(O+=(P.trigger.bonus||2)*1.5)}P.selfCost&&((i[P.selfCost.resource]||0)<=P.selfCost.amount*2?O-=3:O+=1),P.exhaust&&!ve&&(O-=1),P.exhaust&&ve&&(O+=2)}if(P.category==="Empower"&&(!k||w<2?O*=.1:O*=.5+w*.25,f.loopDetected&&(O*=.2),j.likelyOutOfCounters||(O*=.7),(ye=P.empowerEffect)!=null&&ye.addKeyword&&(O+=1.5,P.empowerEffect.addKeyword==="Erode"&&(O+=1),P.empowerEffect.addKeyword==="Drain"&&oe.some(Ee=>Ee.ratio<.7)&&(O+=1.5))),P.category==="Disrupt"&&(k?O*=.7+w*.1:O*=.3),P.category==="Counter"){const Ee=c.conditions.some($e=>$e.type==="empower"&&$e.placedBy==="dungeon"),Ke=i.conditions.some($e=>$e.type==="disrupt"&&$e.placedBy==="dungeon");Ee||Ke?(O+=4,Ee&&(O+=2)):O=0}if(P.category==="Offer"){const Ee=(i.trust||0)/(d.bondThreshold||12);Ee>.3&&Ee<.9&&(O*=1.3),Ee>=.9&&(O*=1.5),j.hasTrapSet&&(O*=.5)}if(P.category==="Test"){const Ee=(i.trust||0)/(d.bondThreshold||12);O+=3,Ee>.3&&Ee<.8&&(O*=1.4),Ee>=.8&&(O*=1.2),(c.rapport||0)<2&&(O*=.7)}if(ve&&(P.category==="Strike"&&K.includes(P.target)&&(O*=1.5),["Empower","Trap","Offer"].includes(P.category)&&(O*=.3)),i.isParty){if((Ce=P.reshapeEffect)!=null&&Ce.restoreMember&&i.knockoutCount>0&&(O+=15),P.category==="Reshape"&&((it=P.reshapeEffect)!=null&&it.heal)&&Object.values(i.members).some(Ke=>Ke.status==="active"&&Ke.vitality<Ke.maxVitality*.3)&&(O+=3),(Vt=P.reshapeEffect)!=null&&Vt.fortify&&i.resolve/(((Qe=i.startingValues)==null?void 0:Qe.resolve)||16)<.5&&(O+=3),((kt=($t=P.trigger)==null?void 0:$t.condition)==null?void 0:kt.type)==="has_condition"){const Ee=P.trigger.condition.condition;(jt=c.conditions)!=null&&jt.some(Ke=>Ke.type===Ee)&&(O+=3)}P.category==="Disrupt"&&j.strikesPlayed>=2&&(O+=1.5),P.category==="Trap"&&v<=3&&(O+=2),P.name&&P.name.includes("Flash Bomb")&&(((gt=(sn=d.cardTracker)==null?void 0:sn.dungeon)==null?void 0:gt.Offer)||0)>0&&(O+=3),P.name&&P.name.includes("Disarm Trap")&&(((xt=(St=d.cardTracker)==null?void 0:St.dungeon)==null?void 0:xt.Trap)||0)>0&&(O+=3),(an=P.counterEffect)!=null&&an.steal&&j.hasActiveEmpower&&(O+=5)}return O},_handHasStrike:k},u)}const Jg={bondThreshold:12};function eh(o,a){return`${o.name} vs ${a}`}function th(o){return`${o.map(i=>Wn(i).name).join("  ")}. Generated by composition engine.`}function nh(o){var m;if(!Array.isArray(o.encounters)||o.encounters.length!==3)throw new Error(`buildScenario requires exactly 3 encounters, got ${((m=o.encounters)==null?void 0:m.length)||0}`);if(new Set(o.encounters).size!==o.encounters.length)throw new Error(`Duplicate encounters not permitted: ${o.encounters.join(", ")}`);if(o.members&&o.creature)throw new Error("Provide either members (party) or creature, not both");if(!o.members&&!o.creature)throw new Error("Provide either members (4 member keys) or creature (creature key)");if(o.members&&o.members.length!==4)throw new Error(`Party requires exactly 4 members, got ${o.members.length}`);const i={...Jg,...o.config||{}},c=o.encounterConfigs||{},d=Gc(o.encounters);let u,f,g;if(o.creature){const k=Op(o.creature);u={name:k.name,vitality:k.vitality,resolve:k.resolve,nerve:k.nerve,trust:k.trust,modifiers:k.modifiers,motivation:k.motivation,aiProfile:k.aiProfile},f=k.deck,g=k.name}else u=Uc(o.members),f=zp(o.members),g=u.name;const h=o.encounters.map(k=>{const w=Wn(k),v=c[k]||{},T={...i,...v};return{encounter:{name:w.name,description:w.description,initiative:w.initiative,autoEffects:w.autoEffects,tags:w.tags},dungeonDeck:w.deck,visitorDeck:f,config:T}});return{name:o.name||eh(d,g),description:o.description||th(o.encounters),visitorTemplate:u,dungeonTemplate:d,encounters:h}}function td(o){const a={},i={},c={},d={},u={};let f=0,g=0,h=0;for(const m of o){const k=m.category||"Unknown";if(a[k]=(a[k]||0)+1,m.type&&(d[m.type]=(d[m.type]||0)+1),m.target&&(c[m.target]=(c[m.target]||0)+1,["Strike","Disrupt","Trap"].includes(k)&&(i[m.target]=(i[m.target]||0)+1,h++)),m.keywords)for(const w of m.keywords)u[w]=(u[w]||0)+1;f+=m.cost||0,g+=m.power||0}return{categoryCounts:a,targetCounts:i,allTargetCounts:c,typeCounts:d,keywordCounts:u,avgCost:o.length>0?f/o.length:0,avgPower:h>0?g/h:0,cardCount:o.length,offensiveCards:h}}const Mc={aggressive:{description:"Maximize damage to reducers. Kill-focused.",baseWeights:{Strike:3,Empower:2,Disrupt:1.5,Counter:1.5,Trap:1.5,Offer:0,Reshape:.5,React:1},scoreThreshold:2,preferredTargets:["vitality","nerve"],energyEagerness:.6,comboAwareness:.7,targetingIntent:"kill_weakest"},nurturing:{description:"Build Trust toward Bond. Minimize harm. Bond v3.0 trust-tier strategy.",baseWeights:{Strike:.1,Empower:.5,Disrupt:.3,Counter:1,Trap:0,Offer:5,Reshape:3,React:1,Test:4},scoreThreshold:1,preferredTargets:["trust","rapport"],energyEagerness:.5,comboAwareness:.5,bondStrategy:"nurturing",targetingIntent:"protect_weakest"},tactical:{description:"Balanced play. Reads board state. Pivots based on win probability.",baseWeights:{Strike:2,Empower:1.5,Disrupt:2,Counter:2.5,Trap:2,Offer:1,Reshape:2,React:1},scoreThreshold:2,preferredTargets:null,energyEagerness:.7,comboAwareness:.9,targetingIntent:"highest_value"},deceptive:{description:"Build Trust then betray. Mirrors Nurturing until threshold. Bond v3.0.",baseWeights:{Strike:.1,Empower:.5,Disrupt:.3,Counter:1,Trap:0,Offer:5,Reshape:3,React:1,Test:4},scoreThreshold:1,preferredTargets:["trust","rapport"],energyEagerness:.5,comboAwareness:.8,bondStrategy:"deceptive",betrayalThreshold:6,targetingIntent:"unpredictable"}};function rh(o,a){const i=Mc[a];if(!i)throw new Error(`Unknown base profile: "${a}". Valid: ${Object.keys(Mc).join(", ")}`);const c=o.map(B=>{const F=Wn(B);return{key:B,analysis:td(F.deck),autoEffects:F.autoEffects||[]}}),d=sh(c.map(B=>B.analysis)),u=i.bondStrategy==="nurturing"||i.bondStrategy==="deceptive";let f;u?f=i.preferredTargets:i.preferredTargets===null?f=ro(d.targetCounts):f=nd(i.preferredTargets,d.targetCounts);const g=rd(i.baseWeights,d.categoryCounts,d.cardCount),h=d.avgCost/2,m=wi(i.energyEagerness*(.7+.3*h),.3,.95),k=(d.categoryCounts.Empower||0)>0,w=(d.categoryCounts.Strike||0)>0,v=(d.categoryCounts.Trap||0)>0&&(d.categoryCounts.Offer||0)>0;let T=i.comboAwareness;(!k||!w)&&(T*=.5),v&&(T=Math.max(T,.7));const j=[];for(const B of c)for(const F of B.autoEffects)F.target==="visitor"&&F.resource&&j.push(F.resource);const $=u?ro(d.targetCounts):f,D=ah(i.targetingIntent);return{description:`${i.description} [${o.join("+")}]`,baseWeights:g,scoreThreshold:i.scoreThreshold,preferredTargets:f,energyEagerness:m,comboAwareness:wi(T,.3,.95),bondStrategy:i.bondStrategy||null,betrayalThreshold:i.betrayalThreshold||null,deckProfile:{categoryCounts:d.categoryCounts,targetCounts:d.targetCounts,typeCounts:d.typeCounts,avgCost:d.avgCost,avgPower:d.avgPower,autoDrainTargets:j,combatTargets:$},targetingWeights:D,targetingIntent:i.targetingIntent,_baseName:a,_encounters:o,_inferred:!0}}const oh={feral_aggressive:{description:"Aggressive creature. Fights dungeon directly.",baseWeights:{Strike:3,Empower:2,Disrupt:2,Counter:1,Trap:0,Offer:0,Reshape:0,React:1},scoreThreshold:2,preferredTargets:["structure","presence"],energyEagerness:.8,comboAwareness:.5},cautious_explorer:{description:"Cautious creature. Prefers defense and disruption.",baseWeights:{Strike:1.5,Empower:1,Disrupt:2.5,Counter:2,Trap:1,Offer:1,Reshape:0,React:1},scoreThreshold:1,preferredTargets:["veil","presence"],energyEagerness:.6,comboAwareness:.7},cooperative:{description:"Cooperative creature. Seeks Bond.",baseWeights:{Strike:.5,Empower:1,Disrupt:.5,Counter:1,Trap:0,Offer:3,Reshape:0,React:1,Test:2.5},scoreThreshold:1,preferredTargets:["trust"],energyEagerness:.5,comboAwareness:.5},party_balanced:{description:"Balanced party of adventurers. Survive-focused with Bond secondary.",baseWeights:{Strike:2.5,Empower:2,Disrupt:1.8,Counter:1.5,React:1.5,Trap:1.5,Offer:.8,Test:.8,Reshape:2,Energy:2},scoreThreshold:1,preferredTargets:["structure","veil","presence"],energyEagerness:.7,comboAwareness:.8}};function ih(o,a="party_balanced"){const i=oh[a];if(!i)throw new Error(`Unknown visitor base profile: "${a}"`);const c=[];for(const v of o){const T=Hc(v);c.push(...T)}const d=td(c),u=i.preferredTargets===null?ro(d.targetCounts):nd(i.preferredTargets,d.targetCounts),f=rd(i.baseWeights,d.categoryCounts,d.cardCount),g=d.avgCost/2,h=wi(i.energyEagerness*(.7+.3*g),.3,.95),m=(d.categoryCounts.Empower||0)>0,k=(d.categoryCounts.Strike||0)>0;let w=i.comboAwareness;return(!m||!k)&&(w*=.5),{description:`${i.description} [${o.join("+")}]`,baseWeights:f,scoreThreshold:i.scoreThreshold,preferredTargets:u,energyEagerness:h,comboAwareness:wi(w,.3,.95),deckProfile:{categoryCounts:d.categoryCounts,targetCounts:d.targetCounts,typeCounts:d.typeCounts,avgCost:d.avgCost,avgPower:d.avgPower},_baseName:a,_members:o,_inferred:!0}}function sh(o){const a={categoryCounts:{},targetCounts:{},allTargetCounts:{},typeCounts:{},keywordCounts:{},cardCount:0,offensiveCards:0};let i=0,c=0;for(const d of o){for(const[u,f]of Object.entries(d.categoryCounts))a.categoryCounts[u]=(a.categoryCounts[u]||0)+f;for(const[u,f]of Object.entries(d.targetCounts))a.targetCounts[u]=(a.targetCounts[u]||0)+f;for(const[u,f]of Object.entries(d.allTargetCounts||{}))a.allTargetCounts[u]=(a.allTargetCounts[u]||0)+f;for(const[u,f]of Object.entries(d.typeCounts||{}))a.typeCounts[u]=(a.typeCounts[u]||0)+f;for(const[u,f]of Object.entries(d.keywordCounts||{}))a.keywordCounts[u]=(a.keywordCounts[u]||0)+f;i+=d.avgCost*d.cardCount,c+=d.avgPower*d.offensiveCards,a.cardCount+=d.cardCount,a.offensiveCards+=d.offensiveCards}return a.avgCost=a.cardCount>0?i/a.cardCount:0,a.avgPower=a.offensiveCards>0?c/a.offensiveCards:0,a}function ro(o){const a=Object.entries(o).sort((i,c)=>c[1]-i[1]).map(([i])=>i);return a.length>0?a.slice(0,2):null}function nd(o,a){if(!o||o.length===0)return ro(a);const i=ro(a);if(!i)return o;const c=[];for(const d of o)if(a[d]&&a[d]>0)c.push(d);else{const u=i.find(f=>!c.includes(f)&&!o.includes(f));u?c.push(u):c.push(d)}return c}function rd(o,a,i){const c={...o};if(i===0)return c;for(const d of Object.keys(c)){const u=a[d]||0,f=u/i;u===0&&c[d]>0?c[d]*=.1:f>=.25?c[d]*=1.15:f>=.15||u>0&&f<.08&&(c[d]*=.8)}for(const d of Object.keys(c))c[d]=Math.round(c[d]*100)/100;return c}function ah(o){switch(o){case"kill_weakest":return{rolePriority:{tank:1,dps:1,flex:1,support:1},vitalityBias:-1,randomness:0};case"highest_value":return{rolePriority:{support:4,flex:3,dps:2,tank:1},vitalityBias:-.3,randomness:0};case"protect_weakest":return{rolePriority:{tank:1,dps:1,flex:1,support:1},vitalityBias:1,randomness:0};case"unpredictable":return{rolePriority:{flex:3,support:2.5,dps:1.5,tank:1},vitalityBias:-.3,randomness:.6};default:return{rolePriority:{tank:1,dps:1,flex:1,support:1},vitalityBias:-1,randomness:0}}}function wi(o,a,i){return Math.max(a,Math.min(i,o))}const U={void:"#080c14",deep:"#0e1420",surface:"#1e2a3e",text:"#e8ecf2",sub:"#c0c8d8",muted:"#90a0b8",dim:"#6880a0",border:"#283848",accent:"#3dccb4",accentGlow:"#55eedd"},ka={Strike:"#ee5544",Empower:"#eecc33",Disrupt:"#ee8833",Counter:"#55aaee",React:"#9977cc",Trap:"#cc5588",Offer:"#44ccaa",Reshape:"#55bb77",Energy:"#eebb44",Test:"#99aabb"},lh={structure:"#5599cc",veil:"#9966cc",presence:"#cc9933",rapport:"#44ccaa",vitality:"#ee5555",resolve:"#eebb33",nerve:"#9966cc",trust:"#44ccaa"},Ac=["aggressive","tactical","nurturing","deceptive"];function gi({label:o,value:a,max:i,color:c,delta:d,dk:u}){const f=i>0?Math.max(0,Math.min(100,a/i*100)):0,g=lh[c]||"#888";return y.jsxs("div",{style:{marginBottom:4,position:"relative"},children:[y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:1},children:[y.jsx("span",{style:{fontSize:11,color:U.muted,textTransform:"uppercase",letterSpacing:"0.5px"},children:o}),y.jsxs("span",{style:{fontSize:12,color:U.text,fontWeight:700,fontFamily:"monospace"},children:[a,"/",i]})]}),y.jsx("div",{style:{height:10,background:"#060a10",borderRadius:3,overflow:"hidden",border:`1px solid ${g}22`},children:y.jsx("div",{style:{height:"100%",width:`${f}%`,background:g,borderRadius:2,transition:"width 0.6s ease-out"}})}),d!=null&&d!==0&&y.jsx(Ca,{d},u)]})}function Ca({d:o}){const[a,i]=pe.useState(!0);if(pe.useEffect(()=>{const d=setTimeout(()=>i(!1),1200);return()=>clearTimeout(d)},[]),!a)return null;const c=o<0?"#ff5555":"#55ff99";return y.jsxs("span",{style:{position:"absolute",right:0,top:-4,fontSize:16,fontWeight:800,color:c,fontFamily:"monospace",pointerEvents:"none",animation:"fUp 1.2s ease-out forwards",textShadow:`0 0 8px ${c}`},children:[o>0?"+":"",o]})}function Oc({avail:o,base:a,delta:i,dk:c}){return y.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"4px 14px",background:"#1a1608",border:"1px solid #eebb4433",borderRadius:20,position:"relative"},children:[y.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:"#eebb44",boxShadow:"0 0 8px #eebb44"}}),y.jsx("span",{style:{fontSize:15,color:"#eebb44",fontWeight:800,fontFamily:"monospace"},children:o}),y.jsxs("span",{style:{fontSize:10,color:U.dim},children:["/",a," EN"]}),i!=null&&i!==0&&y.jsx(Ca,{d:i},c)]})}const uh={entangled:{i:"",l:"Entangled",c:"#66cc66"},fortify:{i:"",l:"Fortify",c:"#6699dd"},guarded:{i:"",l:"Guarded",c:"#6699dd"},empower:{i:"",l:"Empowered",c:"#eedd44"},disrupt:{i:"",l:"Disrupted",c:"#ee7744"},trap:{i:"",l:"Trap",c:"#cc5588"},erode:{i:"",l:"Erode",c:"#ee4444"},attune:{i:"",l:"Attune",c:"#88ee88"},binding:{i:"",l:"Binding",c:"#aa8844"},betrayed:{i:"",l:"Betrayed",c:"#ee3333"}};function zc({conds:o}){if(!(o!=null&&o.length))return null;const a={};for(const i of o)a[i.type]=(a[i.type]||0)+1;return y.jsx("div",{style:{display:"flex",gap:3,flexWrap:"wrap"},children:Object.entries(a).map(([i,c])=>{const d=uh[i]||{i:"",l:i,c:U.muted};return y.jsxs("span",{style:{fontSize:10,padding:"1px 6px",borderRadius:10,background:`${d.c}18`,color:d.c,border:`1px solid ${d.c}30`},children:[d.i," ",d.l,c>1?` ${c}`:""]},i)})})}function Nc({members:o,deltas:a,dk:i}){return o?y.jsx("div",{style:{display:"flex",gap:5,flexWrap:"wrap",marginTop:3},children:Object.entries(o).map(([c,d])=>{const u=d.maxVitality>0?d.vitality/d.maxVitality*100:0,f=d.status==="knocked_out",g=a==null?void 0:a[`member.${c}`];return y.jsxs("div",{style:{flex:"1 1 80px",padding:"3px 6px",background:f?"#120808":"#0e1018",border:`1px solid ${f?"#442222":"#1e2233"}`,borderRadius:3,opacity:f?.35:1,position:"relative"},children:[y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:1},children:[y.jsx("span",{style:{fontSize:9,color:f?"#994444":U.sub},children:d.name}),y.jsx("span",{style:{fontSize:9,color:U.muted,fontFamily:"monospace"},children:f?"KO":`${d.vitality}/${d.maxVitality}`})]}),y.jsx("div",{style:{height:4,background:"#060810",borderRadius:2,overflow:"hidden"},children:y.jsx("div",{style:{height:"100%",width:`${u}%`,background:f?"#442222":u>50?"#66cc66":u>25?"#ccbb44":"#ee4444",transition:"width 0.5s",borderRadius:2}})}),g&&g.delta!==0&&y.jsx(Ca,{d:g.delta},i)]},c)})}):null}function ch({card:o,queueIdx:a,onSelect:i,disabled:c}){var T,j;const[d,u]=pe.useState(!1),[f,g]=pe.useState({x:0,y:0}),h=pe.useRef(null),m=ka[o.category]||U.muted,k=a!=null,w=o.category==="React",v=()=>{if(u(!0),h.current){const $=h.current.getBoundingClientRect();g({x:Math.max(8,Math.min($.left+$.width/2-155,window.innerWidth-320)),y:Math.max(8,$.top-6)})}};return y.jsxs(y.Fragment,{children:[y.jsxs("div",{ref:h,onMouseEnter:v,onMouseLeave:()=>u(!1),onClick:()=>{!c&&!w&&i(o)},style:{width:150,minHeight:160,padding:"8px 10px",flexShrink:0,background:k?`${m}22`:d?U.surface:U.deep,border:`2px solid ${k?m:d?`${m}55`:"#1a2535"}`,borderRadius:6,cursor:c||w?"default":"pointer",opacity:c?.25:w?.65:1,transform:k?"translateY(-12px)":d&&!c?"translateY(-4px)":"none",boxShadow:k?`0 8px 24px ${m}30`:"none",transition:"all 0.15s",position:"relative"},children:[k&&y.jsx("div",{style:{position:"absolute",top:-11,right:-7,width:26,height:26,borderRadius:"50%",background:m,color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:900},children:a+1}),w&&y.jsx("div",{style:{position:"absolute",top:3,right:3,fontSize:8,padding:"1px 5px",background:`${m}30`,color:m,borderRadius:8},children:"HELD"}),y.jsx("div",{style:{height:3,background:m,borderRadius:2,marginBottom:5}}),y.jsx("div",{style:{fontSize:13,fontWeight:700,color:U.text,lineHeight:1.2,marginBottom:3},children:o.name}),y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[y.jsx("span",{style:{fontSize:10,color:m,textTransform:"uppercase",fontWeight:600},children:o.category}),o.cost>0&&y.jsxs("span",{style:{fontSize:12,color:"#eebb44",fontWeight:800},children:["",o.cost]})]}),o.power!=null&&y.jsxs("div",{style:{fontSize:11,color:U.sub},children:["Power ",o.power,"  ",o.target]}),((T=o.keywords)==null?void 0:T.length)>0&&y.jsx("div",{style:{fontSize:9,color:`${m}bb`,marginTop:2},children:o.keywords.join("  ")}),y.jsx("div",{style:{fontSize:10,color:U.muted,lineHeight:1.3,marginTop:4,maxHeight:52,overflow:"hidden"},children:o.description})]}),d&&y.jsxs("div",{style:{position:"fixed",left:f.x,bottom:window.innerHeight-f.y,width:310,padding:14,zIndex:300,pointerEvents:"none",background:"#0a1018",border:`1px solid ${m}66`,borderRadius:8,boxShadow:`0 -6px 30px rgba(0,0,0,0.9), 0 0 20px ${m}15`},children:[y.jsx("div",{style:{height:3,background:m,borderRadius:2,marginBottom:8}}),y.jsx("div",{style:{fontSize:17,fontWeight:800,color:U.text,marginBottom:4},children:o.name}),y.jsxs("div",{style:{display:"flex",gap:8,marginBottom:6},children:[y.jsx("span",{style:{fontSize:12,color:m,textTransform:"uppercase",fontWeight:700},children:o.category}),o.type&&y.jsx("span",{style:{fontSize:11,color:U.sub},children:o.type}),o.cost>0&&y.jsxs("span",{style:{fontSize:13,color:"#eebb44",fontWeight:800},children:["",o.cost]})]}),o.power!=null&&y.jsxs("div",{style:{fontSize:13,color:U.sub,marginBottom:4},children:["Power ",o.power,"  ",o.target]}),((j=o.keywords)==null?void 0:j.length)>0&&y.jsx("div",{style:{fontSize:12,color:`${m}dd`,marginBottom:6},children:o.keywords.join("  ")}),y.jsx("div",{style:{fontSize:13,color:U.sub,lineHeight:1.5},children:o.description||"No description."}),o.member&&y.jsxs("div",{style:{fontSize:10,color:U.dim,marginTop:8,fontStyle:"italic"},children:["From: ",o.member]})]})]})}function dh({selectedQueue:o,currentEvent:a,round:i,resolvedCards:c}){var d;if(o.length>0)return y.jsx("div",{style:{display:"flex",gap:12,flexWrap:"wrap",justifyContent:"center",alignItems:"center",padding:16},children:o.map((u,f)=>{const g=ka[u.card.category]||U.muted;return y.jsxs("div",{style:{width:180,padding:12,background:`${g}12`,border:`1px solid ${g}44`,borderRadius:8,boxShadow:`0 4px 16px ${g}15`},children:[y.jsx("div",{style:{height:3,background:g,borderRadius:2,marginBottom:6}}),y.jsx("div",{style:{fontSize:14,fontWeight:700,color:U.text,marginBottom:3},children:u.card.name}),y.jsxs("div",{style:{display:"flex",gap:6,marginBottom:4},children:[y.jsx("span",{style:{fontSize:10,color:g,textTransform:"uppercase",fontWeight:600},children:u.card.category}),u.card.cost>0&&y.jsxs("span",{style:{fontSize:11,color:"#eebb44",fontWeight:700},children:["",u.card.cost]})]}),y.jsx("div",{style:{fontSize:11,color:U.sub,lineHeight:1.4},children:u.card.description}),y.jsxs("div",{style:{fontSize:10,color:U.dim,marginTop:4},children:["Play order: #",f+1]})]},f)})});if((a==null?void 0:a.type)==="card_played"){const{card:u,side:f,action:g}=a.data,h=ka[u==null?void 0:u.category]||U.muted,m=f==="dungeon"?" DUNGEON":" VISITOR",k=g==="energy"?"Powers Up":g==="activate"?"Activates":g==="restrain"?"Restrains":"Plays";return y.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[y.jsxs("div",{style:{fontSize:12,color:f==="dungeon"?"#88bbee":"#eeaa44",textTransform:"uppercase",letterSpacing:"3px",fontWeight:700},children:[m,"  ",k]}),y.jsxs("div",{style:{width:260,padding:16,background:`${h}10`,border:`2px solid ${h}44`,borderRadius:10,boxShadow:`0 0 30px ${h}12`},children:[y.jsx("div",{style:{height:3,background:h,borderRadius:2,marginBottom:8}}),y.jsx("div",{style:{fontSize:18,fontWeight:800,color:U.text,marginBottom:4},children:u==null?void 0:u.name}),y.jsxs("div",{style:{display:"flex",gap:8,marginBottom:6},children:[y.jsx("span",{style:{fontSize:11,color:h,textTransform:"uppercase",fontWeight:700},children:u==null?void 0:u.category}),(u==null?void 0:u.power)!=null&&y.jsxs("span",{style:{fontSize:12,color:U.sub},children:["Power ",u.power]}),(u==null?void 0:u.target)&&y.jsxs("span",{style:{fontSize:12,color:U.muted},children:[" ",u.target]})]}),((d=u==null?void 0:u.keywords)==null?void 0:d.length)>0&&y.jsx("div",{style:{fontSize:11,color:`${h}cc`,marginBottom:4},children:u.keywords.join("  ")}),y.jsx("div",{style:{fontSize:12,color:U.sub,lineHeight:1.5,marginBottom:8},children:u==null?void 0:u.description}),y.jsx(Bc,{lines:a.logLines})]}),y.jsx(Ic,{changes:a.resourceChanges})]})}return(a==null?void 0:a.type)==="auto_effects"?y.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[y.jsx("div",{style:{fontSize:13,color:"#eeaa44",textTransform:"uppercase",letterSpacing:"3px",fontWeight:700},children:" Environment"}),y.jsx(Bc,{lines:a.logLines}),y.jsx(Ic,{changes:a.resourceChanges})]}):(a==null?void 0:a.type)==="encounter_start"?y.jsxs("div",{style:{padding:20,textAlign:"center"},children:[y.jsx("div",{style:{fontSize:22,fontWeight:800,color:U.text,marginBottom:8},children:a.data.name}),y.jsx("div",{style:{fontSize:13,color:U.sub,marginBottom:6},children:a.data.description}),y.jsxs("div",{style:{fontSize:12,color:U.dim},children:["Initiative: ",a.data.initiative]})]}):(a==null?void 0:a.type)==="turn_start"?y.jsx("div",{style:{padding:20,textAlign:"center"},children:y.jsx("div",{style:{fontSize:16,fontWeight:700,color:a.data.isHuman?U.accent:"#eeaa44"},children:a.data.isHuman?" Your turn  select cards below":" Opponent is deciding..."})}):y.jsx("div",{style:{padding:20,textAlign:"center"},children:y.jsx("div",{style:{fontSize:15,color:U.dim},children:i>0?`Round ${i}`:"..."})})}function Bc({lines:o}){return o!=null&&o.length?y.jsx("div",{style:{width:"100%",maxWidth:400},children:o.slice(-8).map((a,i)=>y.jsx("div",{style:{fontSize:12,fontFamily:"monospace",lineHeight:1.7,color:a.includes(">>>")||a.includes("")?"#ff6655":a.includes("")?"#eebb44":a.includes("")?U.accent:U.sub},children:a.trim()},i))}):null}function Ic({changes:o}){return!o||Object.keys(o).length===0?null:y.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",justifyContent:"center"},children:Object.entries(o).map(([a,i])=>{if(a.startsWith("member."))return null;const c=a.split(".")[1],d=i.delta<0?"#ff5555":"#55ff99";return y.jsxs("span",{style:{fontSize:14,fontWeight:800,color:d,fontFamily:"monospace",padding:"2px 10px",background:`${d}10`,borderRadius:4},children:[c," ",i.delta>0?"+":"",i.delta]},a)})})}function fh({entries:o}){const a=pe.useRef(null);return pe.useEffect(()=>{var i;(i=a.current)==null||i.scrollIntoView({behavior:"smooth"})},[o.length]),y.jsxs("div",{style:{flex:1,overflow:"auto",padding:"8px 12px",fontFamily:"monospace"},children:[o.map((i,c)=>{const d=i.includes("")&&i.includes("Round"),u=i.includes("");return y.jsx("div",{style:{fontSize:12,lineHeight:1.8,fontWeight:d||u?800:400,color:u?U.text:d?"#66bbee":i.includes(">>>")||i.includes("")?"#ff6655":i.includes("")?"#eeaa44":i.includes("")?"#eebb44":i.includes("")?"#ee5544":i.includes("")?"#eecc33":i.includes("")?U.accent:i.includes("")?"#ee8833":U.sub,borderTop:d?`1px solid ${U.border}`:"none",paddingTop:d?8:0,marginTop:d?6:0},children:i},c)}),y.jsx("div",{ref:a})]})}function ph({outcome:o,playerSide:a,onExit:i,onNext:c,canNext:d}){if(!o)return null;const u=o.winner===a||o.winner==="both",f=o.winner==="both",g=f?"#44ccaa":u?"#44cc66":"#cc4444";return y.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:200},children:y.jsxs("div",{style:{padding:"44px 64px",background:U.deep,border:`2px solid ${g}`,borderRadius:14,textAlign:"center",maxWidth:480,boxShadow:`0 0 80px ${g}20`},children:[y.jsx("div",{style:{fontSize:44,marginBottom:14},children:f?"":u?"":""}),y.jsx("div",{style:{fontSize:28,fontWeight:800,color:g,marginBottom:8},children:f?"Bond Achieved":u?"Victory":"Defeat"}),y.jsx("div",{style:{fontSize:15,color:U.sub,marginBottom:4},children:o.condition}),y.jsx("div",{style:{fontSize:13,color:U.muted,marginBottom:32},children:o.desc}),y.jsxs("div",{style:{display:"flex",gap:14,justifyContent:"center"},children:[d&&y.jsx("button",{onClick:c,style:{padding:"12px 36px",background:g,border:"none",color:"#000",borderRadius:6,cursor:"pointer",fontSize:16,fontWeight:800},children:"Next Room "}),y.jsx("button",{onClick:i,style:{padding:"12px 28px",background:"transparent",border:`1px solid ${U.border}`,color:U.muted,borderRadius:6,cursor:"pointer",fontSize:14},children:"Return to Menu"})]})]})})}function gh({members:o,selected:a,onSelect:i}){return o?y.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",padding:"6px 16px",background:`${U.surface}60`},children:[y.jsx("span",{style:{fontSize:11,color:U.muted},children:"Target:"}),Object.entries(o).map(([c,d])=>{const u=d.status==="knocked_out",f=a===c;return y.jsxs("button",{onClick:()=>!u&&i(c),style:{padding:"3px 10px",fontSize:11,borderRadius:4,cursor:u?"default":"pointer",background:f?"#ee555533":"transparent",border:`1px solid ${f?"#ee5555":u?"#333":U.border}`,color:u?"#555":f?"#ff8888":U.sub,fontWeight:f?700:400,opacity:u?.3:1},children:[d.name," (",d.vitality,"/",d.maxVitality,")"]},c)})]}):null}function hh({playerSide:o,playerSelections:a,onExit:i}){var an,Ee,Ke,$e,Mt,At;const c=o==="dungeon",d=pe.useRef(null),u=pe.useRef(!1),f=pe.useRef(!0),[g,h]=pe.useState("loading"),[m,k]=pe.useState(0),[w,v]=pe.useState(null),[T,j]=pe.useState(null),[$,D]=pe.useState({}),[B,F]=pe.useState(0),[ie,ge]=pe.useState(null),[oe,K]=pe.useState(0),[Z,he]=pe.useState(""),[De,ve]=pe.useState([]),[Se,Te]=pe.useState([]),[we,ze]=pe.useState(!1),[Be,A]=pe.useState(!1),[V,H]=pe.useState([]),[Q,z]=pe.useState(null),[b,M]=pe.useState(null);pe.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]),pe.useEffect(()=>{u.current=!1;try{const J=Object.keys(to),_e=Object.keys(no);let Re,ht;c?(Re=a,ht=Rc("visitor",J,_e).members):(ht=a,Re=Rc("dungeon",J,_e).encounters);const Et=nh({encounters:Re,members:ht});z(Et);const Yt=Ac[Math.floor(Math.random()*Ac.length)],Vn=Hg(rh(Re,Yt)),ln=qg(ih(ht)),Ht=new Pg(Et,o,{});d.current=Ht,Ht.startEncounter(0,Vn,ln),he(Et.encounters[0].encounter.name),h("running"),P(Ht)}catch(J){console.error("Init error:",J),h("error"),H(_e=>[..._e,`ERROR: ${J.message}`])}},[]);const P=pe.useCallback(async J=>{var _e,Re,ht,Et,Yt,Vn,ln,Ht;if(J||(J=d.current),!(!J||u.current)){u.current=!0,A(!0);try{for(;J.getPhase()!=="encounter_over"&&!(!f.current||d.current!==J);){const be=J.nextStep();if(!be)break;if(j(be),be.stateSnapshot&&v(be.stateSnapshot),be.resourceChanges&&Object.keys(be.resourceChanges).length>0&&(D(be.resourceChanges),F(Ot=>Ot+1)),(_e=be.data)!=null&&_e.round&&k(be.data.round),(Re=be.logLines)!=null&&Re.length&&H(Ot=>[...Ot,...be.logLines]),be.type==="encounter_end"||(ht=be.data)!=null&&ht.outcome||(Et=be.data)!=null&&Et.winCondition){ge(((Yt=be.data)==null?void 0:Yt.outcome)||((Vn=be.data)==null?void 0:Vn.winCondition)||J.getOutcome()),h("encounter_over");break}if(be.awaitingInput){if(d.current!==J)return;const Ot=((ln=be.data)==null?void 0:ln.hand)||[];ve([...Ot]),Te([]),ze(!0),A(!1),u.current=!1;return}const hr=be.type==="card_played"?((Ht=be.data)==null?void 0:Ht.side)!==o?2400:1800:be.type==="auto_effects"?1200:be.type==="round_start"||be.type==="round_end"?800:400;if(await new Promise(Ot=>setTimeout(Ot,hr)),!f.current||d.current!==J)break;D({})}if(d.current===J){const be=J.getOutcome();be&&!ie&&(ge(be),h("encounter_over"))}}finally{d.current===J&&(A(!1),u.current=!1)}}},[o,ie]),O=pe.useCallback(J=>{Te(_e=>{const Re=_e.findIndex(Et=>Et.card===J);if(Re>=0)return _e.filter((Et,Yt)=>Yt!==Re);const ht=J.category==="Energy"?"energy":"play";return[..._e,{card:J,action:ht}]})},[]),ue=pe.useCallback(()=>{const J=d.current;!J||!we||(J.submitCardSelections(Se),Te([]),ze(!1),D({}),P(J))},[we,Se,P]),ce=pe.useCallback(()=>{const J=d.current;!J||!we||(J.submitCardSelections([]),Te([]),ze(!1),D({}),P(J))},[we,P]),de=pe.useCallback(()=>{const J=d.current;J&&J.advanceToNextEncounter()&&(ge(null),K(J.getEncounterIndex()),he(J.scenario.encounters[J.getEncounterIndex()].encounter.name),k(0),h("running"),H(_e=>[..._e,"","",""]),P(J))},[P]),G=c?"visitor":"dungeon",te=c?w==null?void 0:w.visitor:w==null?void 0:w.dungeon,se=c?w==null?void 0:w.dungeon:w==null?void 0:w.visitor,ye=Q==null?void 0:Q.dungeonTemplate,Ce=Q==null?void 0:Q.visitorTemplate,it=pe.useMemo(()=>!ye||!Ce?{}:c?{vitality:Ce.type==="party"?Object.values(Ce.members||{}).reduce((_e,Re)=>_e+Re.vitality,0):Ce.vitality||20,resolve:Ce.resolve||14,nerve:Ce.nerve||16}:{structure:ye.structure||16,veil:ye.veil||14,presence:ye.presence||12},[c,ye,Ce]),Vt=pe.useMemo(()=>!ye||!Ce?{}:c?{structure:ye.structure||16,veil:ye.veil||14,presence:ye.presence||12}:{vitality:Ce.type==="party"?Object.values(Ce.members||{}).reduce((_e,Re)=>_e+Re.vitality,0):Ce.vitality||20,resolve:Ce.resolve||14,nerve:Ce.nerve||16},[c,ye,Ce]),Qe=c?[["vitality","Vitality"],["resolve","Resolve"],["nerve","Nerve"]]:[["structure","Structure"],["veil","Veil"],["presence","Presence"]],$t=c?[["structure","Structure"],["veil","Veil"],["presence","Presence"]]:[["vitality","Vitality"],["resolve","Resolve"],["nerve","Nerve"]],kt=c?"trust":"rapport",jt=c?"rapport":"trust",sn=oe<(((an=Q==null?void 0:Q.encounters)==null?void 0:an.length)||3)-1&&ie&&ie.condition!=="Bond";if(g==="loading")return y.jsx("div",{style:{height:"100vh",background:U.void,display:"flex",alignItems:"center",justifyContent:"center",color:U.muted,fontSize:16},children:"Building encounter..."});if(g==="error")return y.jsxs("div",{style:{height:"100vh",background:U.void,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:16},children:[y.jsx("div",{style:{color:"#ee4444",fontSize:16},children:"Failed to initialize"}),y.jsx("button",{onClick:i,style:{padding:"8px 24px",background:U.surface,border:`1px solid ${U.border}`,color:U.sub,borderRadius:4,cursor:"pointer"},children:"Back"})]});let gt=0;for(const J of Se)J.action==="play"&&(gt+=J.card.cost||0),J.action==="energy"&&(gt-=1);const St=w?c?w.dEnergy:w.vEnergy:{available:0},xt=St.available-gt;return y.jsxs("div",{style:{height:"100vh",overflow:"hidden",background:U.void,color:U.text,display:"flex",flexDirection:"column",position:"relative"},children:[y.jsx("style",{children:"@keyframes fUp{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-24px)}}@keyframes pulse{0%,100%{opacity:.4}50%{opacity:1}}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-thumb{background:#283848;border-radius:3px}"}),y.jsxs("div",{style:{padding:"8px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",background:U.deep,borderBottom:`1px solid ${U.border}`,flexShrink:0},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[y.jsxs("span",{style:{fontSize:12,color:U.muted,textTransform:"uppercase",letterSpacing:"2px"},children:["Room ",oe+1,"/",((Ee=Q==null?void 0:Q.encounters)==null?void 0:Ee.length)||3]}),y.jsx("span",{style:{fontSize:15,color:U.text,fontWeight:700},children:Z})]}),y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[y.jsxs("span",{style:{fontSize:14,color:U.sub,fontFamily:"monospace"},children:["Round ",m]}),we&&y.jsx("span",{style:{fontSize:12,color:U.accent,animation:"pulse 1.5s infinite",fontWeight:700},children:" YOUR TURN"}),Be&&!we&&y.jsx("span",{style:{fontSize:12,color:"#eeaa44",animation:"pulse 1s infinite"},children:" RESOLVING"})]})]}),y.jsxs("div",{style:{flex:1,display:"flex",minHeight:0,overflow:"hidden"},children:[y.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0,overflow:"hidden"},children:[y.jsx("div",{style:{padding:"10px 20px",background:U.deep,borderBottom:`1px solid ${U.border}`,flexShrink:0},children:y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:16},children:[y.jsxs("div",{style:{flex:1,maxWidth:380},children:[y.jsxs("div",{style:{fontSize:11,color:U.dim,textTransform:"uppercase",letterSpacing:"1px",marginBottom:3},children:[c?" Visitor":" Dungeon"," (AI)"]}),te&&Qe.map(([J,_e])=>{var Re;return y.jsx(gi,{label:_e,color:J,value:te[J]||0,max:it[J]||20,delta:(Re=$[`${G}.${J}`])==null?void 0:Re.delta,dk:`${B}-${G}-${J}`},J)}),te&&y.jsx(gi,{label:kt==="trust"?"Trust":"Rapport",color:kt,value:te[kt]||0,max:12,delta:(Ke=$[`${G}.${kt}`])==null?void 0:Ke.delta,dk:`${B}-${G}-${kt}`}),c&&(w==null?void 0:w.members)&&y.jsx(Nc,{members:w.members,deltas:$,dk:B})]}),y.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:6},children:[w&&y.jsx(Oc,{avail:c?w.vEnergy.available:w.dEnergy.available,base:c?w.vEnergy.base:w.dEnergy.base,delta:($e=$[`${G}.energy`])==null?void 0:$e.delta,dk:`${B}-${G}-en`}),te&&y.jsx(zc,{conds:te.conditions})]})]})}),y.jsx("div",{style:{flex:1,overflow:"auto",display:"flex",alignItems:"center",justifyContent:"center",background:`radial-gradient(ellipse at center, #141a2880 0%, ${U.void} 70%)`,minHeight:0},children:y.jsx(dh,{selectedQueue:we?Se:[],currentEvent:T,round:m})}),y.jsx("div",{style:{padding:"10px 20px",background:U.deep,borderTop:`1px solid ${U.border}`,flexShrink:0},children:y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:16},children:[y.jsxs("div",{style:{flex:1,maxWidth:380},children:[y.jsxs("div",{style:{fontSize:11,color:U.dim,textTransform:"uppercase",letterSpacing:"1px",marginBottom:3},children:[c?" Dungeon":" Visitor"," (You)"]}),se&&$t.map(([J,_e])=>{var Re;return y.jsx(gi,{label:_e,color:J,value:se[J]||0,max:Vt[J]||20,delta:(Re=$[`${o}.${J}`])==null?void 0:Re.delta,dk:`${B}-${o}-${J}`},J)}),se&&y.jsx(gi,{label:jt==="trust"?"Trust":"Rapport",color:jt,value:se[jt]||0,max:12,delta:(Mt=$[`${o}.${jt}`])==null?void 0:Mt.delta,dk:`${B}-${o}-${jt}`}),!c&&(w==null?void 0:w.members)&&y.jsx(Nc,{members:w.members,deltas:$,dk:B})]}),y.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:6},children:[w&&y.jsx(Oc,{avail:c?w.dEnergy.available:w.vEnergy.available,base:c?w.dEnergy.base:w.vEnergy.base,delta:(At=$[`${o}.energy`])==null?void 0:At.delta,dk:`${B}-${o}-en`}),se&&y.jsx(zc,{conds:se.conditions})]})]})}),y.jsxs("div",{style:{borderTop:`1px solid ${U.border}`,background:"#060a10",flexShrink:0},children:[we&&c&&(w==null?void 0:w.members)&&y.jsx(gh,{members:w.members,selected:b,onSelect:M}),we&&Se.length>0&&y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"5px 16px",background:`${U.surface}50`},children:[y.jsxs("span",{style:{fontSize:11,color:U.muted},children:["Energy: ",St.available]}),y.jsxs("span",{style:{fontSize:11,color:gt>0?"#ee8844":"#55ff99"},children:[" ",xt," after plays"]}),xt<0&&y.jsx("span",{style:{fontSize:11,color:"#ff4444",fontWeight:700},children:" Not enough energy!"})]}),y.jsxs("div",{style:{display:"flex",gap:8,overflowX:"auto",padding:"10px 16px 8px",minHeight:168},children:[De.map((J,_e)=>{const Re=Se.findIndex(ht=>ht.card===J);return y.jsx(ch,{card:J,queueIdx:Re>=0?Re:null,onSelect:O,disabled:!we||Be},`${J.name}-${_e}`)}),De.length===0&&y.jsx("div",{style:{display:"flex",alignItems:"center",color:U.muted,fontSize:14,padding:24},children:Be?"Resolving...":"Waiting for your turn..."})]}),we&&y.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",padding:"6px 16px 14px"},children:[y.jsxs("button",{onClick:ue,disabled:Se.length===0,style:{padding:"12px 36px",fontSize:15,fontWeight:800,borderRadius:6,background:Se.length>0?xt<0?"#cc6633":U.accent:U.surface,border:`2px solid ${Se.length>0?xt<0?"#ee8844":U.accentGlow:U.border}`,color:Se.length>0?"#000":U.dim,cursor:Se.length>0?"pointer":"default",transition:"all 0.15s"},children:[xt<0?`Play Anyway (${Se.length})`:`Play ${Se.length} Card${Se.length!==1?"s":""}`," "]}),y.jsx("button",{onClick:ce,style:{padding:"12px 24px",fontSize:13,background:"transparent",border:`1px solid ${U.border}`,color:U.sub,borderRadius:6,cursor:"pointer"},children:"End Turn"})]})]})]}),y.jsxs("div",{style:{width:300,borderLeft:`1px solid ${U.border}`,background:"#080c14",display:"flex",flexDirection:"column",overflow:"hidden"},children:[y.jsx("div",{style:{padding:"8px 12px",borderBottom:`1px solid ${U.border}`,fontSize:12,color:U.sub,textTransform:"uppercase",letterSpacing:"1px",fontWeight:700,flexShrink:0},children:"Combat Log"}),y.jsx(fh,{entries:V})]})]}),y.jsx(ph,{outcome:ie,playerSide:o,onExit:i,canNext:sn,onNext:de})]})}function yh(){const[o,a]=pe.useState("title"),[i,c]=pe.useState(null),[d,u]=pe.useState([]),[f,g]=pe.useState(null),h=()=>{a("title"),c(null),u([]),g(null)},m=()=>a("side-select"),k=T=>{c(T),a("composition"),u([])},w=T=>{u(T),a("deck-review")},v=()=>{g({side:i,selected:d}),a("encounter-play")};switch(o){case"title":return y.jsx(wc,{onPlay:m});case"side-select":return y.jsx(up,{onSelect:k,onBack:h});case"composition":return y.jsx(Vp,{side:i,onConfirm:w,onBack:()=>a("side-select")});case"deck-review":return y.jsx(Gp,{side:i,selected:d,onBack:()=>a("composition"),onReady:v});case"encounter-play":return y.jsx(hh,{playerSide:f.side,playerSelections:f.selected,onExit:h});default:return y.jsx(wc,{onPlay:m})}}document.documentElement.style.cssText="margin:0;padding:0;background:#0a0e14;";document.body.style.cssText='margin:0;padding:0;background:#0a0e14;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;';lp.createRoot(document.getElementById("root")).render(y.jsx(Lc.StrictMode,{children:y.jsx(yh,{})}));
